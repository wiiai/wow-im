import{ao as nt,ar as Q,d as pt,as as mt,a as ht,aq as _t,j as De,at as et,c as vt,R as gt,au as yt,b as Ve,w as Ne,f as je,o as de,g as K,h as Be,e as he,r as tt,F as Ye,G as Pe,al as rt,ak as Fe,an as Qe,t as Oe,av as bt,i as wt,aw as At,_ as Rt}from"./index.c355eebe.js";import{P as Tt}from"./Page.23329217.js";import{u as St}from"./friend.a574546d.js";const it="/mobile/assets/file_fill.fa998c17.svg",kt=Z=>nt({url:"/group/get_user_list_by_id",method:"POST",data:Z}),Ze=Z=>nt({url:"/upload/file",method:"POST",data:Z});var Ue=(Z=>(Z[Z.text=0]="text",Z[Z.image=1]="image",Z[Z.audio=2]="audio",Z[Z.file=3]="file",Z))(Ue||{}),ot={exports:{}};(function(Z){/**
 * {@link https://github.com/muaz-khan/RecordRTC|RecordRTC} is a WebRTC JavaScript library for audio/video as well as screen activity recording. It supports Chrome, Firefox, Opera, Android, and Microsoft Edge. Platforms: Linux, Mac and Windows. 
 * @summary Record audio, video or screen inside the browser.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef RecordRTC
 * @class
 * @example
 * var recorder = RecordRTC(mediaStream or [arrayOfMediaStream], {
 *     type: 'video', // audio or video or gif or canvas
 *     recorderType: MediaStreamRecorder || CanvasRecorder || StereoAudioRecorder || Etc
 * });
 * recorder.startRecording();
 * @see For further information:
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - Single media-stream object, array of media-streams, html-canvas-element, etc.
 * @param {object} config - {type:"video", recorderType: MediaStreamRecorder, disableLogs: true, numberOfAudioChannels: 1, bufferSize: 0, sampleRate: 0, desiredSampRate: 16000, video: HTMLVideoElement, etc.}
 */function C(a,t){if(!a)throw"First parameter is required.";t=t||{type:"video"},t=new i(a,t);var o=this;function m(c){return t.disableLogs||console.log("RecordRTC version: ",o.version),c&&(t=new i(a,c)),t.disableLogs||console.log("started recording "+t.type+" stream."),w?(w.clearRecordedData(),w.record(),L("recording"),o.recordingDuration&&A(),o):(d(function(){o.recordingDuration&&A()}),o)}function d(c){c&&(t.initCallback=function(){c(),c=t.initCallback=null});var S=new _(a,t);w=new S(a,t),w.record(),L("recording"),t.disableLogs||console.log("Initialized recorderType:",w.constructor.name,"for output-type:",t.type)}function v(c){if(c=c||function(){},!w){x();return}if(o.state==="paused"){o.resumeRecording(),setTimeout(function(){v(c)},1);return}o.state!=="recording"&&!t.disableLogs&&console.warn('Recording state should be: "recording", however current state is: ',o.state),t.disableLogs||console.log("Stopped recording "+t.type+" stream."),t.type!=="gif"?w.stop(S):(w.stop(),S()),L("stopped");function S(E){if(!w){typeof c.call=="function"?c.call(o,""):c("");return}Object.keys(w).forEach(function(I){typeof w[I]!="function"&&(o[I]=w[I])});var f=w.blob;if(!f)if(E)w.blob=f=E;else throw"Recording failed.";if(f&&!t.disableLogs&&console.log(f.type,"->",l(f.size)),c){var y;try{y=G.createObjectURL(f)}catch{}typeof c.call=="function"?c.call(o,y):c(y)}!t.autoWriteToDisk||M(function(I){var P={};P[t.type+"Blob"]=I,J.Store(P)})}}function b(){if(!w){x();return}if(o.state!=="recording"){t.disableLogs||console.warn("Unable to pause the recording. Recording state: ",o.state);return}L("paused"),w.pause(),t.disableLogs||console.log("Paused recording.")}function u(){if(!w){x();return}if(o.state!=="paused"){t.disableLogs||console.warn("Unable to resume the recording. Recording state: ",o.state);return}L("recording"),w.resume(),t.disableLogs||console.log("Resumed recording.")}function R(c){postMessage(new FileReaderSync().readAsDataURL(c))}function M(c,S){if(!c)throw"Pass a callback function over getDataURL.";var E=S?S.blob:(w||{}).blob;if(!E){t.disableLogs||console.warn("Blob encoder did not finish its job yet."),setTimeout(function(){M(c,S)},1e3);return}if(typeof Worker<"u"&&!navigator.mozGetUserMedia){var f=I(R);f.onmessage=function(P){c(P.data)},f.postMessage(E)}else{var y=new FileReader;y.readAsDataURL(E),y.onload=function(P){c(P.target.result)}}function I(P){try{var X=G.createObjectURL(new Blob([P.toString(),"this.onmessage =  function (eee) {"+P.name+"(eee.data);}"],{type:"application/javascript"})),W=new Worker(X);return G.revokeObjectURL(X),W}catch{}}}function A(c){if(c=c||0,o.state==="paused"){setTimeout(function(){A(c)},1e3);return}if(o.state!=="stopped"){if(c>=o.recordingDuration){v(o.onRecordingStopped);return}c+=1e3,setTimeout(function(){A(c)},1e3)}}function L(c){!o||(o.state=c,typeof o.onStateChanged.call=="function"?o.onStateChanged.call(o,c):o.onStateChanged(c))}var T='It seems that recorder is destroyed or "startRecording" is not invoked for '+t.type+" recorder.";function x(){t.disableLogs!==!0&&console.warn(T)}var w,U={startRecording:m,stopRecording:v,pauseRecording:b,resumeRecording:u,initRecorder:d,setRecordingDuration:function(c,S){if(typeof c>"u")throw"recordingDuration is required.";if(typeof c!="number")throw"recordingDuration must be a number.";return o.recordingDuration=c,o.onRecordingStopped=S||function(){},{onRecordingStopped:function(E){o.onRecordingStopped=E}}},clearRecordedData:function(){if(!w){x();return}w.clearRecordedData(),t.disableLogs||console.log("Cleared old recorded data.")},getBlob:function(){if(!w){x();return}return w.blob},getDataURL:M,toURL:function(){if(!w){x();return}return G.createObjectURL(w.blob)},getInternalRecorder:function(){return w},save:function(c){if(!w){x();return}B(w.blob,c)},getFromDisk:function(c){if(!w){x();return}C.getFromDisk(t.type,c)},setAdvertisementArray:function(c){t.advertisement=[];for(var S=c.length,E=0;E<S;E++)t.advertisement.push({duration:E,image:c[E]})},blob:null,bufferSize:0,sampleRate:0,buffer:null,reset:function(){o.state==="recording"&&!t.disableLogs&&console.warn("Stop an active recorder."),w&&typeof w.clearRecordedData=="function"&&w.clearRecordedData(),w=null,L("inactive"),o.blob=null},onStateChanged:function(c){t.disableLogs||console.log("Recorder state changed:",c)},state:"inactive",getState:function(){return o.state},destroy:function(){var c=t.disableLogs;t={disableLogs:!0},o.reset(),L("destroyed"),U=o=null,fe.AudioContextConstructor&&(fe.AudioContextConstructor.close(),fe.AudioContextConstructor=null),t.disableLogs=c,t.disableLogs||console.log("RecordRTC is destroyed.")},version:"5.6.2"};if(!this)return o=U,U;for(var V in U)this[V]=U[V];return o=this,U}C.version="5.6.2",Z.exports=C,C.getFromDisk=function(a,t){if(!t)throw"callback is mandatory.";console.log("Getting recorded "+(a==="all"?"blobs":a+" blob ")+" from disk!"),J.Fetch(function(o,m){a!=="all"&&m===a+"Blob"&&t&&t(o),a==="all"&&t&&t(o,m.replace("Blob",""))})},C.writeToDisk=function(a){console.log("Writing recorded blob(s) to disk!"),a=a||{},a.audio&&a.video&&a.gif?a.audio.getDataURL(function(t){a.video.getDataURL(function(o){a.gif.getDataURL(function(m){J.Store({audioBlob:t,videoBlob:o,gifBlob:m})})})}):a.audio&&a.video?a.audio.getDataURL(function(t){a.video.getDataURL(function(o){J.Store({audioBlob:t,videoBlob:o})})}):a.audio&&a.gif?a.audio.getDataURL(function(t){a.gif.getDataURL(function(o){J.Store({audioBlob:t,gifBlob:o})})}):a.video&&a.gif?a.video.getDataURL(function(t){a.gif.getDataURL(function(o){J.Store({videoBlob:t,gifBlob:o})})}):a.audio?a.audio.getDataURL(function(t){J.Store({audioBlob:t})}):a.video?a.video.getDataURL(function(t){J.Store({videoBlob:t})}):a.gif&&a.gif.getDataURL(function(t){J.Store({gifBlob:t})})};/**
 * {@link RecordRTCConfiguration} is an inner/private helper for {@link RecordRTC}.
 * @summary It configures the 2nd parameter passed over {@link RecordRTC} and returns a valid "config" object.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef RecordRTCConfiguration
 * @class
 * @example
 * var options = RecordRTCConfiguration(mediaStream, options);
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @param {object} config - {type:"video", disableLogs: true, numberOfAudioChannels: 1, bufferSize: 0, sampleRate: 0, video: HTMLVideoElement, getNativeBlob:true, etc.}
 */function i(a,t){return!t.recorderType&&!t.type&&(!!t.audio&&!!t.video?t.type="video":!!t.audio&&!t.video&&(t.type="audio")),t.recorderType&&!t.type&&(t.recorderType===Se||t.recorderType===we||typeof ee<"u"&&t.recorderType===ee?t.type="video":t.recorderType===Ae?t.type="gif":t.recorderType===be?t.type="audio":t.recorderType===N&&(H(a,"audio").length&&H(a,"video").length||!H(a,"audio").length&&H(a,"video").length?t.type="video":H(a,"audio").length&&!H(a,"video").length&&(t.type="audio"))),typeof N<"u"&&typeof MediaRecorder<"u"&&"requestData"in MediaRecorder.prototype&&(t.mimeType||(t.mimeType="video/webm"),t.type||(t.type=t.mimeType.split("/")[0]),t.bitsPerSecond),t.type||(t.mimeType&&(t.type=t.mimeType.split("/")[0]),t.type||(t.type="audio")),t}/**
 * {@link GetRecorderType} is an inner/private helper for {@link RecordRTC}.
 * @summary It returns best recorder-type available for your browser.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef GetRecorderType
 * @class
 * @example
 * var RecorderType = GetRecorderType(options);
 * var recorder = new RecorderType(options);
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @param {object} config - {type:"video", disableLogs: true, numberOfAudioChannels: 1, bufferSize: 0, sampleRate: 0, video: HTMLVideoElement, etc.}
 */function _(a,t){var o;return(s||e||r)&&(o=be),typeof MediaRecorder<"u"&&"requestData"in MediaRecorder.prototype&&!s&&(o=N),t.type==="video"&&(s||r)&&(o=Se,typeof ee<"u"&&typeof ReadableStream<"u"&&(o=ee)),t.type==="gif"&&(o=Ae),t.type==="canvas"&&(o=we),le()&&o!==we&&o!==Ae&&typeof MediaRecorder<"u"&&"requestData"in MediaRecorder.prototype&&(H(a,"video").length||H(a,"audio").length)&&(t.type==="audio"?typeof MediaRecorder.isTypeSupported=="function"&&MediaRecorder.isTypeSupported("audio/webm")&&(o=N):typeof MediaRecorder.isTypeSupported=="function"&&MediaRecorder.isTypeSupported("video/webm")&&(o=N)),a instanceof Array&&a.length&&(o=z),t.recorderType&&(o=t.recorderType),!t.disableLogs&&!!o&&!!o.name&&console.log("Using recorderType:",o.name||o.constructor.name),!o&&h&&(o=N),o}/**
 * MRecordRTC runs on top of {@link RecordRTC} to bring multiple recordings in a single place, by providing simple API.
 * @summary MRecordRTC stands for "Multiple-RecordRTC".
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef MRecordRTC
 * @class
 * @example
 * var recorder = new MRecordRTC();
 * recorder.addStream(MediaStream);
 * recorder.mediaType = {
 *     audio: true, // or StereoAudioRecorder or MediaStreamRecorder
 *     video: true, // or WhammyRecorder or MediaStreamRecorder or WebAssemblyRecorder or CanvasRecorder
 *     gif: true    // or GifRecorder
 * };
 * // mimeType is optional and should be set only in advance cases.
 * recorder.mimeType = {
 *     audio: 'audio/wav',
 *     video: 'video/webm',
 *     gif:   'image/gif'
 * };
 * recorder.startRecording();
 * @see For further information:
 * @see {@link https://github.com/muaz-khan/RecordRTC/tree/master/MRecordRTC|MRecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @requires {@link RecordRTC}
 */function p(a){this.addStream=function(t){t&&(a=t)},this.mediaType={audio:!0,video:!0},this.startRecording=function(){var t=this.mediaType,o,m=this.mimeType||{audio:null,video:null,gif:null};if(typeof t.audio!="function"&&le()&&!H(a,"audio").length&&(t.audio=!1),typeof t.video!="function"&&le()&&!H(a,"video").length&&(t.video=!1),typeof t.gif!="function"&&le()&&!H(a,"video").length&&(t.gif=!1),!t.audio&&!t.video&&!t.gif)throw"MediaStream must have either audio or video tracks.";if(t.audio&&(o=null,typeof t.audio=="function"&&(o=t.audio),this.audioRecorder=new C(a,{type:"audio",bufferSize:this.bufferSize,sampleRate:this.sampleRate,numberOfAudioChannels:this.numberOfAudioChannels||2,disableLogs:this.disableLogs,recorderType:o,mimeType:m.audio,timeSlice:this.timeSlice,onTimeStamp:this.onTimeStamp}),t.video||this.audioRecorder.startRecording()),t.video){o=null,typeof t.video=="function"&&(o=t.video);var d=a;if(le()&&!!t.audio&&typeof t.audio=="function"){var v=H(a,"video")[0];n?(d=new g,d.addTrack(v),o&&o===Se&&(o=N)):(d=new g,d.addTrack(v))}this.videoRecorder=new C(d,{type:"video",video:this.video,canvas:this.canvas,frameInterval:this.frameInterval||10,disableLogs:this.disableLogs,recorderType:o,mimeType:m.video,timeSlice:this.timeSlice,onTimeStamp:this.onTimeStamp,workerPath:this.workerPath,webAssemblyPath:this.webAssemblyPath,frameRate:this.frameRate,bitrate:this.bitrate}),t.audio||this.videoRecorder.startRecording()}if(!!t.audio&&!!t.video){var b=this,u=le()===!0;(t.audio instanceof be&&!!t.video||t.audio!==!0&&t.video!==!0&&t.audio!==t.video)&&(u=!1),u===!0?(b.audioRecorder=null,b.videoRecorder.startRecording()):b.videoRecorder.initRecorder(function(){b.audioRecorder.initRecorder(function(){b.videoRecorder.startRecording(),b.audioRecorder.startRecording()})})}t.gif&&(o=null,typeof t.gif=="function"&&(o=t.gif),this.gifRecorder=new C(a,{type:"gif",frameRate:this.frameRate||200,quality:this.quality||10,disableLogs:this.disableLogs,recorderType:o,mimeType:m.gif}),this.gifRecorder.startRecording())},this.stopRecording=function(t){t=t||function(){},this.audioRecorder&&this.audioRecorder.stopRecording(function(o){t(o,"audio")}),this.videoRecorder&&this.videoRecorder.stopRecording(function(o){t(o,"video")}),this.gifRecorder&&this.gifRecorder.stopRecording(function(o){t(o,"gif")})},this.pauseRecording=function(){this.audioRecorder&&this.audioRecorder.pauseRecording(),this.videoRecorder&&this.videoRecorder.pauseRecording(),this.gifRecorder&&this.gifRecorder.pauseRecording()},this.resumeRecording=function(){this.audioRecorder&&this.audioRecorder.resumeRecording(),this.videoRecorder&&this.videoRecorder.resumeRecording(),this.gifRecorder&&this.gifRecorder.resumeRecording()},this.getBlob=function(t){var o={};return this.audioRecorder&&(o.audio=this.audioRecorder.getBlob()),this.videoRecorder&&(o.video=this.videoRecorder.getBlob()),this.gifRecorder&&(o.gif=this.gifRecorder.getBlob()),t&&t(o),o},this.destroy=function(){this.audioRecorder&&(this.audioRecorder.destroy(),this.audioRecorder=null),this.videoRecorder&&(this.videoRecorder.destroy(),this.videoRecorder=null),this.gifRecorder&&(this.gifRecorder.destroy(),this.gifRecorder=null)},this.getDataURL=function(t){this.getBlob(function(d){d.audio&&d.video?o(d.audio,function(v){o(d.video,function(b){t({audio:v,video:b})})}):d.audio?o(d.audio,function(v){t({audio:v})}):d.video&&o(d.video,function(v){t({video:v})})});function o(d,v){if(typeof Worker<"u"){var b=m(function(M){postMessage(new FileReaderSync().readAsDataURL(M))});b.onmessage=function(R){v(R.data)},b.postMessage(d)}else{var u=new FileReader;u.readAsDataURL(d),u.onload=function(R){v(R.target.result)}}}function m(d){var v=G.createObjectURL(new Blob([d.toString(),"this.onmessage =  function (eee) {"+d.name+"(eee.data);}"],{type:"application/javascript"})),b=new Worker(v),u;if(typeof G<"u")u=G;else if(typeof webkitURL<"u")u=webkitURL;else throw"Neither URL nor webkitURL detected.";return u.revokeObjectURL(v),b}},this.writeToDisk=function(){C.writeToDisk({audio:this.audioRecorder,video:this.videoRecorder,gif:this.gifRecorder})},this.save=function(t){t=t||{audio:!0,video:!0,gif:!0},!!t.audio&&this.audioRecorder&&this.audioRecorder.save(typeof t.audio=="string"?t.audio:""),!!t.video&&this.videoRecorder&&this.videoRecorder.save(typeof t.video=="string"?t.video:""),!!t.gif&&this.gifRecorder&&this.gifRecorder.save(typeof t.gif=="string"?t.gif:"")}}p.getFromDisk=C.getFromDisk,p.writeToDisk=C.writeToDisk,typeof C<"u"&&(C.MRecordRTC=p);var O="Fake/5.0 (FakeOS) AppleWebKit/123 (KHTML, like Gecko) Fake/12.3.4567.89 Fake/123.45";(function(a){!a||typeof window<"u"||typeof Q>"u"||(Q.navigator={userAgent:O,getUserMedia:function(){}},Q.console||(Q.console={}),(typeof Q.console.log>"u"||typeof Q.console.error>"u")&&(Q.console.error=Q.console.log=Q.console.log||function(){console.log(arguments)}),typeof document>"u"&&(a.document={documentElement:{appendChild:function(){return""}}},document.createElement=document.captureStream=document.mozCaptureStream=function(){var t={getContext:function(){return t},play:function(){},pause:function(){},drawImage:function(){},toDataURL:function(){return""},style:{}};return t},a.HTMLVideoElement=function(){}),typeof location>"u"&&(a.location={protocol:"file:",href:"",hash:""}),typeof screen>"u"&&(a.screen={width:0,height:0}),typeof G>"u"&&(a.URL={createObjectURL:function(){return""},revokeObjectURL:function(){return""}}),a.window=Q)})(typeof Q<"u"?Q:null);var D=window.requestAnimationFrame;if(typeof D>"u"){if(typeof webkitRequestAnimationFrame<"u")D=webkitRequestAnimationFrame;else if(typeof mozRequestAnimationFrame<"u")D=mozRequestAnimationFrame;else if(typeof msRequestAnimationFrame<"u")D=msRequestAnimationFrame;else if(typeof D>"u"){var Y=0;D=function(a,t){var o=new Date().getTime(),m=Math.max(0,16-(o-Y)),d=setTimeout(function(){a(o+m)},m);return Y=o+m,d}}}var F=window.cancelAnimationFrame;typeof F>"u"&&(typeof webkitCancelAnimationFrame<"u"?F=webkitCancelAnimationFrame:typeof mozCancelAnimationFrame<"u"?F=mozCancelAnimationFrame:typeof msCancelAnimationFrame<"u"?F=msCancelAnimationFrame:typeof F>"u"&&(F=function(a){clearTimeout(a)}));var k=window.AudioContext;typeof k>"u"&&(typeof webkitAudioContext<"u"&&(k=webkitAudioContext),typeof mozAudioContext<"u"&&(k=mozAudioContext));var G=window.URL;typeof G>"u"&&typeof webkitURL<"u"&&(G=webkitURL),typeof navigator<"u"&&typeof navigator.getUserMedia>"u"&&(typeof navigator.webkitGetUserMedia<"u"&&(navigator.getUserMedia=navigator.webkitGetUserMedia),typeof navigator.mozGetUserMedia<"u"&&(navigator.getUserMedia=navigator.mozGetUserMedia));var e=navigator.userAgent.indexOf("Edge")!==-1&&(!!navigator.msSaveBlob||!!navigator.msSaveOrOpenBlob),r=!!window.opera||navigator.userAgent.indexOf("OPR/")!==-1,n=navigator.userAgent.toLowerCase().indexOf("firefox")>-1&&"netscape"in window&&/ rv:/.test(navigator.userAgent),s=!r&&!e&&!!navigator.webkitGetUserMedia||q()||navigator.userAgent.toLowerCase().indexOf("chrome/")!==-1,h=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);h&&!s&&navigator.userAgent.indexOf("CriOS")!==-1&&(h=!1,s=!0);var g=window.MediaStream;typeof g>"u"&&typeof webkitMediaStream<"u"&&(g=webkitMediaStream),typeof g<"u"&&typeof g.prototype.stop>"u"&&(g.prototype.stop=function(){this.getTracks().forEach(function(a){a.stop()})});function l(a){var t=1e3,o=["Bytes","KB","MB","GB","TB"];if(a===0)return"0 Bytes";var m=parseInt(Math.floor(Math.log(a)/Math.log(t)),10);return(a/Math.pow(t,m)).toPrecision(3)+" "+o[m]}function B(a,t){if(!a)throw"Blob object is required.";if(!a.type)try{a.type="video/webm"}catch{}var o=(a.type||"video/webm").split("/")[1];if(o.indexOf(";")!==-1&&(o=o.split(";")[0]),t&&t.indexOf(".")!==-1){var m=t.split(".");t=m[0],o=m[1]}var d=(t||Math.round(Math.random()*9999999999)+888888888)+"."+o;if(typeof navigator.msSaveOrOpenBlob<"u")return navigator.msSaveOrOpenBlob(a,d);if(typeof navigator.msSaveBlob<"u")return navigator.msSaveBlob(a,d);var v=document.createElement("a");v.href=G.createObjectURL(a),v.download=d,v.style="display:none;opacity:0;color:transparent;",(document.body||document.documentElement).appendChild(v),typeof v.click=="function"?v.click():(v.target="_blank",v.dispatchEvent(new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0}))),G.revokeObjectURL(v.href)}function q(){return typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&!!process.versions.electron||typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent.indexOf("Electron")>=0}function H(a,t){return!a||!a.getTracks?[]:a.getTracks().filter(function(o){return o.kind===(t||"audio")})}function ie(a,t){"srcObject"in t?t.srcObject=a:"mozSrcObject"in t?t.mozSrcObject=a:t.srcObject=a}function _e(a,t){if(typeof EBML>"u")throw new Error("Please link: https://www.webrtc-experiment.com/EBML.js");var o=new EBML.Reader,m=new EBML.Decoder,d=EBML.tools,v=new FileReader;v.onload=function(b){var u=m.decode(this.result);u.forEach(function(L){o.read(L)}),o.stop();var R=d.makeMetadataSeekable(o.metadatas,o.duration,o.cues),M=this.result.slice(o.metadataSize),A=new Blob([R,M],{type:"video/webm"});t(A)},v.readAsArrayBuffer(a)}typeof C<"u"&&(C.invokeSaveAsDialog=B,C.getTracks=H,C.getSeekableBlob=_e,C.bytesToSize=l,C.isElectron=q);/**
 * Storage is a standalone object used by {@link RecordRTC} to store reusable objects e.g. "new AudioContext".
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @example
 * Storage.AudioContext === webkitAudioContext
 * @property {webkitAudioContext} AudioContext - Keeps a reference to AudioContext object.
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 */var fe={};typeof k<"u"?fe.AudioContext=k:typeof webkitAudioContext<"u"&&(fe.AudioContext=webkitAudioContext),typeof C<"u"&&(C.Storage=fe);function le(){if(n||h||e)return!0;var a=navigator.userAgent,t=""+parseFloat(navigator.appVersion),o=parseInt(navigator.appVersion,10),m,d;return(s||r)&&(m=a.indexOf("Chrome"),t=a.substring(m+7)),(d=t.indexOf(";"))!==-1&&(t=t.substring(0,d)),(d=t.indexOf(" "))!==-1&&(t=t.substring(0,d)),o=parseInt(""+t,10),isNaN(o)&&(t=""+parseFloat(navigator.appVersion),o=parseInt(navigator.appVersion,10)),o>=49}/**
 * MediaStreamRecorder is an abstraction layer for {@link https://w3c.github.io/mediacapture-record/MediaRecorder.html|MediaRecorder API}. It is used by {@link RecordRTC} to record MediaStream(s) in both Chrome and Firefox.
 * @summary Runs top over {@link https://w3c.github.io/mediacapture-record/MediaRecorder.html|MediaRecorder API}.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://github.com/muaz-khan|Muaz Khan}
 * @typedef MediaStreamRecorder
 * @class
 * @example
 * var config = {
 *     mimeType: 'video/webm', // vp8, vp9, h264, mkv, opus/vorbis
 *     audioBitsPerSecond : 256 * 8 * 1024,
 *     videoBitsPerSecond : 256 * 8 * 1024,
 *     bitsPerSecond: 256 * 8 * 1024,  // if this is provided, skip above two
 *     checkForInactiveTracks: true,
 *     timeSlice: 1000, // concatenate intervals based blobs
 *     ondataavailable: function() {} // get intervals based blobs
 * }
 * var recorder = new MediaStreamRecorder(mediaStream, config);
 * recorder.record();
 * recorder.stop(function(blob) {
 *     video.src = URL.createObjectURL(blob);
 *
 *     // or
 *     var blob = recorder.blob;
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @param {object} config - {disableLogs:true, initCallback: function, mimeType: "video/webm", timeSlice: 1000}
 * @throws Will throw an error if first argument "MediaStream" is missing. Also throws error if "MediaRecorder API" are not supported by the browser.
 */function N(a,t){var A=this;if(typeof a>"u")throw'First argument "MediaStream" is required.';if(typeof MediaRecorder>"u")throw"Your browser does not support the Media Recorder API. Please try other modules e.g. WhammyRecorder or StereoAudioRecorder.";if(t=t||{mimeType:"video/webm"},t.type==="audio"){if(H(a,"video").length&&H(a,"audio").length){var o;navigator.mozGetUserMedia?(o=new g,o.addTrack(H(a,"audio")[0])):o=new g(H(a,"audio")),a=o}(!t.mimeType||t.mimeType.toString().toLowerCase().indexOf("audio")===-1)&&(t.mimeType=s?"audio/webm":"audio/ogg"),t.mimeType&&t.mimeType.toString().toLowerCase()!=="audio/ogg"&&!!navigator.mozGetUserMedia&&(t.mimeType="audio/ogg")}var m=[];this.getArrayOfBlobs=function(){return m},this.record=function(){A.blob=null,A.clearRecordedData(),A.timestamps=[],M=[],m=[];var L=t;t.disableLogs||console.log("Passing following config over MediaRecorder API.",L),u&&(u=null),s&&!le()&&(L="video/vp8"),typeof MediaRecorder.isTypeSupported=="function"&&L.mimeType&&(MediaRecorder.isTypeSupported(L.mimeType)||(t.disableLogs||console.warn("MediaRecorder API seems unable to record mimeType:",L.mimeType),L.mimeType=t.type==="audio"?"audio/webm":"video/webm"));try{u=new MediaRecorder(a,L),t.mimeType=L.mimeType}catch{u=new MediaRecorder(a)}L.mimeType&&!MediaRecorder.isTypeSupported&&"canRecordMimeType"in u&&u.canRecordMimeType(L.mimeType)===!1&&(t.disableLogs||console.warn("MediaRecorder API seems unable to record mimeType:",L.mimeType)),u.ondataavailable=function(T){if(T.data&&M.push("ondataavailable: "+l(T.data.size)),typeof t.timeSlice=="number"){if(T.data&&T.data.size&&(m.push(T.data),d(),typeof t.ondataavailable=="function")){var x=t.getNativeBlob?T.data:new Blob([T.data],{type:v(L)});t.ondataavailable(x)}return}if(!T.data||!T.data.size||T.data.size<100||A.blob){A.recordingCallback&&(A.recordingCallback(new Blob([],{type:v(L)})),A.recordingCallback=null);return}A.blob=t.getNativeBlob?T.data:new Blob([T.data],{type:v(L)}),A.recordingCallback&&(A.recordingCallback(A.blob),A.recordingCallback=null)},u.onstart=function(){M.push("started")},u.onpause=function(){M.push("paused")},u.onresume=function(){M.push("resumed")},u.onstop=function(){M.push("stopped")},u.onerror=function(T){!T||(T.name||(T.name="UnknownError"),M.push("error: "+T),t.disableLogs||(T.name.toString().toLowerCase().indexOf("invalidstate")!==-1?console.error("The MediaRecorder is not in a state in which the proposed operation is allowed to be executed.",T):T.name.toString().toLowerCase().indexOf("notsupported")!==-1?console.error("MIME type (",L.mimeType,") is not supported.",T):T.name.toString().toLowerCase().indexOf("security")!==-1?console.error("MediaRecorder security error",T):T.name==="OutOfMemory"?console.error("The UA has exhaused the available memory. User agents SHOULD provide as much additional information as possible in the message attribute.",T):T.name==="IllegalStreamModification"?console.error("A modification to the stream has occurred that makes it impossible to continue recording. An example would be the addition of a Track while recording is occurring. User agents SHOULD provide as much additional information as possible in the message attribute.",T):T.name==="OtherRecordingError"?console.error("Used for an fatal error other than those listed above. User agents SHOULD provide as much additional information as possible in the message attribute.",T):T.name==="GenericError"?console.error("The UA cannot provide the codec or recording option that has been requested.",T):console.error("MediaRecorder Error",T)),function(x){if(!A.manuallyStopped&&u&&u.state==="inactive"){delete t.timeslice,u.start(10*60*1e3);return}setTimeout(x,1e3)}(),u.state!=="inactive"&&u.state!=="stopped"&&u.stop())},typeof t.timeSlice=="number"?(d(),u.start(t.timeSlice)):u.start(36e5),t.initCallback&&t.initCallback()},this.timestamps=[];function d(){A.timestamps.push(new Date().getTime()),typeof t.onTimeStamp=="function"&&t.onTimeStamp(A.timestamps[A.timestamps.length-1],A.timestamps)}function v(L){return u&&u.mimeType?u.mimeType:L.mimeType||"video/webm"}this.stop=function(L){L=L||function(){},A.manuallyStopped=!0,u&&(this.recordingCallback=L,u.state==="recording"&&u.stop(),typeof t.timeSlice=="number"&&setTimeout(function(){A.blob=new Blob(m,{type:v(t)}),A.recordingCallback(A.blob)},100))},this.pause=function(){!u||u.state==="recording"&&u.pause()},this.resume=function(){!u||u.state==="paused"&&u.resume()},this.clearRecordedData=function(){u&&u.state==="recording"&&A.stop(b),b()};function b(){m=[],u=null,A.timestamps=[]}var u;this.getInternalRecorder=function(){return u};function R(){if("active"in a){if(!a.active)return!1}else if("ended"in a&&a.ended)return!1;return!0}this.blob=null,this.getState=function(){return u&&u.state||"inactive"};var M=[];this.getAllStates=function(){return M},typeof t.checkForInactiveTracks>"u"&&(t.checkForInactiveTracks=!1);var A=this;(function L(){if(!(!u||t.checkForInactiveTracks===!1)){if(R()===!1){t.disableLogs||console.log("MediaStream seems stopped."),A.stop();return}setTimeout(L,1e3)}})(),this.name="MediaStreamRecorder",this.toString=function(){return this.name}}typeof C<"u"&&(C.MediaStreamRecorder=N);/**
 * StereoAudioRecorder is a standalone class used by {@link RecordRTC} to bring "stereo" audio-recording in chrome.
 * @summary JavaScript standalone object for stereo audio recording.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef StereoAudioRecorder
 * @class
 * @example
 * var recorder = new StereoAudioRecorder(MediaStream, {
 *     sampleRate: 44100,
 *     bufferSize: 4096
 * });
 * recorder.record();
 * recorder.stop(function(blob) {
 *     video.src = URL.createObjectURL(blob);
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @param {object} config - {sampleRate: 44100, bufferSize: 4096, numberOfAudioChannels: 1, etc.}
 */function be(a,t){if(!H(a,"audio").length)throw"Your stream has no audio tracks.";t=t||{};var o=this,m=[],d=[],v=!1,b=0,u,R=2,M=t.desiredSampRate;t.leftChannel===!0&&(R=1),t.numberOfAudioChannels===1&&(R=1),(!R||R<1)&&(R=2),t.disableLogs||console.log("StereoAudioRecorder is set to record number of channels: "+R),typeof t.checkForInactiveTracks>"u"&&(t.checkForInactiveTracks=!0);function A(){if(t.checkForInactiveTracks===!1)return!0;if("active"in a){if(!a.active)return!1}else if("ended"in a&&a.ended)return!1;return!0}this.record=function(){if(A()===!1)throw"Please make sure MediaStream is active.";E(),y=S=!1,v=!0,typeof t.timeSlice<"u"&&X()};function L(W,ae){function te(re,Ie){var ve=re.numberOfAudioChannels,ue=re.leftBuffers.slice(0),Ce=re.rightBuffers.slice(0),ge=re.sampleRate,Re=re.internalInterleavedLength,ce=re.desiredSampRate;ve===2&&(ue=qe(ue,Re),Ce=qe(Ce,Re),ce&&(ue=Le(ue,ce,ge),Ce=Le(Ce,ce,ge))),ve===1&&(ue=qe(ue,Re),ce&&(ue=Le(ue,ce,ge))),ce&&(ge=ce);function Le(ne,ye,pe){var me=Math.round(ne.length*(ye/pe)),se=[],Te=Number((ne.length-1)/(me-1));se[0]=ne[0];for(var Me=1;Me<me-1;Me++){var $e=Me*Te,Je=Number(Math.floor($e)).toFixed(),lt=Number(Math.ceil($e)).toFixed(),ct=$e-Je;se[Me]=We(ne[Je],ne[lt],ct)}return se[me-1]=ne[ne.length-1],se}function We(ne,ye,pe){return ne+(ye-ne)*pe}function qe(ne,ye){for(var pe=new Float64Array(ye),me=0,se=ne.length,Te=0;Te<se;Te++){var Me=ne[Te];pe.set(Me,me),me+=Me.length}return pe}function st(ne,ye){for(var pe=ne.length+ye.length,me=new Float64Array(pe),se=0,Te=0;Te<pe;)me[Te++]=ne[se],me[Te++]=ye[se],se++;return me}function Ee(ne,ye,pe){for(var me=pe.length,se=0;se<me;se++)ne.setUint8(ye+se,pe.charCodeAt(se))}var He;ve===2&&(He=st(ue,Ce)),ve===1&&(He=ue);var Ge=He.length,dt=44+Ge*2,ze=new ArrayBuffer(dt),oe=new DataView(ze);Ee(oe,0,"RIFF"),oe.setUint32(4,36+Ge*2,!0),Ee(oe,8,"WAVE"),Ee(oe,12,"fmt "),oe.setUint32(16,16,!0),oe.setUint16(20,1,!0),oe.setUint16(22,ve,!0),oe.setUint32(24,ge,!0),oe.setUint32(28,ge*ve*2,!0),oe.setUint16(32,ve*2,!0),oe.setUint16(34,16,!0),Ee(oe,36,"data"),oe.setUint32(40,Ge*2,!0);for(var ut=Ge,Ke=44,ft=1,Xe=0;Xe<ut;Xe++)oe.setInt16(Ke,He[Xe]*(32767*ft),!0),Ke+=2;if(Ie)return Ie({buffer:ze,view:oe});postMessage({buffer:ze,view:oe})}if(W.noWorker){te(W,function(re){ae(re.buffer,re.view)});return}var xe=T(te);xe.onmessage=function(re){ae(re.data.buffer,re.data.view),G.revokeObjectURL(xe.workerURL),xe.terminate()},xe.postMessage(W)}function T(W){var ae=G.createObjectURL(new Blob([W.toString(),";this.onmessage =  function (eee) {"+W.name+"(eee.data);}"],{type:"application/javascript"})),te=new Worker(ae);return te.workerURL=ae,te}this.stop=function(W){W=W||function(){},v=!1,L({desiredSampRate:M,sampleRate:c,numberOfAudioChannels:R,internalInterleavedLength:b,leftBuffers:m,rightBuffers:R===1?[]:d,noWorker:t.noWorker},function(ae,te){o.blob=new Blob([te],{type:"audio/wav"}),o.buffer=new ArrayBuffer(te.buffer.byteLength),o.view=te,o.sampleRate=M||c,o.bufferSize=V,o.length=b,y=!1,W&&W(o.blob)})},typeof C.Storage>"u"&&(C.Storage={AudioContextConstructor:null,AudioContext:window.AudioContext||window.webkitAudioContext}),(!C.Storage.AudioContextConstructor||C.Storage.AudioContextConstructor.state==="closed")&&(C.Storage.AudioContextConstructor=new C.Storage.AudioContext);var x=C.Storage.AudioContextConstructor,w=x.createMediaStreamSource(a),U=[0,256,512,1024,2048,4096,8192,16384],V=typeof t.bufferSize>"u"?4096:t.bufferSize;if(U.indexOf(V)===-1&&(t.disableLogs||console.log("Legal values for buffer-size are "+JSON.stringify(U,null,"	"))),x.createJavaScriptNode)u=x.createJavaScriptNode(V,R,R);else if(x.createScriptProcessor)u=x.createScriptProcessor(V,R,R);else throw"WebAudio API has no support on this browser.";w.connect(u),t.bufferSize||(V=u.bufferSize);var c=typeof t.sampleRate<"u"?t.sampleRate:x.sampleRate||44100;(c<22050||c>96e3)&&(t.disableLogs||console.log("sample-rate must be under range 22050 and 96000.")),t.disableLogs||t.desiredSampRate&&console.log("Desired sample-rate: "+t.desiredSampRate);var S=!1;this.pause=function(){S=!0},this.resume=function(){if(A()===!1)throw"Please make sure MediaStream is active.";if(!v){t.disableLogs||console.log("Seems recording has been restarted."),this.record();return}S=!1},this.clearRecordedData=function(){t.checkForInactiveTracks=!1,v&&this.stop(f),f()};function E(){m=[],d=[],b=0,y=!1,v=!1,S=!1,x=null,o.leftchannel=m,o.rightchannel=d,o.numberOfAudioChannels=R,o.desiredSampRate=M,o.sampleRate=c,o.recordingLength=b,P={left:[],right:[],recordingLength:0}}function f(){u&&(u.onaudioprocess=null,u.disconnect(),u=null),w&&(w.disconnect(),w=null),E()}this.name="StereoAudioRecorder",this.toString=function(){return this.name};var y=!1;function I(W){if(!S){if(A()===!1&&(t.disableLogs||console.log("MediaStream seems stopped."),u.disconnect(),v=!1),!v){w&&(w.disconnect(),w=null);return}y||(y=!0,t.onAudioProcessStarted&&t.onAudioProcessStarted(),t.initCallback&&t.initCallback());var ae=W.inputBuffer.getChannelData(0),te=new Float32Array(ae);if(m.push(te),R===2){var xe=W.inputBuffer.getChannelData(1),re=new Float32Array(xe);d.push(re)}b+=V,o.recordingLength=b,typeof t.timeSlice<"u"&&(P.recordingLength+=V,P.left.push(te),R===2&&P.right.push(re))}}u.onaudioprocess=I,x.createMediaStreamDestination?u.connect(x.createMediaStreamDestination()):u.connect(x.destination),this.leftchannel=m,this.rightchannel=d,this.numberOfAudioChannels=R,this.desiredSampRate=M,this.sampleRate=c,o.recordingLength=b;var P={left:[],right:[],recordingLength:0};function X(){!v||typeof t.ondataavailable!="function"||typeof t.timeSlice>"u"||(P.left.length?(L({desiredSampRate:M,sampleRate:c,numberOfAudioChannels:R,internalInterleavedLength:P.recordingLength,leftBuffers:P.left,rightBuffers:R===1?[]:P.right},function(W,ae){var te=new Blob([ae],{type:"audio/wav"});t.ondataavailable(te),setTimeout(X,t.timeSlice)}),P={left:[],right:[],recordingLength:0}):setTimeout(X,t.timeSlice))}}typeof C<"u"&&(C.StereoAudioRecorder=be);/**
 * CanvasRecorder is a standalone class used by {@link RecordRTC} to bring HTML5-Canvas recording into video WebM. It uses HTML2Canvas library and runs top over {@link Whammy}.
 * @summary HTML2Canvas recording into video WebM.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef CanvasRecorder
 * @class
 * @example
 * var recorder = new CanvasRecorder(htmlElement, { disableLogs: true, useWhammyRecorder: true });
 * recorder.record();
 * recorder.stop(function(blob) {
 *     video.src = URL.createObjectURL(blob);
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {HTMLElement} htmlElement - querySelector/getElementById/getElementsByTagName[0]/etc.
 * @param {object} config - {disableLogs:true, initCallback: function}
 */function we(a,t){if(typeof html2canvas>"u")throw"Please link: https://www.webrtc-experiment.com/screenshot.js";t=t||{},t.frameInterval||(t.frameInterval=10);var o=!1;["captureStream","mozCaptureStream","webkitCaptureStream"].forEach(function(U){U in document.createElement("canvas")&&(o=!0)});var m=(!!window.webkitRTCPeerConnection||!!window.webkitGetUserMedia)&&!!window.chrome,d=50,v=navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./);m&&v&&v[2]&&(d=parseInt(v[2],10)),m&&d<52&&(o=!1),t.useWhammyRecorder&&(o=!1);var b,u;if(o)if(t.disableLogs||console.log("Your browser supports both MediRecorder API and canvas.captureStream!"),a instanceof HTMLCanvasElement)b=a;else if(a instanceof CanvasRenderingContext2D)b=a.canvas;else throw"Please pass either HTMLCanvasElement or CanvasRenderingContext2D.";else navigator.mozGetUserMedia&&(t.disableLogs||console.error("Canvas recording is NOT supported in Firefox."));var R;this.record=function(){if(R=!0,o&&!t.useWhammyRecorder){var U;"captureStream"in b?U=b.captureStream(25):"mozCaptureStream"in b?U=b.mozCaptureStream(25):"webkitCaptureStream"in b&&(U=b.webkitCaptureStream(25));try{var V=new g;V.addTrack(H(U,"video")[0]),U=V}catch{}if(!U)throw"captureStream API are NOT available.";u=new N(U,{mimeType:t.mimeType||"video/webm"}),u.record()}else w.frames=[],x=new Date().getTime(),T();t.initCallback&&t.initCallback()},this.getWebPImages=function(U){if(a.nodeName.toLowerCase()!=="canvas"){U();return}var V=w.frames.length;w.frames.forEach(function(c,S){var E=V-S;t.disableLogs||console.log(E+"/"+V+" frames remaining"),t.onEncodingCallback&&t.onEncodingCallback(E,V);var f=c.image.toDataURL("image/webp",1);w.frames[S].image=f}),t.disableLogs||console.log("Generating WebM"),U()},this.stop=function(U){R=!1;var V=this;if(o&&u){u.stop(U);return}this.getWebPImages(function(){w.compile(function(c){t.disableLogs||console.log("Recording finished!"),V.blob=c,V.blob.forEach&&(V.blob=new Blob([],{type:"video/webm"})),U&&U(V.blob),w.frames=[]})})};var M=!1;this.pause=function(){if(M=!0,u instanceof N){u.pause();return}},this.resume=function(){if(M=!1,u instanceof N){u.resume();return}R||this.record()},this.clearRecordedData=function(){R&&this.stop(A),A()};function A(){w.frames=[],R=!1,M=!1}this.name="CanvasRecorder",this.toString=function(){return this.name};function L(){var U=document.createElement("canvas"),V=U.getContext("2d");return U.width=a.width,U.height=a.height,V.drawImage(a,0,0),U}function T(){if(M)return x=new Date().getTime(),setTimeout(T,500);if(a.nodeName.toLowerCase()==="canvas"){var U=new Date().getTime()-x;x=new Date().getTime(),w.frames.push({image:L(),duration:U}),R&&setTimeout(T,t.frameInterval);return}html2canvas(a,{grabMouse:typeof t.showMousePointer>"u"||t.showMousePointer,onrendered:function(V){var c=new Date().getTime()-x;if(!c)return setTimeout(T,t.frameInterval);x=new Date().getTime(),w.frames.push({image:V.toDataURL("image/webp",1),duration:c}),R&&setTimeout(T,t.frameInterval)}})}var x=new Date().getTime(),w=new ke.Video(100)}typeof C<"u"&&(C.CanvasRecorder=we);/**
 * WhammyRecorder is a standalone class used by {@link RecordRTC} to bring video recording in Chrome. It runs top over {@link Whammy}.
 * @summary Video recording feature in Chrome.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef WhammyRecorder
 * @class
 * @example
 * var recorder = new WhammyRecorder(mediaStream);
 * recorder.record();
 * recorder.stop(function(blob) {
 *     video.src = URL.createObjectURL(blob);
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @param {object} config - {disableLogs: true, initCallback: function, video: HTMLVideoElement, etc.}
 */function Se(a,t){t=t||{},t.frameInterval||(t.frameInterval=10),t.disableLogs||console.log("Using frames-interval:",t.frameInterval),this.record=function(){t.width||(t.width=320),t.height||(t.height=240),t.video||(t.video={width:t.width,height:t.height}),t.canvas||(t.canvas={width:t.width,height:t.height}),R.width=t.canvas.width||320,R.height=t.canvas.height||240,M=R.getContext("2d"),t.video&&t.video instanceof HTMLVideoElement?(A=t.video.cloneNode(),t.initCallback&&t.initCallback()):(A=document.createElement("video"),ie(a,A),A.onloadedmetadata=function(){t.initCallback&&t.initCallback()},A.width=t.video.width,A.height=t.video.height),A.muted=!0,A.play(),L=new Date().getTime(),T=new ke.Video,t.disableLogs||(console.log("canvas resolutions",R.width,"*",R.height),console.log("video width/height",A.width||R.width,"*",A.height||R.height)),o(t.frameInterval)};function o(x){x=typeof x<"u"?x:10;var w=new Date().getTime()-L;if(!w)return setTimeout(o,x,x);if(b)return L=new Date().getTime(),setTimeout(o,100);L=new Date().getTime(),A.paused&&A.play(),M.drawImage(A,0,0,R.width,R.height),T.frames.push({duration:w,image:R.toDataURL("image/webp")}),v||setTimeout(o,x,x)}function m(x){var w=-1,U=x.length;(function V(){if(w++,w===U){x.callback();return}setTimeout(function(){x.functionToLoop(V,w)},1)})()}function d(x,w,U,V,c){var S=document.createElement("canvas");S.width=R.width,S.height=R.height;var E=S.getContext("2d"),f=[],y=w===-1,I=w&&w>0&&w<=x.length?w:x.length,P={r:0,g:0,b:0},X=Math.sqrt(Math.pow(255,2)+Math.pow(255,2)+Math.pow(255,2)),W=U&&U>=0&&U<=1?U:0,ae=V&&V>=0&&V<=1?V:0,te=!1;m({length:I,functionToLoop:function(xe,re){var Ie,ve,ue,Ce=function(){!te&&ue-Ie<=ue*ae||(y&&(te=!0),f.push(x[re])),xe()};if(te)Ce();else{var ge=new Image;ge.onload=function(){E.drawImage(ge,0,0,R.width,R.height);var Re=E.getImageData(0,0,R.width,R.height);Ie=0,ve=Re.data.length,ue=Re.data.length/4;for(var ce=0;ce<ve;ce+=4){var Le={r:Re.data[ce],g:Re.data[ce+1],b:Re.data[ce+2]},We=Math.sqrt(Math.pow(Le.r-P.r,2)+Math.pow(Le.g-P.g,2)+Math.pow(Le.b-P.b,2));We<=X*W&&Ie++}Ce()},ge.src=x[re].image}},callback:function(){f=f.concat(x.slice(I)),f.length<=0&&f.push(x[x.length-1]),c(f)}})}var v=!1;this.stop=function(x){x=x||function(){},v=!0;var w=this;setTimeout(function(){d(T.frames,-1,null,null,function(U){T.frames=U,t.advertisement&&t.advertisement.length&&(T.frames=t.advertisement.concat(T.frames)),T.compile(function(V){w.blob=V,w.blob.forEach&&(w.blob=new Blob([],{type:"video/webm"})),x&&x(w.blob)})})},10)};var b=!1;this.pause=function(){b=!0},this.resume=function(){b=!1,v&&this.record()},this.clearRecordedData=function(){v||this.stop(u),u()};function u(){T.frames=[],v=!0,b=!1}this.name="WhammyRecorder",this.toString=function(){return this.name};var R=document.createElement("canvas"),M=R.getContext("2d"),A,L,T}typeof C<"u"&&(C.WhammyRecorder=Se);/**
 * Whammy is a standalone class used by {@link RecordRTC} to bring video recording in Chrome. It is written by {@link https://github.com/antimatter15|antimatter15}
 * @summary A real time javascript webm encoder based on a canvas hack.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef Whammy
 * @class
 * @example
 * var recorder = new Whammy().Video(15);
 * recorder.add(context || canvas || dataURL);
 * var output = recorder.compile();
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 */var ke=function(){function a(m){this.frames=[],this.duration=m||1,this.quality=.8}a.prototype.add=function(m,d){if("canvas"in m&&(m=m.canvas),"toDataURL"in m&&(m=m.toDataURL("image/webp",this.quality)),!/^data:image\/webp;base64,/ig.test(m))throw"Input must be formatted properly as a base64 encoded DataURI of type image/webp";this.frames.push({image:m,duration:d||this.duration})};function t(m){var d=G.createObjectURL(new Blob([m.toString(),"this.onmessage =  function (eee) {"+m.name+"(eee.data);}"],{type:"application/javascript"})),v=new Worker(d);return G.revokeObjectURL(d),v}function o(m){function d(c){var S=b(c);if(!S)return[];for(var E=3e4,f=[{id:440786851,data:[{data:1,id:17030},{data:1,id:17143},{data:4,id:17138},{data:8,id:17139},{data:"webm",id:17026},{data:2,id:17031},{data:2,id:17029}]},{id:408125543,data:[{id:357149030,data:[{data:1e6,id:2807729},{data:"whammy",id:19840},{data:"whammy",id:22337},{data:U(S.duration),id:17545}]},{id:374648427,data:[{id:174,data:[{data:1,id:215},{data:1,id:29637},{data:0,id:156},{data:"und",id:2274716},{data:"V_VP8",id:134},{data:"VP8",id:2459272},{data:1,id:131},{id:224,data:[{data:S.width,id:176},{data:S.height,id:186}]}]}]}]}],y=0,I=0;y<c.length;){var P=[],X=0;do P.push(c[y]),X+=c[y].duration,y++;while(y<c.length&&X<E);var W=0,ae={id:524531317,data:v(I,W,P)};f[1].data.push(ae),I+=X}return A(f)}function v(c,S,E){return[{data:c,id:231}].concat(E.map(function(f){var y=L({discardable:0,frame:f.data.slice(4),invisible:0,keyframe:1,lacing:0,trackNum:1,timecode:Math.round(S)});return S+=f.duration,{data:y,id:163}}))}function b(c){if(!c[0]){postMessage({error:"Something went wrong. Maybe WebP format is not supported in the current browser."});return}for(var S=c[0].width,E=c[0].height,f=c[0].duration,y=1;y<c.length;y++)f+=c[y].duration;return{duration:f,width:S,height:E}}function u(c){for(var S=[];c>0;)S.push(c&255),c=c>>8;return new Uint8Array(S.reverse())}function R(c){return new Uint8Array(c.split("").map(function(S){return S.charCodeAt(0)}))}function M(c){var S=[],E=c.length%8?new Array(9-c.length%8).join("0"):"";c=E+c;for(var f=0;f<c.length;f+=8)S.push(parseInt(c.substr(f,8),2));return new Uint8Array(S)}function A(c){for(var S=[],E=0;E<c.length;E++){var f=c[E].data;typeof f=="object"&&(f=A(f)),typeof f=="number"&&(f=M(f.toString(2))),typeof f=="string"&&(f=R(f));var y=f.size||f.byteLength||f.length,I=Math.ceil(Math.ceil(Math.log(y)/Math.log(2))/8),P=y.toString(2),X=new Array(I*7+7+1-P.length).join("0")+P,W=new Array(I).join("0")+"1"+X;S.push(u(c[E].id)),S.push(M(W)),S.push(f)}return new Blob(S,{type:"video/webm"})}function L(c){var S=0;if(c.keyframe&&(S|=128),c.invisible&&(S|=8),c.lacing&&(S|=c.lacing<<1),c.discardable&&(S|=1),c.trackNum>127)throw"TrackNumber > 127 not supported";var E=[c.trackNum|128,c.timecode>>8,c.timecode&255,S].map(function(f){return String.fromCharCode(f)}).join("")+c.frame;return E}function T(c){for(var S=c.RIFF[0].WEBP[0],E=S.indexOf("\x9D*"),f=0,y=[];f<4;f++)y[f]=S.charCodeAt(E+3+f);var I,P,X;return X=y[1]<<8|y[0],I=X&16383,X=y[3]<<8|y[2],P=X&16383,{width:I,height:P,data:S,riff:c}}function x(c,S){return parseInt(c.substr(S+4,4).split("").map(function(E){var f=E.charCodeAt(0).toString(2);return new Array(8-f.length+1).join("0")+f}).join(""),2)}function w(c){for(var S=0,E={};S<c.length;){var f=c.substr(S,4),y=x(c,S),I=c.substr(S+4+4,y);S+=4+4+y,E[f]=E[f]||[],f==="RIFF"||f==="LIST"?E[f].push(w(I)):E[f].push(I)}return E}function U(c){return[].slice.call(new Uint8Array(new Float64Array([c]).buffer),0).map(function(S){return String.fromCharCode(S)}).reverse().join("")}var V=new d(m.map(function(c){var S=T(w(atob(c.image.slice(23))));return S.duration=c.duration,S}));postMessage(V)}return a.prototype.compile=function(m){var d=t(o);d.onmessage=function(v){if(v.data.error){console.error(v.data.error);return}m(v.data)},d.postMessage(this.frames)},{Video:a}}();typeof C<"u"&&(C.Whammy=ke);/**
 * DiskStorage is a standalone object used by {@link RecordRTC} to store recorded blobs in IndexedDB storage.
 * @summary Writing blobs into IndexedDB.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @example
 * DiskStorage.Store({
 *     audioBlob: yourAudioBlob,
 *     videoBlob: yourVideoBlob,
 *     gifBlob  : yourGifBlob
 * });
 * DiskStorage.Fetch(function(dataURL, type) {
 *     if(type === 'audioBlob') { }
 *     if(type === 'videoBlob') { }
 *     if(type === 'gifBlob')   { }
 * });
 * // DiskStorage.dataStoreName = 'recordRTC';
 * // DiskStorage.onError = function(error) { };
 * @property {function} init - This method must be called once to initialize IndexedDB ObjectStore. Though, it is auto-used internally.
 * @property {function} Fetch - This method fetches stored blobs from IndexedDB.
 * @property {function} Store - This method stores blobs in IndexedDB.
 * @property {function} onError - This function is invoked for any known/unknown error.
 * @property {string} dataStoreName - Name of the ObjectStore created in IndexedDB storage.
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 */var J={init:function(){var a=this;if(typeof indexedDB>"u"||typeof indexedDB.open>"u"){console.error("IndexedDB API are not available in this browser.");return}var t=1,o=this.dbName||location.href.replace(/\/|:|#|%|\.|\[|\]/g,""),m,d=indexedDB.open(o,t);function v(u){u.createObjectStore(a.dataStoreName)}function b(){var u=m.transaction([a.dataStoreName],"readwrite");a.videoBlob&&u.objectStore(a.dataStoreName).put(a.videoBlob,"videoBlob"),a.gifBlob&&u.objectStore(a.dataStoreName).put(a.gifBlob,"gifBlob"),a.audioBlob&&u.objectStore(a.dataStoreName).put(a.audioBlob,"audioBlob");function R(M){u.objectStore(a.dataStoreName).get(M).onsuccess=function(A){a.callback&&a.callback(A.target.result,M)}}R("audioBlob"),R("videoBlob"),R("gifBlob")}d.onerror=a.onError,d.onsuccess=function(){if(m=d.result,m.onerror=a.onError,m.setVersion)if(m.version!==t){var u=m.setVersion(t);u.onsuccess=function(){v(m),b()}}else b();else b()},d.onupgradeneeded=function(u){v(u.target.result)}},Fetch:function(a){return this.callback=a,this.init(),this},Store:function(a){return this.audioBlob=a.audioBlob,this.videoBlob=a.videoBlob,this.gifBlob=a.gifBlob,this.init(),this},onError:function(a){console.error(JSON.stringify(a,null,"	"))},dataStoreName:"recordRTC",dbName:null};typeof C<"u"&&(C.DiskStorage=J);/**
 * GifRecorder is standalone calss used by {@link RecordRTC} to record video or canvas into animated gif.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef GifRecorder
 * @class
 * @example
 * var recorder = new GifRecorder(mediaStream || canvas || context, { onGifPreview: function, onGifRecordingStarted: function, width: 1280, height: 720, frameRate: 200, quality: 10 });
 * recorder.record();
 * recorder.stop(function(blob) {
 *     img.src = URL.createObjectURL(blob);
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object or HTMLCanvasElement or CanvasRenderingContext2D.
 * @param {object} config - {disableLogs:true, initCallback: function, width: 320, height: 240, frameRate: 200, quality: 10}
 */function Ae(a,t){if(typeof GIFEncoder>"u"){var o=document.createElement("script");o.src="https://www.webrtc-experiment.com/gif-recorder.js",(document.body||document.documentElement).appendChild(o)}t=t||{};var m=a instanceof CanvasRenderingContext2D||a instanceof HTMLCanvasElement;this.record=function(){if(typeof GIFEncoder>"u"){setTimeout(x.record,1e3);return}if(!R){setTimeout(x.record,1e3);return}m||(t.width||(t.width=M.offsetWidth||320),t.height||(t.height=M.offsetHeight||240),t.video||(t.video={width:t.width,height:t.height}),t.canvas||(t.canvas={width:t.width,height:t.height}),b.width=t.canvas.width||320,b.height=t.canvas.height||240,M.width=t.video.width||320,M.height=t.video.height||240),T=new GIFEncoder,T.setRepeat(0),T.setDelay(t.frameRate||200),T.setQuality(t.quality||10),T.start(),typeof t.onGifRecordingStarted=="function"&&t.onGifRecordingStarted();function w(U){if(x.clearedRecordedData!==!0){if(d)return setTimeout(function(){w(U)},100);A=D(w),typeof L===void 0&&(L=U),!(U-L<90)&&(!m&&M.paused&&M.play(),m||u.drawImage(M,0,0,b.width,b.height),t.onGifPreview&&t.onGifPreview(b.toDataURL("image/png")),T.addFrame(u),L=U)}}A=D(w),t.initCallback&&t.initCallback()},this.stop=function(w){w=w||function(){},A&&F(A),this.blob=new Blob([new Uint8Array(T.stream().bin)],{type:"image/gif"}),w(this.blob),T.stream().bin=[]};var d=!1;this.pause=function(){d=!0},this.resume=function(){d=!1},this.clearRecordedData=function(){x.clearedRecordedData=!0,v()};function v(){T&&(T.stream().bin=[])}this.name="GifRecorder",this.toString=function(){return this.name};var b=document.createElement("canvas"),u=b.getContext("2d");m&&(a instanceof CanvasRenderingContext2D?(u=a,b=u.canvas):a instanceof HTMLCanvasElement&&(u=a.getContext("2d"),b=a));var R=!0;if(!m){var M=document.createElement("video");M.muted=!0,M.autoplay=!0,M.playsInline=!0,R=!1,M.onloadedmetadata=function(){R=!0},ie(a,M),M.play()}var A=null,L,T,x=this}typeof C<"u"&&(C.GifRecorder=Ae);function j(a,t){var o="Fake/5.0 (FakeOS) AppleWebKit/123 (KHTML, like Gecko) Fake/12.3.4567.89 Fake/123.45";(function(f){typeof C<"u"||!f||typeof window<"u"||typeof Q>"u"||(Q.navigator={userAgent:o,getUserMedia:function(){}},Q.console||(Q.console={}),(typeof Q.console.log>"u"||typeof Q.console.error>"u")&&(Q.console.error=Q.console.log=Q.console.log||function(){console.log(arguments)}),typeof document>"u"&&(f.document={documentElement:{appendChild:function(){return""}}},document.createElement=document.captureStream=document.mozCaptureStream=function(){var y={getContext:function(){return y},play:function(){},pause:function(){},drawImage:function(){},toDataURL:function(){return""},style:{}};return y},f.HTMLVideoElement=function(){}),typeof location>"u"&&(f.location={protocol:"file:",href:"",hash:""}),typeof screen>"u"&&(f.screen={width:0,height:0}),typeof M>"u"&&(f.URL={createObjectURL:function(){return""},revokeObjectURL:function(){return""}}),f.window=Q)})(typeof Q<"u"?Q:null),t=t||"multi-streams-mixer";var m=[],d=!1,v=document.createElement("canvas"),b=v.getContext("2d");v.style.opacity=0,v.style.position="absolute",v.style.zIndex=-1,v.style.top="-1000em",v.style.left="-1000em",v.className=t,(document.body||document.documentElement).appendChild(v),this.disableLogs=!1,this.frameInterval=10,this.width=360,this.height=240,this.useGainNode=!0;var u=this,R=window.AudioContext;typeof R>"u"&&(typeof webkitAudioContext<"u"&&(R=webkitAudioContext),typeof mozAudioContext<"u"&&(R=mozAudioContext));var M=window.URL;typeof M>"u"&&typeof webkitURL<"u"&&(M=webkitURL),typeof navigator<"u"&&typeof navigator.getUserMedia>"u"&&(typeof navigator.webkitGetUserMedia<"u"&&(navigator.getUserMedia=navigator.webkitGetUserMedia),typeof navigator.mozGetUserMedia<"u"&&(navigator.getUserMedia=navigator.mozGetUserMedia));var A=window.MediaStream;typeof A>"u"&&typeof webkitMediaStream<"u"&&(A=webkitMediaStream),typeof A<"u"&&typeof A.prototype.stop>"u"&&(A.prototype.stop=function(){this.getTracks().forEach(function(f){f.stop()})});var L={};typeof R<"u"?L.AudioContext=R:typeof webkitAudioContext<"u"&&(L.AudioContext=webkitAudioContext);function T(f,y){"srcObject"in y?y.srcObject=f:"mozSrcObject"in y?y.mozSrcObject=f:y.srcObject=f}this.startDrawingFrames=function(){x()};function x(){if(!d){var f=m.length,y=!1,I=[];if(m.forEach(function(X){X.stream||(X.stream={}),X.stream.fullcanvas?y=X:I.push(X)}),y)v.width=y.stream.width,v.height=y.stream.height;else if(I.length){v.width=f>1?I[0].width*2:I[0].width;var P=1;(f===3||f===4)&&(P=2),(f===5||f===6)&&(P=3),(f===7||f===8)&&(P=4),(f===9||f===10)&&(P=5),v.height=I[0].height*P}else v.width=u.width||360,v.height=u.height||240;y&&y instanceof HTMLVideoElement&&w(y),I.forEach(function(X,W){w(X,W)}),setTimeout(x,u.frameInterval)}}function w(f,y){if(!d){var I=0,P=0,X=f.width,W=f.height;y===1&&(I=f.width),y===2&&(P=f.height),y===3&&(I=f.width,P=f.height),y===4&&(P=f.height*2),y===5&&(I=f.width,P=f.height*2),y===6&&(P=f.height*3),y===7&&(I=f.width,P=f.height*3),typeof f.stream.left<"u"&&(I=f.stream.left),typeof f.stream.top<"u"&&(P=f.stream.top),typeof f.stream.width<"u"&&(X=f.stream.width),typeof f.stream.height<"u"&&(W=f.stream.height),b.drawImage(f,I,P,X,W),typeof f.stream.onRender=="function"&&f.stream.onRender(b,I,P,X,W,y)}}function U(){d=!1;var f=V(),y=c();return y&&y.getTracks().filter(function(I){return I.kind==="audio"}).forEach(function(I){f.addTrack(I)}),a.forEach(function(I){I.fullcanvas}),f}function V(){E();var f;"captureStream"in v?f=v.captureStream():"mozCaptureStream"in v?f=v.mozCaptureStream():u.disableLogs||console.error("Upgrade to latest Chrome or otherwise enable this flag: chrome://flags/#enable-experimental-web-platform-features");var y=new A;return f.getTracks().filter(function(I){return I.kind==="video"}).forEach(function(I){y.addTrack(I)}),v.stream=y,y}function c(){L.AudioContextConstructor||(L.AudioContextConstructor=new L.AudioContext),u.audioContext=L.AudioContextConstructor,u.audioSources=[],u.useGainNode===!0&&(u.gainNode=u.audioContext.createGain(),u.gainNode.connect(u.audioContext.destination),u.gainNode.gain.value=0);var f=0;if(a.forEach(function(y){if(!!y.getTracks().filter(function(P){return P.kind==="audio"}).length){f++;var I=u.audioContext.createMediaStreamSource(y);u.useGainNode===!0&&I.connect(u.gainNode),u.audioSources.push(I)}}),!!f)return u.audioDestination=u.audioContext.createMediaStreamDestination(),u.audioSources.forEach(function(y){y.connect(u.audioDestination)}),u.audioDestination.stream}function S(f){var y=document.createElement("video");return T(f,y),y.className=t,y.muted=!0,y.volume=0,y.width=f.width||u.width||360,y.height=f.height||u.height||240,y.play(),y}this.appendStreams=function(f){if(!f)throw"First parameter is required.";f instanceof Array||(f=[f]),f.forEach(function(y){var I=new A;if(y.getTracks().filter(function(W){return W.kind==="video"}).length){var P=S(y);P.stream=y,m.push(P),I.addTrack(y.getTracks().filter(function(W){return W.kind==="video"})[0])}if(y.getTracks().filter(function(W){return W.kind==="audio"}).length){var X=u.audioContext.createMediaStreamSource(y);u.audioDestination=u.audioContext.createMediaStreamDestination(),X.connect(u.audioDestination),I.addTrack(u.audioDestination.stream.getTracks().filter(function(W){return W.kind==="audio"})[0])}a.push(I)})},this.releaseStreams=function(){m=[],d=!0,u.gainNode&&(u.gainNode.disconnect(),u.gainNode=null),u.audioSources.length&&(u.audioSources.forEach(function(f){f.disconnect()}),u.audioSources=[]),u.audioDestination&&(u.audioDestination.disconnect(),u.audioDestination=null),u.audioContext&&u.audioContext.close(),u.audioContext=null,b.clearRect(0,0,v.width,v.height),v.stream&&(v.stream.stop(),v.stream=null)},this.resetVideoStreams=function(f){f&&!(f instanceof Array)&&(f=[f]),E(f)};function E(f){m=[],f=f||a,f.forEach(function(y){if(!!y.getTracks().filter(function(P){return P.kind==="video"}).length){var I=S(y);I.stream=y,m.push(I)}})}this.name="MultiStreamsMixer",this.toString=function(){return this.name},this.getMixedStream=U}typeof C>"u"&&(Z.exports=j);/**
 * MultiStreamRecorder can record multiple videos in single container.
 * @summary Multi-videos recorder.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef MultiStreamRecorder
 * @class
 * @example
 * var options = {
 *     mimeType: 'video/webm'
 * }
 * var recorder = new MultiStreamRecorder(ArrayOfMediaStreams, options);
 * recorder.record();
 * recorder.stop(function(blob) {
 *     video.src = URL.createObjectURL(blob);
 *
 *     // or
 *     var blob = recorder.blob;
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStreams} mediaStreams - Array of MediaStreams.
 * @param {object} config - {disableLogs:true, frameInterval: 1, mimeType: "video/webm"}
 */function z(a,t){a=a||[];var o=this,m,d;t=t||{elementClass:"multi-streams-mixer",mimeType:"video/webm",video:{width:360,height:240}},t.frameInterval||(t.frameInterval=10),t.video||(t.video={}),t.video.width||(t.video.width=360),t.video.height||(t.video.height=240),this.record=function(){m=new j(a,t.elementClass||"multi-streams-mixer"),v().length&&(m.frameInterval=t.frameInterval||10,m.width=t.video.width||360,m.height=t.video.height||240,m.startDrawingFrames()),t.previewStream&&typeof t.previewStream=="function"&&t.previewStream(m.getMixedStream()),d=new N(m.getMixedStream(),t),d.record()};function v(){var b=[];return a.forEach(function(u){H(u,"video").forEach(function(R){b.push(R)})}),b}this.stop=function(b){!d||d.stop(function(u){o.blob=u,b(u),o.clearRecordedData()})},this.pause=function(){d&&d.pause()},this.resume=function(){d&&d.resume()},this.clearRecordedData=function(){d&&(d.clearRecordedData(),d=null),m&&(m.releaseStreams(),m=null)},this.addStreams=function(b){if(!b)throw"First parameter is required.";b instanceof Array||(b=[b]),a.concat(b),!(!d||!m)&&(m.appendStreams(b),t.previewStream&&typeof t.previewStream=="function"&&t.previewStream(m.getMixedStream()))},this.resetVideoStreams=function(b){!m||(b&&!(b instanceof Array)&&(b=[b]),m.resetVideoStreams(b))},this.getMixer=function(){return m},this.name="MultiStreamRecorder",this.toString=function(){return this.name}}typeof C<"u"&&(C.MultiStreamRecorder=z);/**
 * RecordRTCPromisesHandler adds promises support in {@link RecordRTC}. Try a {@link https://github.com/muaz-khan/RecordRTC/blob/master/simple-demos/RecordRTCPromisesHandler.html|demo here}
 * @summary Promises for {@link RecordRTC}
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef RecordRTCPromisesHandler
 * @class
 * @example
 * var recorder = new RecordRTCPromisesHandler(mediaStream, options);
 * recorder.startRecording()
 *         .then(successCB)
 *         .catch(errorCB);
 * // Note: You can access all RecordRTC API using "recorder.recordRTC" e.g. 
 * recorder.recordRTC.onStateChanged = function(state) {};
 * recorder.recordRTC.setRecordingDuration(5000);
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - Single media-stream object, array of media-streams, html-canvas-element, etc.
 * @param {object} config - {type:"video", recorderType: MediaStreamRecorder, disableLogs: true, numberOfAudioChannels: 1, bufferSize: 0, sampleRate: 0, video: HTMLVideoElement, etc.}
 * @throws Will throw an error if "new" keyword is not used to initiate "RecordRTCPromisesHandler". Also throws error if first argument "MediaStream" is missing.
 * @requires {@link RecordRTC}
 */function $(a,t){if(!this)throw'Use "new RecordRTCPromisesHandler()"';if(typeof a>"u")throw'First argument "MediaStream" is required.';var o=this;o.recordRTC=new C(a,t),this.startRecording=function(){return new Promise(function(m,d){try{o.recordRTC.startRecording(),m()}catch(v){d(v)}})},this.stopRecording=function(){return new Promise(function(m,d){try{o.recordRTC.stopRecording(function(v){if(o.blob=o.recordRTC.getBlob(),!o.blob||!o.blob.size){d("Empty blob.",o.blob);return}m(v)})}catch(v){d(v)}})},this.pauseRecording=function(){return new Promise(function(m,d){try{o.recordRTC.pauseRecording(),m()}catch(v){d(v)}})},this.resumeRecording=function(){return new Promise(function(m,d){try{o.recordRTC.resumeRecording(),m()}catch(v){d(v)}})},this.getDataURL=function(m){return new Promise(function(d,v){try{o.recordRTC.getDataURL(function(b){d(b)})}catch(b){v(b)}})},this.getBlob=function(){return new Promise(function(m,d){try{m(o.recordRTC.getBlob())}catch(v){d(v)}})},this.getInternalRecorder=function(){return new Promise(function(m,d){try{m(o.recordRTC.getInternalRecorder())}catch(v){d(v)}})},this.reset=function(){return new Promise(function(m,d){try{m(o.recordRTC.reset())}catch(v){d(v)}})},this.destroy=function(){return new Promise(function(m,d){try{m(o.recordRTC.destroy())}catch(v){d(v)}})},this.getState=function(){return new Promise(function(m,d){try{m(o.recordRTC.getState())}catch(v){d(v)}})},this.blob=null,this.version="5.6.2"}typeof C<"u"&&(C.RecordRTCPromisesHandler=$);/**
 * WebAssemblyRecorder lets you create webm videos in JavaScript via WebAssembly. The library consumes raw RGBA32 buffers (4 bytes per pixel) and turns them into a webm video with the given framerate and quality. This makes it compatible out-of-the-box with ImageData from a CANVAS. With realtime mode you can also use webm-wasm for streaming webm videos.
 * @summary Video recording feature in Chrome, Firefox and maybe Edge.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef WebAssemblyRecorder
 * @class
 * @example
 * var recorder = new WebAssemblyRecorder(mediaStream);
 * recorder.record();
 * recorder.stop(function(blob) {
 *     video.src = URL.createObjectURL(blob);
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @param {object} config - {webAssemblyPath:'webm-wasm.wasm',workerPath: 'webm-worker.js', frameRate: 30, width: 1920, height: 1080, bitrate: 1024, realtime: true}
 */function ee(a,t){(typeof ReadableStream>"u"||typeof WritableStream>"u")&&console.error("Following polyfill is strongly recommended: https://unpkg.com/@mattiasbuelens/web-streams-polyfill/dist/polyfill.min.js"),t=t||{},t.width=t.width||640,t.height=t.height||480,t.frameRate=t.frameRate||30,t.bitrate=t.bitrate||1200,t.realtime=t.realtime||!0;var o;function m(){return new ReadableStream({start:function(M){var A=document.createElement("canvas"),L=document.createElement("video"),T=!0;L.srcObject=a,L.muted=!0,L.height=t.height,L.width=t.width,L.volume=0,L.onplaying=function(){A.width=t.width,A.height=t.height;var x=A.getContext("2d"),w=1e3/t.frameRate,U=setInterval(function(){if(o&&(clearInterval(U),M.close()),T&&(T=!1,t.onVideoProcessStarted&&t.onVideoProcessStarted()),x.drawImage(L,0,0),M._controlledReadableStream.state!=="closed")try{M.enqueue(x.getImageData(0,0,t.width,t.height))}catch{}},w)},L.play()}})}var d;function v(M,A){if(!t.workerPath&&!A){o=!1,fetch("https://unpkg.com/webm-wasm@latest/dist/webm-worker.js").then(function(T){T.arrayBuffer().then(function(x){v(M,x)})});return}if(!t.workerPath&&A instanceof ArrayBuffer){var L=new Blob([A],{type:"text/javascript"});t.workerPath=G.createObjectURL(L)}t.workerPath||console.error("workerPath parameter is missing."),d=new Worker(t.workerPath),d.postMessage(t.webAssemblyPath||"https://unpkg.com/webm-wasm@latest/dist/webm-wasm.wasm"),d.addEventListener("message",function(T){T.data==="READY"?(d.postMessage({width:t.width,height:t.height,bitrate:t.bitrate||1200,timebaseDen:t.frameRate||30,realtime:t.realtime}),m().pipeTo(new WritableStream({write:function(x){if(o){console.error("Got image, but recorder is finished!");return}d.postMessage(x.data.buffer,[x.data.buffer])}}))):T.data&&(b||R.push(T.data))})}this.record=function(){R=[],b=!1,this.blob=null,v(a),typeof t.initCallback=="function"&&t.initCallback()};var b;this.pause=function(){b=!0},this.resume=function(){b=!1};function u(M){if(!d){M&&M();return}d.addEventListener("message",function(A){A.data===null&&(d.terminate(),d=null,M&&M())}),d.postMessage(null)}var R=[];this.stop=function(M){o=!0;var A=this;u(function(){A.blob=new Blob(R,{type:"video/webm"}),M(A.blob)})},this.name="WebAssemblyRecorder",this.toString=function(){return this.name},this.clearRecordedData=function(){R=[],b=!1,this.blob=null},this.blob=null}typeof C<"u"&&(C.WebAssemblyRecorder=ee)})(ot);var at={};/*!
 *  howler.js v2.2.3
 *  howlerjs.com
 *
 *  (c) 2013-2020, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */(function(Z){(function(){var C=function(){this.init()};C.prototype={init:function(){var e=this||i;return e._counter=1e3,e._html5AudioPool=[],e.html5PoolSize=10,e._codecs={},e._howls=[],e._muted=!1,e._volume=1,e._canPlayEvent="canplaythrough",e._navigator=typeof window<"u"&&window.navigator?window.navigator:null,e.masterGain=null,e.noAudio=!1,e.usingWebAudio=!0,e.autoSuspend=!0,e.ctx=null,e.autoUnlock=!0,e._setup(),e},volume:function(e){var r=this||i;if(e=parseFloat(e),r.ctx||G(),typeof e<"u"&&e>=0&&e<=1){if(r._volume=e,r._muted)return r;r.usingWebAudio&&r.masterGain.gain.setValueAtTime(e,i.ctx.currentTime);for(var n=0;n<r._howls.length;n++)if(!r._howls[n]._webAudio)for(var s=r._howls[n]._getSoundIds(),h=0;h<s.length;h++){var g=r._howls[n]._soundById(s[h]);g&&g._node&&(g._node.volume=g._volume*e)}return r}return r._volume},mute:function(e){var r=this||i;r.ctx||G(),r._muted=e,r.usingWebAudio&&r.masterGain.gain.setValueAtTime(e?0:r._volume,i.ctx.currentTime);for(var n=0;n<r._howls.length;n++)if(!r._howls[n]._webAudio)for(var s=r._howls[n]._getSoundIds(),h=0;h<s.length;h++){var g=r._howls[n]._soundById(s[h]);g&&g._node&&(g._node.muted=e?!0:g._muted)}return r},stop:function(){for(var e=this||i,r=0;r<e._howls.length;r++)e._howls[r].stop();return e},unload:function(){for(var e=this||i,r=e._howls.length-1;r>=0;r--)e._howls[r].unload();return e.usingWebAudio&&e.ctx&&typeof e.ctx.close<"u"&&(e.ctx.close(),e.ctx=null,G()),e},codecs:function(e){return(this||i)._codecs[e.replace(/^x-/,"")]},_setup:function(){var e=this||i;if(e.state=e.ctx&&e.ctx.state||"suspended",e._autoSuspend(),!e.usingWebAudio)if(typeof Audio<"u")try{var r=new Audio;typeof r.oncanplaythrough>"u"&&(e._canPlayEvent="canplay")}catch{e.noAudio=!0}else e.noAudio=!0;try{var r=new Audio;r.muted&&(e.noAudio=!0)}catch{}return e.noAudio||e._setupCodecs(),e},_setupCodecs:function(){var e=this||i,r=null;try{r=typeof Audio<"u"?new Audio:null}catch{return e}if(!r||typeof r.canPlayType!="function")return e;var n=r.canPlayType("audio/mpeg;").replace(/^no$/,""),s=e._navigator?e._navigator.userAgent:"",h=s.match(/OPR\/([0-6].)/g),g=h&&parseInt(h[0].split("/")[1],10)<33,l=s.indexOf("Safari")!==-1&&s.indexOf("Chrome")===-1,B=s.match(/Version\/(.*?) /),q=l&&B&&parseInt(B[1],10)<15;return e._codecs={mp3:!!(!g&&(n||r.canPlayType("audio/mp3;").replace(/^no$/,""))),mpeg:!!n,opus:!!r.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!r.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!r.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(r.canPlayType('audio/wav; codecs="1"')||r.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!r.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!r.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(r.canPlayType("audio/x-m4a;")||r.canPlayType("audio/m4a;")||r.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(r.canPlayType("audio/x-m4b;")||r.canPlayType("audio/m4b;")||r.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(r.canPlayType("audio/x-mp4;")||r.canPlayType("audio/mp4;")||r.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!(!q&&r.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:!!(!q&&r.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:!!r.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(r.canPlayType("audio/x-flac;")||r.canPlayType("audio/flac;")).replace(/^no$/,"")},e},_unlockAudio:function(){var e=this||i;if(!(e._audioUnlocked||!e.ctx)){e._audioUnlocked=!1,e.autoUnlock=!1,!e._mobileUnloaded&&e.ctx.sampleRate!==44100&&(e._mobileUnloaded=!0,e.unload()),e._scratchBuffer=e.ctx.createBuffer(1,1,22050);var r=function(n){for(;e._html5AudioPool.length<e.html5PoolSize;)try{var s=new Audio;s._unlocked=!0,e._releaseHtml5Audio(s)}catch{e.noAudio=!0;break}for(var h=0;h<e._howls.length;h++)if(!e._howls[h]._webAudio)for(var g=e._howls[h]._getSoundIds(),l=0;l<g.length;l++){var B=e._howls[h]._soundById(g[l]);B&&B._node&&!B._node._unlocked&&(B._node._unlocked=!0,B._node.load())}e._autoResume();var q=e.ctx.createBufferSource();q.buffer=e._scratchBuffer,q.connect(e.ctx.destination),typeof q.start>"u"?q.noteOn(0):q.start(0),typeof e.ctx.resume=="function"&&e.ctx.resume(),q.onended=function(){q.disconnect(0),e._audioUnlocked=!0,document.removeEventListener("touchstart",r,!0),document.removeEventListener("touchend",r,!0),document.removeEventListener("click",r,!0),document.removeEventListener("keydown",r,!0);for(var H=0;H<e._howls.length;H++)e._howls[H]._emit("unlock")}};return document.addEventListener("touchstart",r,!0),document.addEventListener("touchend",r,!0),document.addEventListener("click",r,!0),document.addEventListener("keydown",r,!0),e}},_obtainHtml5Audio:function(){var e=this||i;if(e._html5AudioPool.length)return e._html5AudioPool.pop();var r=new Audio().play();return r&&typeof Promise<"u"&&(r instanceof Promise||typeof r.then=="function")&&r.catch(function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")}),new Audio},_releaseHtml5Audio:function(e){var r=this||i;return e._unlocked&&r._html5AudioPool.push(e),r},_autoSuspend:function(){var e=this;if(!(!e.autoSuspend||!e.ctx||typeof e.ctx.suspend>"u"||!i.usingWebAudio)){for(var r=0;r<e._howls.length;r++)if(e._howls[r]._webAudio){for(var n=0;n<e._howls[r]._sounds.length;n++)if(!e._howls[r]._sounds[n]._paused)return e}return e._suspendTimer&&clearTimeout(e._suspendTimer),e._suspendTimer=setTimeout(function(){if(!!e.autoSuspend){e._suspendTimer=null,e.state="suspending";var s=function(){e.state="suspended",e._resumeAfterSuspend&&(delete e._resumeAfterSuspend,e._autoResume())};e.ctx.suspend().then(s,s)}},3e4),e}},_autoResume:function(){var e=this;if(!(!e.ctx||typeof e.ctx.resume>"u"||!i.usingWebAudio))return e.state==="running"&&e.ctx.state!=="interrupted"&&e._suspendTimer?(clearTimeout(e._suspendTimer),e._suspendTimer=null):e.state==="suspended"||e.state==="running"&&e.ctx.state==="interrupted"?(e.ctx.resume().then(function(){e.state="running";for(var r=0;r<e._howls.length;r++)e._howls[r]._emit("resume")}),e._suspendTimer&&(clearTimeout(e._suspendTimer),e._suspendTimer=null)):e.state==="suspending"&&(e._resumeAfterSuspend=!0),e}};var i=new C,_=function(e){var r=this;if(!e.src||e.src.length===0){console.error("An array of source files must be passed with any new Howl.");return}r.init(e)};_.prototype={init:function(e){var r=this;return i.ctx||G(),r._autoplay=e.autoplay||!1,r._format=typeof e.format!="string"?e.format:[e.format],r._html5=e.html5||!1,r._muted=e.mute||!1,r._loop=e.loop||!1,r._pool=e.pool||5,r._preload=typeof e.preload=="boolean"||e.preload==="metadata"?e.preload:!0,r._rate=e.rate||1,r._sprite=e.sprite||{},r._src=typeof e.src!="string"?e.src:[e.src],r._volume=e.volume!==void 0?e.volume:1,r._xhr={method:e.xhr&&e.xhr.method?e.xhr.method:"GET",headers:e.xhr&&e.xhr.headers?e.xhr.headers:null,withCredentials:e.xhr&&e.xhr.withCredentials?e.xhr.withCredentials:!1},r._duration=0,r._state="unloaded",r._sounds=[],r._endTimers={},r._queue=[],r._playLock=!1,r._onend=e.onend?[{fn:e.onend}]:[],r._onfade=e.onfade?[{fn:e.onfade}]:[],r._onload=e.onload?[{fn:e.onload}]:[],r._onloaderror=e.onloaderror?[{fn:e.onloaderror}]:[],r._onplayerror=e.onplayerror?[{fn:e.onplayerror}]:[],r._onpause=e.onpause?[{fn:e.onpause}]:[],r._onplay=e.onplay?[{fn:e.onplay}]:[],r._onstop=e.onstop?[{fn:e.onstop}]:[],r._onmute=e.onmute?[{fn:e.onmute}]:[],r._onvolume=e.onvolume?[{fn:e.onvolume}]:[],r._onrate=e.onrate?[{fn:e.onrate}]:[],r._onseek=e.onseek?[{fn:e.onseek}]:[],r._onunlock=e.onunlock?[{fn:e.onunlock}]:[],r._onresume=[],r._webAudio=i.usingWebAudio&&!r._html5,typeof i.ctx<"u"&&i.ctx&&i.autoUnlock&&i._unlockAudio(),i._howls.push(r),r._autoplay&&r._queue.push({event:"play",action:function(){r.play()}}),r._preload&&r._preload!=="none"&&r.load(),r},load:function(){var e=this,r=null;if(i.noAudio){e._emit("loaderror",null,"No audio support.");return}typeof e._src=="string"&&(e._src=[e._src]);for(var n=0;n<e._src.length;n++){var s,h;if(e._format&&e._format[n])s=e._format[n];else{if(h=e._src[n],typeof h!="string"){e._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}s=/^data:audio\/([^;,]+);/i.exec(h),s||(s=/\.([^.]+)$/.exec(h.split("?",1)[0])),s&&(s=s[1].toLowerCase())}if(s||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),s&&i.codecs(s)){r=e._src[n];break}}if(!r){e._emit("loaderror",null,"No codec support for selected audio sources.");return}return e._src=r,e._state="loading",window.location.protocol==="https:"&&r.slice(0,5)==="http:"&&(e._html5=!0,e._webAudio=!1),new p(e),e._webAudio&&D(e),e},play:function(e,r){var n=this,s=null;if(typeof e=="number")s=e,e=null;else{if(typeof e=="string"&&n._state==="loaded"&&!n._sprite[e])return null;if(typeof e>"u"&&(e="__default",!n._playLock)){for(var h=0,g=0;g<n._sounds.length;g++)n._sounds[g]._paused&&!n._sounds[g]._ended&&(h++,s=n._sounds[g]._id);h===1?e=null:s=null}}var l=s?n._soundById(s):n._inactiveSound();if(!l)return null;if(s&&!e&&(e=l._sprite||"__default"),n._state!=="loaded"){l._sprite=e,l._ended=!1;var B=l._id;return n._queue.push({event:"play",action:function(){n.play(B)}}),B}if(s&&!l._paused)return r||n._loadQueue("play"),l._id;n._webAudio&&i._autoResume();var q=Math.max(0,l._seek>0?l._seek:n._sprite[e][0]/1e3),H=Math.max(0,(n._sprite[e][0]+n._sprite[e][1])/1e3-q),ie=H*1e3/Math.abs(l._rate),_e=n._sprite[e][0]/1e3,fe=(n._sprite[e][0]+n._sprite[e][1])/1e3;l._sprite=e,l._ended=!1;var le=function(){l._paused=!1,l._seek=q,l._start=_e,l._stop=fe,l._loop=!!(l._loop||n._sprite[e][2])};if(q>=fe){n._ended(l);return}var N=l._node;if(n._webAudio){var be=function(){n._playLock=!1,le(),n._refreshBuffer(l);var J=l._muted||n._muted?0:l._volume;N.gain.setValueAtTime(J,i.ctx.currentTime),l._playStart=i.ctx.currentTime,typeof N.bufferSource.start>"u"?l._loop?N.bufferSource.noteGrainOn(0,q,86400):N.bufferSource.noteGrainOn(0,q,H):l._loop?N.bufferSource.start(0,q,86400):N.bufferSource.start(0,q,H),ie!==1/0&&(n._endTimers[l._id]=setTimeout(n._ended.bind(n,l),ie)),r||setTimeout(function(){n._emit("play",l._id),n._loadQueue()},0)};i.state==="running"&&i.ctx.state!=="interrupted"?be():(n._playLock=!0,n.once("resume",be),n._clearTimer(l._id))}else{var we=function(){N.currentTime=q,N.muted=l._muted||n._muted||i._muted||N.muted,N.volume=l._volume*i.volume(),N.playbackRate=l._rate;try{var J=N.play();if(J&&typeof Promise<"u"&&(J instanceof Promise||typeof J.then=="function")?(n._playLock=!0,le(),J.then(function(){n._playLock=!1,N._unlocked=!0,r?n._loadQueue():n._emit("play",l._id)}).catch(function(){n._playLock=!1,n._emit("playerror",l._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),l._ended=!0,l._paused=!0})):r||(n._playLock=!1,le(),n._emit("play",l._id)),N.playbackRate=l._rate,N.paused){n._emit("playerror",l._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");return}e!=="__default"||l._loop?n._endTimers[l._id]=setTimeout(n._ended.bind(n,l),ie):(n._endTimers[l._id]=function(){n._ended(l),N.removeEventListener("ended",n._endTimers[l._id],!1)},N.addEventListener("ended",n._endTimers[l._id],!1))}catch(Ae){n._emit("playerror",l._id,Ae)}};N.src==="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"&&(N.src=n._src,N.load());var Se=window&&window.ejecta||!N.readyState&&i._navigator.isCocoonJS;if(N.readyState>=3||Se)we();else{n._playLock=!0,n._state="loading";var ke=function(){n._state="loaded",we(),N.removeEventListener(i._canPlayEvent,ke,!1)};N.addEventListener(i._canPlayEvent,ke,!1),n._clearTimer(l._id)}}return l._id},pause:function(e){var r=this;if(r._state!=="loaded"||r._playLock)return r._queue.push({event:"pause",action:function(){r.pause(e)}}),r;for(var n=r._getSoundIds(e),s=0;s<n.length;s++){r._clearTimer(n[s]);var h=r._soundById(n[s]);if(h&&!h._paused&&(h._seek=r.seek(n[s]),h._rateSeek=0,h._paused=!0,r._stopFade(n[s]),h._node))if(r._webAudio){if(!h._node.bufferSource)continue;typeof h._node.bufferSource.stop>"u"?h._node.bufferSource.noteOff(0):h._node.bufferSource.stop(0),r._cleanBuffer(h._node)}else(!isNaN(h._node.duration)||h._node.duration===1/0)&&h._node.pause();arguments[1]||r._emit("pause",h?h._id:null)}return r},stop:function(e,r){var n=this;if(n._state!=="loaded"||n._playLock)return n._queue.push({event:"stop",action:function(){n.stop(e)}}),n;for(var s=n._getSoundIds(e),h=0;h<s.length;h++){n._clearTimer(s[h]);var g=n._soundById(s[h]);g&&(g._seek=g._start||0,g._rateSeek=0,g._paused=!0,g._ended=!0,n._stopFade(s[h]),g._node&&(n._webAudio?g._node.bufferSource&&(typeof g._node.bufferSource.stop>"u"?g._node.bufferSource.noteOff(0):g._node.bufferSource.stop(0),n._cleanBuffer(g._node)):(!isNaN(g._node.duration)||g._node.duration===1/0)&&(g._node.currentTime=g._start||0,g._node.pause(),g._node.duration===1/0&&n._clearSound(g._node))),r||n._emit("stop",g._id))}return n},mute:function(e,r){var n=this;if(n._state!=="loaded"||n._playLock)return n._queue.push({event:"mute",action:function(){n.mute(e,r)}}),n;if(typeof r>"u")if(typeof e=="boolean")n._muted=e;else return n._muted;for(var s=n._getSoundIds(r),h=0;h<s.length;h++){var g=n._soundById(s[h]);g&&(g._muted=e,g._interval&&n._stopFade(g._id),n._webAudio&&g._node?g._node.gain.setValueAtTime(e?0:g._volume,i.ctx.currentTime):g._node&&(g._node.muted=i._muted?!0:e),n._emit("mute",g._id))}return n},volume:function(){var e=this,r=arguments,n,s;if(r.length===0)return e._volume;if(r.length===1||r.length===2&&typeof r[1]>"u"){var h=e._getSoundIds(),g=h.indexOf(r[0]);g>=0?s=parseInt(r[0],10):n=parseFloat(r[0])}else r.length>=2&&(n=parseFloat(r[0]),s=parseInt(r[1],10));var l;if(typeof n<"u"&&n>=0&&n<=1){if(e._state!=="loaded"||e._playLock)return e._queue.push({event:"volume",action:function(){e.volume.apply(e,r)}}),e;typeof s>"u"&&(e._volume=n),s=e._getSoundIds(s);for(var B=0;B<s.length;B++)l=e._soundById(s[B]),l&&(l._volume=n,r[2]||e._stopFade(s[B]),e._webAudio&&l._node&&!l._muted?l._node.gain.setValueAtTime(n,i.ctx.currentTime):l._node&&!l._muted&&(l._node.volume=n*i.volume()),e._emit("volume",l._id))}else return l=s?e._soundById(s):e._sounds[0],l?l._volume:0;return e},fade:function(e,r,n,s){var h=this;if(h._state!=="loaded"||h._playLock)return h._queue.push({event:"fade",action:function(){h.fade(e,r,n,s)}}),h;e=Math.min(Math.max(0,parseFloat(e)),1),r=Math.min(Math.max(0,parseFloat(r)),1),n=parseFloat(n),h.volume(e,s);for(var g=h._getSoundIds(s),l=0;l<g.length;l++){var B=h._soundById(g[l]);if(B){if(s||h._stopFade(g[l]),h._webAudio&&!B._muted){var q=i.ctx.currentTime,H=q+n/1e3;B._volume=e,B._node.gain.setValueAtTime(e,q),B._node.gain.linearRampToValueAtTime(r,H)}h._startFadeInterval(B,e,r,n,g[l],typeof s>"u")}}return h},_startFadeInterval:function(e,r,n,s,h,g){var l=this,B=r,q=n-r,H=Math.abs(q/.01),ie=Math.max(4,H>0?s/H:s),_e=Date.now();e._fadeTo=n,e._interval=setInterval(function(){var fe=(Date.now()-_e)/s;_e=Date.now(),B+=q*fe,B=Math.round(B*100)/100,q<0?B=Math.max(n,B):B=Math.min(n,B),l._webAudio?e._volume=B:l.volume(B,e._id,!0),g&&(l._volume=B),(n<r&&B<=n||n>r&&B>=n)&&(clearInterval(e._interval),e._interval=null,e._fadeTo=null,l.volume(n,e._id),l._emit("fade",e._id))},ie)},_stopFade:function(e){var r=this,n=r._soundById(e);return n&&n._interval&&(r._webAudio&&n._node.gain.cancelScheduledValues(i.ctx.currentTime),clearInterval(n._interval),n._interval=null,r.volume(n._fadeTo,e),n._fadeTo=null,r._emit("fade",e)),r},loop:function(){var e=this,r=arguments,n,s,h;if(r.length===0)return e._loop;if(r.length===1)if(typeof r[0]=="boolean")n=r[0],e._loop=n;else return h=e._soundById(parseInt(r[0],10)),h?h._loop:!1;else r.length===2&&(n=r[0],s=parseInt(r[1],10));for(var g=e._getSoundIds(s),l=0;l<g.length;l++)h=e._soundById(g[l]),h&&(h._loop=n,e._webAudio&&h._node&&h._node.bufferSource&&(h._node.bufferSource.loop=n,n&&(h._node.bufferSource.loopStart=h._start||0,h._node.bufferSource.loopEnd=h._stop,e.playing(g[l])&&(e.pause(g[l],!0),e.play(g[l],!0)))));return e},rate:function(){var e=this,r=arguments,n,s;if(r.length===0)s=e._sounds[0]._id;else if(r.length===1){var h=e._getSoundIds(),g=h.indexOf(r[0]);g>=0?s=parseInt(r[0],10):n=parseFloat(r[0])}else r.length===2&&(n=parseFloat(r[0]),s=parseInt(r[1],10));var l;if(typeof n=="number"){if(e._state!=="loaded"||e._playLock)return e._queue.push({event:"rate",action:function(){e.rate.apply(e,r)}}),e;typeof s>"u"&&(e._rate=n),s=e._getSoundIds(s);for(var B=0;B<s.length;B++)if(l=e._soundById(s[B]),l){e.playing(s[B])&&(l._rateSeek=e.seek(s[B]),l._playStart=e._webAudio?i.ctx.currentTime:l._playStart),l._rate=n,e._webAudio&&l._node&&l._node.bufferSource?l._node.bufferSource.playbackRate.setValueAtTime(n,i.ctx.currentTime):l._node&&(l._node.playbackRate=n);var q=e.seek(s[B]),H=(e._sprite[l._sprite][0]+e._sprite[l._sprite][1])/1e3-q,ie=H*1e3/Math.abs(l._rate);(e._endTimers[s[B]]||!l._paused)&&(e._clearTimer(s[B]),e._endTimers[s[B]]=setTimeout(e._ended.bind(e,l),ie)),e._emit("rate",l._id)}}else return l=e._soundById(s),l?l._rate:e._rate;return e},seek:function(){var e=this,r=arguments,n,s;if(r.length===0)e._sounds.length&&(s=e._sounds[0]._id);else if(r.length===1){var h=e._getSoundIds(),g=h.indexOf(r[0]);g>=0?s=parseInt(r[0],10):e._sounds.length&&(s=e._sounds[0]._id,n=parseFloat(r[0]))}else r.length===2&&(n=parseFloat(r[0]),s=parseInt(r[1],10));if(typeof s>"u")return 0;if(typeof n=="number"&&(e._state!=="loaded"||e._playLock))return e._queue.push({event:"seek",action:function(){e.seek.apply(e,r)}}),e;var l=e._soundById(s);if(l)if(typeof n=="number"&&n>=0){var B=e.playing(s);B&&e.pause(s,!0),l._seek=n,l._ended=!1,e._clearTimer(s),!e._webAudio&&l._node&&!isNaN(l._node.duration)&&(l._node.currentTime=n);var q=function(){B&&e.play(s,!0),e._emit("seek",s)};if(B&&!e._webAudio){var H=function(){e._playLock?setTimeout(H,0):q()};setTimeout(H,0)}else q()}else if(e._webAudio){var ie=e.playing(s)?i.ctx.currentTime-l._playStart:0,_e=l._rateSeek?l._rateSeek-l._seek:0;return l._seek+(_e+ie*Math.abs(l._rate))}else return l._node.currentTime;return e},playing:function(e){var r=this;if(typeof e=="number"){var n=r._soundById(e);return n?!n._paused:!1}for(var s=0;s<r._sounds.length;s++)if(!r._sounds[s]._paused)return!0;return!1},duration:function(e){var r=this,n=r._duration,s=r._soundById(e);return s&&(n=r._sprite[s._sprite][1]/1e3),n},state:function(){return this._state},unload:function(){for(var e=this,r=e._sounds,n=0;n<r.length;n++)r[n]._paused||e.stop(r[n]._id),e._webAudio||(e._clearSound(r[n]._node),r[n]._node.removeEventListener("error",r[n]._errorFn,!1),r[n]._node.removeEventListener(i._canPlayEvent,r[n]._loadFn,!1),r[n]._node.removeEventListener("ended",r[n]._endFn,!1),i._releaseHtml5Audio(r[n]._node)),delete r[n]._node,e._clearTimer(r[n]._id);var s=i._howls.indexOf(e);s>=0&&i._howls.splice(s,1);var h=!0;for(n=0;n<i._howls.length;n++)if(i._howls[n]._src===e._src||e._src.indexOf(i._howls[n]._src)>=0){h=!1;break}return O&&h&&delete O[e._src],i.noAudio=!1,e._state="unloaded",e._sounds=[],e=null,null},on:function(e,r,n,s){var h=this,g=h["_on"+e];return typeof r=="function"&&g.push(s?{id:n,fn:r,once:s}:{id:n,fn:r}),h},off:function(e,r,n){var s=this,h=s["_on"+e],g=0;if(typeof r=="number"&&(n=r,r=null),r||n)for(g=0;g<h.length;g++){var l=n===h[g].id;if(r===h[g].fn&&l||!r&&l){h.splice(g,1);break}}else if(e)s["_on"+e]=[];else{var B=Object.keys(s);for(g=0;g<B.length;g++)B[g].indexOf("_on")===0&&Array.isArray(s[B[g]])&&(s[B[g]]=[])}return s},once:function(e,r,n){var s=this;return s.on(e,r,n,1),s},_emit:function(e,r,n){for(var s=this,h=s["_on"+e],g=h.length-1;g>=0;g--)(!h[g].id||h[g].id===r||e==="load")&&(setTimeout(function(l){l.call(this,r,n)}.bind(s,h[g].fn),0),h[g].once&&s.off(e,h[g].fn,h[g].id));return s._loadQueue(e),s},_loadQueue:function(e){var r=this;if(r._queue.length>0){var n=r._queue[0];n.event===e&&(r._queue.shift(),r._loadQueue()),e||n.action()}return r},_ended:function(e){var r=this,n=e._sprite;if(!r._webAudio&&e._node&&!e._node.paused&&!e._node.ended&&e._node.currentTime<e._stop)return setTimeout(r._ended.bind(r,e),100),r;var s=!!(e._loop||r._sprite[n][2]);if(r._emit("end",e._id),!r._webAudio&&s&&r.stop(e._id,!0).play(e._id),r._webAudio&&s){r._emit("play",e._id),e._seek=e._start||0,e._rateSeek=0,e._playStart=i.ctx.currentTime;var h=(e._stop-e._start)*1e3/Math.abs(e._rate);r._endTimers[e._id]=setTimeout(r._ended.bind(r,e),h)}return r._webAudio&&!s&&(e._paused=!0,e._ended=!0,e._seek=e._start||0,e._rateSeek=0,r._clearTimer(e._id),r._cleanBuffer(e._node),i._autoSuspend()),!r._webAudio&&!s&&r.stop(e._id,!0),r},_clearTimer:function(e){var r=this;if(r._endTimers[e]){if(typeof r._endTimers[e]!="function")clearTimeout(r._endTimers[e]);else{var n=r._soundById(e);n&&n._node&&n._node.removeEventListener("ended",r._endTimers[e],!1)}delete r._endTimers[e]}return r},_soundById:function(e){for(var r=this,n=0;n<r._sounds.length;n++)if(e===r._sounds[n]._id)return r._sounds[n];return null},_inactiveSound:function(){var e=this;e._drain();for(var r=0;r<e._sounds.length;r++)if(e._sounds[r]._ended)return e._sounds[r].reset();return new p(e)},_drain:function(){var e=this,r=e._pool,n=0,s=0;if(!(e._sounds.length<r)){for(s=0;s<e._sounds.length;s++)e._sounds[s]._ended&&n++;for(s=e._sounds.length-1;s>=0;s--){if(n<=r)return;e._sounds[s]._ended&&(e._webAudio&&e._sounds[s]._node&&e._sounds[s]._node.disconnect(0),e._sounds.splice(s,1),n--)}}},_getSoundIds:function(e){var r=this;if(typeof e>"u"){for(var n=[],s=0;s<r._sounds.length;s++)n.push(r._sounds[s]._id);return n}else return[e]},_refreshBuffer:function(e){var r=this;return e._node.bufferSource=i.ctx.createBufferSource(),e._node.bufferSource.buffer=O[r._src],e._panner?e._node.bufferSource.connect(e._panner):e._node.bufferSource.connect(e._node),e._node.bufferSource.loop=e._loop,e._loop&&(e._node.bufferSource.loopStart=e._start||0,e._node.bufferSource.loopEnd=e._stop||0),e._node.bufferSource.playbackRate.setValueAtTime(e._rate,i.ctx.currentTime),r},_cleanBuffer:function(e){var r=this,n=i._navigator&&i._navigator.vendor.indexOf("Apple")>=0;if(i._scratchBuffer&&e.bufferSource&&(e.bufferSource.onended=null,e.bufferSource.disconnect(0),n))try{e.bufferSource.buffer=i._scratchBuffer}catch{}return e.bufferSource=null,r},_clearSound:function(e){var r=/MSIE |Trident\//.test(i._navigator&&i._navigator.userAgent);r||(e.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var p=function(e){this._parent=e,this.init()};p.prototype={init:function(){var e=this,r=e._parent;return e._muted=r._muted,e._loop=r._loop,e._volume=r._volume,e._rate=r._rate,e._seek=0,e._paused=!0,e._ended=!0,e._sprite="__default",e._id=++i._counter,r._sounds.push(e),e.create(),e},create:function(){var e=this,r=e._parent,n=i._muted||e._muted||e._parent._muted?0:e._volume;return r._webAudio?(e._node=typeof i.ctx.createGain>"u"?i.ctx.createGainNode():i.ctx.createGain(),e._node.gain.setValueAtTime(n,i.ctx.currentTime),e._node.paused=!0,e._node.connect(i.masterGain)):i.noAudio||(e._node=i._obtainHtml5Audio(),e._errorFn=e._errorListener.bind(e),e._node.addEventListener("error",e._errorFn,!1),e._loadFn=e._loadListener.bind(e),e._node.addEventListener(i._canPlayEvent,e._loadFn,!1),e._endFn=e._endListener.bind(e),e._node.addEventListener("ended",e._endFn,!1),e._node.src=r._src,e._node.preload=r._preload===!0?"auto":r._preload,e._node.volume=n*i.volume(),e._node.load()),e},reset:function(){var e=this,r=e._parent;return e._muted=r._muted,e._loop=r._loop,e._volume=r._volume,e._rate=r._rate,e._seek=0,e._rateSeek=0,e._paused=!0,e._ended=!0,e._sprite="__default",e._id=++i._counter,e},_errorListener:function(){var e=this;e._parent._emit("loaderror",e._id,e._node.error?e._node.error.code:0),e._node.removeEventListener("error",e._errorFn,!1)},_loadListener:function(){var e=this,r=e._parent;r._duration=Math.ceil(e._node.duration*10)/10,Object.keys(r._sprite).length===0&&(r._sprite={__default:[0,r._duration*1e3]}),r._state!=="loaded"&&(r._state="loaded",r._emit("load"),r._loadQueue()),e._node.removeEventListener(i._canPlayEvent,e._loadFn,!1)},_endListener:function(){var e=this,r=e._parent;r._duration===1/0&&(r._duration=Math.ceil(e._node.duration*10)/10,r._sprite.__default[1]===1/0&&(r._sprite.__default[1]=r._duration*1e3),r._ended(e)),e._node.removeEventListener("ended",e._endFn,!1)}};var O={},D=function(e){var r=e._src;if(O[r]){e._duration=O[r].duration,k(e);return}if(/^data:[^;]+;base64,/.test(r)){for(var n=atob(r.split(",")[1]),s=new Uint8Array(n.length),h=0;h<n.length;++h)s[h]=n.charCodeAt(h);F(s.buffer,e)}else{var g=new XMLHttpRequest;g.open(e._xhr.method,r,!0),g.withCredentials=e._xhr.withCredentials,g.responseType="arraybuffer",e._xhr.headers&&Object.keys(e._xhr.headers).forEach(function(l){g.setRequestHeader(l,e._xhr.headers[l])}),g.onload=function(){var l=(g.status+"")[0];if(l!=="0"&&l!=="2"&&l!=="3"){e._emit("loaderror",null,"Failed loading audio file with status: "+g.status+".");return}F(g.response,e)},g.onerror=function(){e._webAudio&&(e._html5=!0,e._webAudio=!1,e._sounds=[],delete O[r],e.load())},Y(g)}},Y=function(e){try{e.send()}catch{e.onerror()}},F=function(e,r){var n=function(){r._emit("loaderror",null,"Decoding audio data failed.")},s=function(h){h&&r._sounds.length>0?(O[r._src]=h,k(r,h)):n()};typeof Promise<"u"&&i.ctx.decodeAudioData.length===1?i.ctx.decodeAudioData(e).then(s).catch(n):i.ctx.decodeAudioData(e,s,n)},k=function(e,r){r&&!e._duration&&(e._duration=r.duration),Object.keys(e._sprite).length===0&&(e._sprite={__default:[0,e._duration*1e3]}),e._state!=="loaded"&&(e._state="loaded",e._emit("load"),e._loadQueue())},G=function(){if(!!i.usingWebAudio){try{typeof AudioContext<"u"?i.ctx=new AudioContext:typeof webkitAudioContext<"u"?i.ctx=new webkitAudioContext:i.usingWebAudio=!1}catch{i.usingWebAudio=!1}i.ctx||(i.usingWebAudio=!1);var e=/iP(hone|od|ad)/.test(i._navigator&&i._navigator.platform),r=i._navigator&&i._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),n=r?parseInt(r[1],10):null;if(e&&n&&n<9){var s=/safari/.test(i._navigator&&i._navigator.userAgent.toLowerCase());i._navigator&&!s&&(i.usingWebAudio=!1)}i.usingWebAudio&&(i.masterGain=typeof i.ctx.createGain>"u"?i.ctx.createGainNode():i.ctx.createGain(),i.masterGain.gain.setValueAtTime(i._muted?0:i._volume,i.ctx.currentTime),i.masterGain.connect(i.ctx.destination)),i._setup()}};Z.Howler=i,Z.Howl=_,typeof Q<"u"?(Q.HowlerGlobal=C,Q.Howler=i,Q.Howl=_,Q.Sound=p):typeof window<"u"&&(window.HowlerGlobal=C,window.Howler=i,window.Howl=_,window.Sound=p)})();/*!
 *  Spatial Plugin - Adds support for stereo and 3D audio where Web Audio is supported.
 *  
 *  howler.js v2.2.3
 *  howlerjs.com
 *
 *  (c) 2013-2020, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */(function(){HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(i){var _=this;if(!_.ctx||!_.ctx.listener)return _;for(var p=_._howls.length-1;p>=0;p--)_._howls[p].stereo(i);return _},HowlerGlobal.prototype.pos=function(i,_,p){var O=this;if(!O.ctx||!O.ctx.listener)return O;if(_=typeof _!="number"?O._pos[1]:_,p=typeof p!="number"?O._pos[2]:p,typeof i=="number")O._pos=[i,_,p],typeof O.ctx.listener.positionX<"u"?(O.ctx.listener.positionX.setTargetAtTime(O._pos[0],Howler.ctx.currentTime,.1),O.ctx.listener.positionY.setTargetAtTime(O._pos[1],Howler.ctx.currentTime,.1),O.ctx.listener.positionZ.setTargetAtTime(O._pos[2],Howler.ctx.currentTime,.1)):O.ctx.listener.setPosition(O._pos[0],O._pos[1],O._pos[2]);else return O._pos;return O},HowlerGlobal.prototype.orientation=function(i,_,p,O,D,Y){var F=this;if(!F.ctx||!F.ctx.listener)return F;var k=F._orientation;if(_=typeof _!="number"?k[1]:_,p=typeof p!="number"?k[2]:p,O=typeof O!="number"?k[3]:O,D=typeof D!="number"?k[4]:D,Y=typeof Y!="number"?k[5]:Y,typeof i=="number")F._orientation=[i,_,p,O,D,Y],typeof F.ctx.listener.forwardX<"u"?(F.ctx.listener.forwardX.setTargetAtTime(i,Howler.ctx.currentTime,.1),F.ctx.listener.forwardY.setTargetAtTime(_,Howler.ctx.currentTime,.1),F.ctx.listener.forwardZ.setTargetAtTime(p,Howler.ctx.currentTime,.1),F.ctx.listener.upX.setTargetAtTime(O,Howler.ctx.currentTime,.1),F.ctx.listener.upY.setTargetAtTime(D,Howler.ctx.currentTime,.1),F.ctx.listener.upZ.setTargetAtTime(Y,Howler.ctx.currentTime,.1)):F.ctx.listener.setOrientation(i,_,p,O,D,Y);else return k;return F},Howl.prototype.init=function(i){return function(_){var p=this;return p._orientation=_.orientation||[1,0,0],p._stereo=_.stereo||null,p._pos=_.pos||null,p._pannerAttr={coneInnerAngle:typeof _.coneInnerAngle<"u"?_.coneInnerAngle:360,coneOuterAngle:typeof _.coneOuterAngle<"u"?_.coneOuterAngle:360,coneOuterGain:typeof _.coneOuterGain<"u"?_.coneOuterGain:0,distanceModel:typeof _.distanceModel<"u"?_.distanceModel:"inverse",maxDistance:typeof _.maxDistance<"u"?_.maxDistance:1e4,panningModel:typeof _.panningModel<"u"?_.panningModel:"HRTF",refDistance:typeof _.refDistance<"u"?_.refDistance:1,rolloffFactor:typeof _.rolloffFactor<"u"?_.rolloffFactor:1},p._onstereo=_.onstereo?[{fn:_.onstereo}]:[],p._onpos=_.onpos?[{fn:_.onpos}]:[],p._onorientation=_.onorientation?[{fn:_.onorientation}]:[],i.call(this,_)}}(Howl.prototype.init),Howl.prototype.stereo=function(i,_){var p=this;if(!p._webAudio)return p;if(p._state!=="loaded")return p._queue.push({event:"stereo",action:function(){p.stereo(i,_)}}),p;var O=typeof Howler.ctx.createStereoPanner>"u"?"spatial":"stereo";if(typeof _>"u")if(typeof i=="number")p._stereo=i,p._pos=[i,0,0];else return p._stereo;for(var D=p._getSoundIds(_),Y=0;Y<D.length;Y++){var F=p._soundById(D[Y]);if(F)if(typeof i=="number")F._stereo=i,F._pos=[i,0,0],F._node&&(F._pannerAttr.panningModel="equalpower",(!F._panner||!F._panner.pan)&&C(F,O),O==="spatial"?typeof F._panner.positionX<"u"?(F._panner.positionX.setValueAtTime(i,Howler.ctx.currentTime),F._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),F._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):F._panner.setPosition(i,0,0):F._panner.pan.setValueAtTime(i,Howler.ctx.currentTime)),p._emit("stereo",F._id);else return F._stereo}return p},Howl.prototype.pos=function(i,_,p,O){var D=this;if(!D._webAudio)return D;if(D._state!=="loaded")return D._queue.push({event:"pos",action:function(){D.pos(i,_,p,O)}}),D;if(_=typeof _!="number"?0:_,p=typeof p!="number"?-.5:p,typeof O>"u")if(typeof i=="number")D._pos=[i,_,p];else return D._pos;for(var Y=D._getSoundIds(O),F=0;F<Y.length;F++){var k=D._soundById(Y[F]);if(k)if(typeof i=="number")k._pos=[i,_,p],k._node&&((!k._panner||k._panner.pan)&&C(k,"spatial"),typeof k._panner.positionX<"u"?(k._panner.positionX.setValueAtTime(i,Howler.ctx.currentTime),k._panner.positionY.setValueAtTime(_,Howler.ctx.currentTime),k._panner.positionZ.setValueAtTime(p,Howler.ctx.currentTime)):k._panner.setPosition(i,_,p)),D._emit("pos",k._id);else return k._pos}return D},Howl.prototype.orientation=function(i,_,p,O){var D=this;if(!D._webAudio)return D;if(D._state!=="loaded")return D._queue.push({event:"orientation",action:function(){D.orientation(i,_,p,O)}}),D;if(_=typeof _!="number"?D._orientation[1]:_,p=typeof p!="number"?D._orientation[2]:p,typeof O>"u")if(typeof i=="number")D._orientation=[i,_,p];else return D._orientation;for(var Y=D._getSoundIds(O),F=0;F<Y.length;F++){var k=D._soundById(Y[F]);if(k)if(typeof i=="number")k._orientation=[i,_,p],k._node&&(k._panner||(k._pos||(k._pos=D._pos||[0,0,-.5]),C(k,"spatial")),typeof k._panner.orientationX<"u"?(k._panner.orientationX.setValueAtTime(i,Howler.ctx.currentTime),k._panner.orientationY.setValueAtTime(_,Howler.ctx.currentTime),k._panner.orientationZ.setValueAtTime(p,Howler.ctx.currentTime)):k._panner.setOrientation(i,_,p)),D._emit("orientation",k._id);else return k._orientation}return D},Howl.prototype.pannerAttr=function(){var i=this,_=arguments,p,O,D;if(!i._webAudio)return i;if(_.length===0)return i._pannerAttr;if(_.length===1)if(typeof _[0]=="object")p=_[0],typeof O>"u"&&(p.pannerAttr||(p.pannerAttr={coneInnerAngle:p.coneInnerAngle,coneOuterAngle:p.coneOuterAngle,coneOuterGain:p.coneOuterGain,distanceModel:p.distanceModel,maxDistance:p.maxDistance,refDistance:p.refDistance,rolloffFactor:p.rolloffFactor,panningModel:p.panningModel}),i._pannerAttr={coneInnerAngle:typeof p.pannerAttr.coneInnerAngle<"u"?p.pannerAttr.coneInnerAngle:i._coneInnerAngle,coneOuterAngle:typeof p.pannerAttr.coneOuterAngle<"u"?p.pannerAttr.coneOuterAngle:i._coneOuterAngle,coneOuterGain:typeof p.pannerAttr.coneOuterGain<"u"?p.pannerAttr.coneOuterGain:i._coneOuterGain,distanceModel:typeof p.pannerAttr.distanceModel<"u"?p.pannerAttr.distanceModel:i._distanceModel,maxDistance:typeof p.pannerAttr.maxDistance<"u"?p.pannerAttr.maxDistance:i._maxDistance,refDistance:typeof p.pannerAttr.refDistance<"u"?p.pannerAttr.refDistance:i._refDistance,rolloffFactor:typeof p.pannerAttr.rolloffFactor<"u"?p.pannerAttr.rolloffFactor:i._rolloffFactor,panningModel:typeof p.pannerAttr.panningModel<"u"?p.pannerAttr.panningModel:i._panningModel});else return D=i._soundById(parseInt(_[0],10)),D?D._pannerAttr:i._pannerAttr;else _.length===2&&(p=_[0],O=parseInt(_[1],10));for(var Y=i._getSoundIds(O),F=0;F<Y.length;F++)if(D=i._soundById(Y[F]),D){var k=D._pannerAttr;k={coneInnerAngle:typeof p.coneInnerAngle<"u"?p.coneInnerAngle:k.coneInnerAngle,coneOuterAngle:typeof p.coneOuterAngle<"u"?p.coneOuterAngle:k.coneOuterAngle,coneOuterGain:typeof p.coneOuterGain<"u"?p.coneOuterGain:k.coneOuterGain,distanceModel:typeof p.distanceModel<"u"?p.distanceModel:k.distanceModel,maxDistance:typeof p.maxDistance<"u"?p.maxDistance:k.maxDistance,refDistance:typeof p.refDistance<"u"?p.refDistance:k.refDistance,rolloffFactor:typeof p.rolloffFactor<"u"?p.rolloffFactor:k.rolloffFactor,panningModel:typeof p.panningModel<"u"?p.panningModel:k.panningModel};var G=D._panner;G?(G.coneInnerAngle=k.coneInnerAngle,G.coneOuterAngle=k.coneOuterAngle,G.coneOuterGain=k.coneOuterGain,G.distanceModel=k.distanceModel,G.maxDistance=k.maxDistance,G.refDistance=k.refDistance,G.rolloffFactor=k.rolloffFactor,G.panningModel=k.panningModel):(D._pos||(D._pos=i._pos||[0,0,-.5]),C(D,"spatial"))}return i},Sound.prototype.init=function(i){return function(){var _=this,p=_._parent;_._orientation=p._orientation,_._stereo=p._stereo,_._pos=p._pos,_._pannerAttr=p._pannerAttr,i.call(this),_._stereo?p.stereo(_._stereo):_._pos&&p.pos(_._pos[0],_._pos[1],_._pos[2],_._id)}}(Sound.prototype.init),Sound.prototype.reset=function(i){return function(){var _=this,p=_._parent;return _._orientation=p._orientation,_._stereo=p._stereo,_._pos=p._pos,_._pannerAttr=p._pannerAttr,_._stereo?p.stereo(_._stereo):_._pos?p.pos(_._pos[0],_._pos[1],_._pos[2],_._id):_._panner&&(_._panner.disconnect(0),_._panner=void 0,p._refreshBuffer(_)),i.call(this)}}(Sound.prototype.reset);var C=function(i,_){_=_||"spatial",_==="spatial"?(i._panner=Howler.ctx.createPanner(),i._panner.coneInnerAngle=i._pannerAttr.coneInnerAngle,i._panner.coneOuterAngle=i._pannerAttr.coneOuterAngle,i._panner.coneOuterGain=i._pannerAttr.coneOuterGain,i._panner.distanceModel=i._pannerAttr.distanceModel,i._panner.maxDistance=i._pannerAttr.maxDistance,i._panner.refDistance=i._pannerAttr.refDistance,i._panner.rolloffFactor=i._pannerAttr.rolloffFactor,i._panner.panningModel=i._pannerAttr.panningModel,typeof i._panner.positionX<"u"?(i._panner.positionX.setValueAtTime(i._pos[0],Howler.ctx.currentTime),i._panner.positionY.setValueAtTime(i._pos[1],Howler.ctx.currentTime),i._panner.positionZ.setValueAtTime(i._pos[2],Howler.ctx.currentTime)):i._panner.setPosition(i._pos[0],i._pos[1],i._pos[2]),typeof i._panner.orientationX<"u"?(i._panner.orientationX.setValueAtTime(i._orientation[0],Howler.ctx.currentTime),i._panner.orientationY.setValueAtTime(i._orientation[1],Howler.ctx.currentTime),i._panner.orientationZ.setValueAtTime(i._orientation[2],Howler.ctx.currentTime)):i._panner.setOrientation(i._orientation[0],i._orientation[1],i._orientation[2])):(i._panner=Howler.ctx.createStereoPanner(),i._panner.pan.setValueAtTime(i._stereo,Howler.ctx.currentTime)),i._panner.connect(i._node),i._paused||i._parent.pause(i._id,!0).play(i._id,!0)}})()})(at);const xt=(Z,C)=>{const i=document.createElement("a");return i.style.display="none",i.setAttribute("href",Z),i.setAttribute("download",C),document.body.appendChild(i),setTimeout(function(){i.click(),document.body.removeChild(i)},66),!0},Ct="/mobile/assets/camera_fill.e869dfbd.svg",Lt="/mobile/assets/photo_fill.f7d7b398.svg",Mt="/mobile/assets/video_dial_fill.2e920b0f.svg",Dt="/mobile/assets/yuyin_fill.fd28a397.svg",Bt=[{key:"photo",text:"\u7167\u7247",icon:Lt},{key:"camera",text:"\u62CD\u6444",icon:Ct},{key:"friend_call",text:"\u8BED\u97F3",icon:Dt},{key:"video_call",text:"\u89C6\u9891",icon:Mt},{key:"file",text:"\u6587\u4EF6",icon:it}],It={class:"container"},Ft={class:"content",id:"msg_content"},Ot=["id"],Pt={class:"avatar"},Ut=["src"],Et={class:"time"},Ht=["onClick"],Gt=["src"],Vt=["src"],Nt={class:"footer"},jt={class:"form"},Wt={key:0,class:"card"},qt={key:0},zt={class:"gird-box"},Xt=["src"],$t={class:"grid-text"},Yt={key:1},Qt={class:"gird-box"},Zt=["src"],Kt={class:"grid-text"},Jt=["onClick"],er={class:"gird-box"},tr=["src"],rr={class:"grid-text"},nr=pt({__name:"index",setup(Z){var J,Ae;const C=mt(),i=ht(),_=_t(),p=St(),O=De(""),D=De(!1),Y=De([]),F=()=>D.value=!D.value,k=C.query.rid,G=Number(C.query.is_group||0),e=C.query.nickname,r=C.query.avatar,n=De(!1),s=De(!1);De(!0);const h=De(null),g={cmd:G?et.group_chat:et.private_chat,rid:Number(k),is_group:Boolean(G),to_nickname:e,to_avatar:r,from_nickname:(J=_.userInfo)==null?void 0:J.nickname,from_avatar:(Ae=_.userInfo)==null?void 0:Ae.avatar},l=()=>{i.send({...g,content:O.value||"Hello",type:Ue.text})},B=j=>{var z;return j===((z=_.userInfo)==null?void 0:z.id)},q=(j,z)=>{var ee;if(B(j))return(ee=_.userInfo)==null?void 0:ee.avatar;const $=Y.value.find(a=>a.id===j);return $?$.avatar:""},H=(j,z)=>{var ee;if(B(j))return(ee=_.userInfo)==null?void 0:ee.nickname;const $=Y.value.find(a=>a.id===j);return $?$.nickname:""},ie=vt(()=>i.list.filter(z=>{const $=z.suid===Number(k),ee=z.rid===Number(k);return($||ee)&&Number(z.is_group)===G}).map(z=>({...z,is_me:B(z.suid),avatar:q(z.suid),nickname:H(z.suid)}))),_e=async()=>{if(s.value)return;const z=document.querySelectorAll(".msg-item")[0].getAttribute("id");s.value=!0,i.list.filter($=>{const ee=$.suid===Number(k),a=$.rid===Number(k);return(ee||a)&&Number($.is_group)===G});try{await bt(500),await i.queryHistory({rid:k,seq:ie.value.length?ie.value[0].time:0,is_group:Boolean(G)}),s.value=!1,setTimeout(()=>{const $=document.querySelector(`#${z}`);i.scrollTo($.offsetTop)},100)}catch($){s.value=!1,n.value=$.message}},fe=()=>{G?kt({id:k}).then(j=>{Y.value=j.data.list}):p.queryProfile([Number(k)]).then(j=>{Y.value=j}),i.markHasRead({pid:Number(k)})};gt(()=>{fe()}),yt(()=>{var j;(j=h.value)==null||j.addEventListener("scroll",z=>{z.target.scrollTop===0&&_e()})});const le=j=>wt(j).format("hh:mm:ss"),N=j=>{console.log("afterRead",j.file);const z=new FormData;z.append("file",j.file),Ze(z).then($=>{$.data&&i.send({...g,content:$.data.url,type:Ue.image,title:j.file.name})})},be=j=>{console.log("afterReadFile",j.file);const z=new FormData;z.append("file",j.file),Ze(z).then($=>{$.data&&i.send({...g,content:$.data.url,title:j.file.name,type:Ue.file})})},we=async j=>{if(j.key==="video_call"){G||i.setDialUser({id:+k,nickname:e,avatar:r});return}if(j.key==="yuyin_call"){let z=await navigator.mediaDevices.getUserMedia({video:!0,audio:!0}),$=new ot.exports.RecordRTCPromisesHandler(z,{type:"audio"});$.startRecording();const ee=o=>new Promise(m=>setTimeout(m,o));At("\u5F55\u52363S"),await ee(3e3),await $.stopRecording();let a=await $.getBlob();const t=new FormData;t.append("file",a),Ze(t).then(o=>{o.data&&i.send({...g,content:o.data.url,type:Ue.audio})})}},Se=j=>{var z=new at.Howl({src:[j]});console.log(z),z.play()},ke=(j,z)=>{xt(j,z)};return(j,z)=>{const $=Fe("VanLoading"),ee=Fe("van-icon"),a=Fe("van-loading"),t=Fe("van-field"),o=Fe("van-button"),m=Fe("van-uploader");return de(),Ve(Tt,{title:je(e)},{default:Ne(()=>[K("div",It,[K("div",{class:"list",id:"msg_list",ref_key:"scrollRef",ref:h},[K("div",Ft,[s.value?(de(),Ve($,{key:0,class:"list-loading",size:"small"})):Be("",!0),(de(!0),he(Ye,null,tt(je(ie),d=>(de(),he("div",{class:Qe(["item msg-item",{"is-me":d.is_me}]),id:"msg-item-"+d.time},[K("div",Pt,[K("img",{src:d.avatar,alt:""},null,8,Ut)]),K("div",{class:Qe(["main",{"is-me":d.is_me}])},[K("span",Et,Oe(le(d.create_time)),1),K("div",{class:Qe(["content","msg-content-type-"+d.type])},[d.type===0?(de(),he(Ye,{key:0},[rt(Oe(d.content),1)],64)):Be("",!0),d.type===3?(de(),he("div",{key:1,onClick:v=>ke(d.content,d.title)},[K("span",null,Oe(d.title||"\u6587\u4EF6"),1),K("img",{class:"msg-icon",src:je(it),alt:""},null,8,Gt)],8,Ht)):Be("",!0),d.type===1?(de(),he("img",{key:2,style:{"max-width":"80%"},src:d.content,alt:""},null,8,Vt)):Be("",!0),d.type===2?(de(),Ve(ee,{key:3,onClick:v=>Se(d.content),size:20,name:"volume-o"},null,8,["onClick"])):Be("",!0),d.loading?(de(),Ve(a,{key:4,class:"loading",size:"20px",type:"spinner"})):Be("",!0)],2)],2)],10,Ot))),256))])],512),K("div",Nt,[K("div",jt,[Pe(t,{class:"input",modelValue:O.value,"onUpdate:modelValue":z[0]||(z[0]=d=>O.value=d),name:"content",placeholder:"\u8F93\u5165",clearable:"",rules:[{required:!0,message:"\u8BF7\u8F93\u5165"}]},null,8,["modelValue"]),Pe(o,{class:"btn",size:"small",onClick:l},{default:Ne(()=>[rt(" \u53D1\u9001 ")]),_:1}),Pe(ee,{class:"icon-plus",name:"add-o",onClick:F})]),D.value?(de(),he("div",Wt,[(de(!0),he(Ye,null,tt(je(Bt),d=>(de(),he("div",{class:"grid-item",key:d.key},[d.key==="photo"?(de(),he("div",qt,[Pe(m,{"after-read":N},{default:Ne(()=>[K("div",zt,[K("img",{class:"grid-icon",src:d.icon,alt:""},null,8,Xt),K("span",$t,Oe(d.text),1)])]),_:2},1024)])):d.key==="file"?(de(),he("div",Yt,[Pe(m,{"after-read":be,accept:"image/*,.pdj,.zip,.doc,.docx,.xml,.pptx"},{default:Ne(()=>[K("div",Qt,[K("img",{class:"grid-icon",src:d.icon,alt:""},null,8,Zt),K("span",Kt,Oe(d.text),1)])]),_:2},1024)])):(de(),he("div",{key:2,onClick:v=>we(d)},[K("div",er,[K("img",{class:"grid-icon",src:d.icon,alt:""},null,8,tr),K("span",rr,Oe(d.text),1)])],8,Jt))]))),128))])):Be("",!0)])])]),_:1},8,["title"])}}});const sr=Rt(nr,[["__scopeId","data-v-2d063921"]]);export{sr as default};
