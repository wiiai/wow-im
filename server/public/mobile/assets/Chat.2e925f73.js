import{ao as it,ar as Q,d as pt,as as mt,a as ht,aq as _t,j as Me,at as et,c as vt,R as gt,au as yt,b as Ve,w as Ne,f as $e,o as de,g as K,h as De,e as ge,r as tt,F as Ye,G as Pe,al as rt,ak as Ie,an as Qe,t as Fe,av as bt,i as wt,aw as At,_ as Rt}from"./index.c4a1de2c.js";import{P as Tt}from"./Page.2acd4064.js";import{u as St}from"./friend.7122f93b.js";const kt="/mobile/assets/camera_fill.e869dfbd.svg",xt="/mobile/assets/photo_fill.f7d7b398.svg",Ct="/mobile/assets/video_dial_fill.2e920b0f.svg",nt="/mobile/assets/file_fill.fa998c17.svg",Lt="/mobile/assets/yuyin_fill.fd28a397.svg",Mt=Z=>it({url:"/group/get_user_list_by_id",method:"POST",data:Z}),Ze=Z=>it({url:"/upload/file",method:"POST",data:Z});var Ue=(Z=>(Z[Z.text=0]="text",Z[Z.image=1]="image",Z[Z.audio=2]="audio",Z[Z.file=3]="file",Z))(Ue||{}),ot={exports:{}};(function(Z){/**
 * {@link https://github.com/muaz-khan/RecordRTC|RecordRTC} is a WebRTC JavaScript library for audio/video as well as screen activity recording. It supports Chrome, Firefox, Opera, Android, and Microsoft Edge. Platforms: Linux, Mac and Windows. 
 * @summary Record audio, video or screen inside the browser.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef RecordRTC
 * @class
 * @example
 * var recorder = RecordRTC(mediaStream or [arrayOfMediaStream], {
 *     type: 'video', // audio or video or gif or canvas
 *     recorderType: MediaStreamRecorder || CanvasRecorder || StereoAudioRecorder || Etc
 * });
 * recorder.startRecording();
 * @see For further information:
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - Single media-stream object, array of media-streams, html-canvas-element, etc.
 * @param {object} config - {type:"video", recorderType: MediaStreamRecorder, disableLogs: true, numberOfAudioChannels: 1, bufferSize: 0, sampleRate: 0, desiredSampRate: 16000, video: HTMLVideoElement, etc.}
 */function C(o,t){if(!o)throw"First parameter is required.";t=t||{type:"video"},t=new i(o,t);var a=this;function p(c){return t.disableLogs||console.log("RecordRTC version: ",a.version),c&&(t=new i(o,c)),t.disableLogs||console.log("started recording "+t.type+" stream."),w?(w.clearRecordedData(),w.record(),L("recording"),a.recordingDuration&&A(),a):(_(function(){a.recordingDuration&&A()}),a)}function _(c){c&&(t.initCallback=function(){c(),c=t.initCallback=null});var S=new v(o,t);w=new S(o,t),w.record(),L("recording"),t.disableLogs||console.log("Initialized recorderType:",w.constructor.name,"for output-type:",t.type)}function d(c){if(c=c||function(){},!w){x();return}if(a.state==="paused"){a.resumeRecording(),setTimeout(function(){d(c)},1);return}a.state!=="recording"&&!t.disableLogs&&console.warn('Recording state should be: "recording", however current state is: ',a.state),t.disableLogs||console.log("Stopped recording "+t.type+" stream."),t.type!=="gif"?w.stop(S):(w.stop(),S()),L("stopped");function S(E){if(!w){typeof c.call=="function"?c.call(a,""):c("");return}Object.keys(w).forEach(function(I){typeof w[I]!="function"&&(a[I]=w[I])});var l=w.blob;if(!l)if(E)w.blob=l=E;else throw"Recording failed.";if(l&&!t.disableLogs&&console.log(l.type,"->",f(l.size)),c){var y;try{y=G.createObjectURL(l)}catch{}typeof c.call=="function"?c.call(a,y):c(y)}!t.autoWriteToDisk||M(function(I){var P={};P[t.type+"Blob"]=I,J.Store(P)})}}function b(){if(!w){x();return}if(a.state!=="recording"){t.disableLogs||console.warn("Unable to pause the recording. Recording state: ",a.state);return}L("paused"),w.pause(),t.disableLogs||console.log("Paused recording.")}function u(){if(!w){x();return}if(a.state!=="paused"){t.disableLogs||console.warn("Unable to resume the recording. Recording state: ",a.state);return}L("recording"),w.resume(),t.disableLogs||console.log("Resumed recording.")}function R(c){postMessage(new FileReaderSync().readAsDataURL(c))}function M(c,S){if(!c)throw"Pass a callback function over getDataURL.";var E=S?S.blob:(w||{}).blob;if(!E){t.disableLogs||console.warn("Blob encoder did not finish its job yet."),setTimeout(function(){M(c,S)},1e3);return}if(typeof Worker<"u"&&!navigator.mozGetUserMedia){var l=I(R);l.onmessage=function(P){c(P.data)},l.postMessage(E)}else{var y=new FileReader;y.readAsDataURL(E),y.onload=function(P){c(P.target.result)}}function I(P){try{var $=G.createObjectURL(new Blob([P.toString(),"this.onmessage =  function (eee) {"+P.name+"(eee.data);}"],{type:"application/javascript"})),q=new Worker($);return G.revokeObjectURL($),q}catch{}}}function A(c){if(c=c||0,a.state==="paused"){setTimeout(function(){A(c)},1e3);return}if(a.state!=="stopped"){if(c>=a.recordingDuration){d(a.onRecordingStopped);return}c+=1e3,setTimeout(function(){A(c)},1e3)}}function L(c){!a||(a.state=c,typeof a.onStateChanged.call=="function"?a.onStateChanged.call(a,c):a.onStateChanged(c))}var T='It seems that recorder is destroyed or "startRecording" is not invoked for '+t.type+" recorder.";function x(){t.disableLogs!==!0&&console.warn(T)}var w,U={startRecording:p,stopRecording:d,pauseRecording:b,resumeRecording:u,initRecorder:_,setRecordingDuration:function(c,S){if(typeof c>"u")throw"recordingDuration is required.";if(typeof c!="number")throw"recordingDuration must be a number.";return a.recordingDuration=c,a.onRecordingStopped=S||function(){},{onRecordingStopped:function(E){a.onRecordingStopped=E}}},clearRecordedData:function(){if(!w){x();return}w.clearRecordedData(),t.disableLogs||console.log("Cleared old recorded data.")},getBlob:function(){if(!w){x();return}return w.blob},getDataURL:M,toURL:function(){if(!w){x();return}return G.createObjectURL(w.blob)},getInternalRecorder:function(){return w},save:function(c){if(!w){x();return}B(w.blob,c)},getFromDisk:function(c){if(!w){x();return}C.getFromDisk(t.type,c)},setAdvertisementArray:function(c){t.advertisement=[];for(var S=c.length,E=0;E<S;E++)t.advertisement.push({duration:E,image:c[E]})},blob:null,bufferSize:0,sampleRate:0,buffer:null,reset:function(){a.state==="recording"&&!t.disableLogs&&console.warn("Stop an active recorder."),w&&typeof w.clearRecordedData=="function"&&w.clearRecordedData(),w=null,L("inactive"),a.blob=null},onStateChanged:function(c){t.disableLogs||console.log("Recorder state changed:",c)},state:"inactive",getState:function(){return a.state},destroy:function(){var c=t.disableLogs;t={disableLogs:!0},a.reset(),L("destroyed"),U=a=null,ue.AudioContextConstructor&&(ue.AudioContextConstructor.close(),ue.AudioContextConstructor=null),t.disableLogs=c,t.disableLogs||console.log("RecordRTC is destroyed.")},version:"5.6.2"};if(!this)return a=U,U;for(var V in U)this[V]=U[V];return a=this,U}C.version="5.6.2",Z.exports=C,C.getFromDisk=function(o,t){if(!t)throw"callback is mandatory.";console.log("Getting recorded "+(o==="all"?"blobs":o+" blob ")+" from disk!"),J.Fetch(function(a,p){o!=="all"&&p===o+"Blob"&&t&&t(a),o==="all"&&t&&t(a,p.replace("Blob",""))})},C.writeToDisk=function(o){console.log("Writing recorded blob(s) to disk!"),o=o||{},o.audio&&o.video&&o.gif?o.audio.getDataURL(function(t){o.video.getDataURL(function(a){o.gif.getDataURL(function(p){J.Store({audioBlob:t,videoBlob:a,gifBlob:p})})})}):o.audio&&o.video?o.audio.getDataURL(function(t){o.video.getDataURL(function(a){J.Store({audioBlob:t,videoBlob:a})})}):o.audio&&o.gif?o.audio.getDataURL(function(t){o.gif.getDataURL(function(a){J.Store({audioBlob:t,gifBlob:a})})}):o.video&&o.gif?o.video.getDataURL(function(t){o.gif.getDataURL(function(a){J.Store({videoBlob:t,gifBlob:a})})}):o.audio?o.audio.getDataURL(function(t){J.Store({audioBlob:t})}):o.video?o.video.getDataURL(function(t){J.Store({videoBlob:t})}):o.gif&&o.gif.getDataURL(function(t){J.Store({gifBlob:t})})};/**
 * {@link RecordRTCConfiguration} is an inner/private helper for {@link RecordRTC}.
 * @summary It configures the 2nd parameter passed over {@link RecordRTC} and returns a valid "config" object.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef RecordRTCConfiguration
 * @class
 * @example
 * var options = RecordRTCConfiguration(mediaStream, options);
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @param {object} config - {type:"video", disableLogs: true, numberOfAudioChannels: 1, bufferSize: 0, sampleRate: 0, video: HTMLVideoElement, getNativeBlob:true, etc.}
 */function i(o,t){return!t.recorderType&&!t.type&&(!!t.audio&&!!t.video?t.type="video":!!t.audio&&!t.video&&(t.type="audio")),t.recorderType&&!t.type&&(t.recorderType===Te||t.recorderType===be||typeof X<"u"&&t.recorderType===X?t.type="video":t.recorderType===we?t.type="gif":t.recorderType===ye?t.type="audio":t.recorderType===N&&(H(o,"audio").length&&H(o,"video").length||!H(o,"audio").length&&H(o,"video").length?t.type="video":H(o,"audio").length&&!H(o,"video").length&&(t.type="audio"))),typeof N<"u"&&typeof MediaRecorder<"u"&&"requestData"in MediaRecorder.prototype&&(t.mimeType||(t.mimeType="video/webm"),t.type||(t.type=t.mimeType.split("/")[0]),t.bitsPerSecond),t.type||(t.mimeType&&(t.type=t.mimeType.split("/")[0]),t.type||(t.type="audio")),t}/**
 * {@link GetRecorderType} is an inner/private helper for {@link RecordRTC}.
 * @summary It returns best recorder-type available for your browser.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef GetRecorderType
 * @class
 * @example
 * var RecorderType = GetRecorderType(options);
 * var recorder = new RecorderType(options);
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @param {object} config - {type:"video", disableLogs: true, numberOfAudioChannels: 1, bufferSize: 0, sampleRate: 0, video: HTMLVideoElement, etc.}
 */function v(o,t){var a;return(s||e||r)&&(a=ye),typeof MediaRecorder<"u"&&"requestData"in MediaRecorder.prototype&&!s&&(a=N),t.type==="video"&&(s||r)&&(a=Te,typeof X<"u"&&typeof ReadableStream<"u"&&(a=X)),t.type==="gif"&&(a=we),t.type==="canvas"&&(a=be),fe()&&a!==be&&a!==we&&typeof MediaRecorder<"u"&&"requestData"in MediaRecorder.prototype&&(H(o,"video").length||H(o,"audio").length)&&(t.type==="audio"?typeof MediaRecorder.isTypeSupported=="function"&&MediaRecorder.isTypeSupported("audio/webm")&&(a=N):typeof MediaRecorder.isTypeSupported=="function"&&MediaRecorder.isTypeSupported("video/webm")&&(a=N)),o instanceof Array&&o.length&&(a=W),t.recorderType&&(a=t.recorderType),!t.disableLogs&&!!a&&!!a.name&&console.log("Using recorderType:",a.name||a.constructor.name),!a&&h&&(a=N),a}/**
 * MRecordRTC runs on top of {@link RecordRTC} to bring multiple recordings in a single place, by providing simple API.
 * @summary MRecordRTC stands for "Multiple-RecordRTC".
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef MRecordRTC
 * @class
 * @example
 * var recorder = new MRecordRTC();
 * recorder.addStream(MediaStream);
 * recorder.mediaType = {
 *     audio: true, // or StereoAudioRecorder or MediaStreamRecorder
 *     video: true, // or WhammyRecorder or MediaStreamRecorder or WebAssemblyRecorder or CanvasRecorder
 *     gif: true    // or GifRecorder
 * };
 * // mimeType is optional and should be set only in advance cases.
 * recorder.mimeType = {
 *     audio: 'audio/wav',
 *     video: 'video/webm',
 *     gif:   'image/gif'
 * };
 * recorder.startRecording();
 * @see For further information:
 * @see {@link https://github.com/muaz-khan/RecordRTC/tree/master/MRecordRTC|MRecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @requires {@link RecordRTC}
 */function m(o){this.addStream=function(t){t&&(o=t)},this.mediaType={audio:!0,video:!0},this.startRecording=function(){var t=this.mediaType,a,p=this.mimeType||{audio:null,video:null,gif:null};if(typeof t.audio!="function"&&fe()&&!H(o,"audio").length&&(t.audio=!1),typeof t.video!="function"&&fe()&&!H(o,"video").length&&(t.video=!1),typeof t.gif!="function"&&fe()&&!H(o,"video").length&&(t.gif=!1),!t.audio&&!t.video&&!t.gif)throw"MediaStream must have either audio or video tracks.";if(t.audio&&(a=null,typeof t.audio=="function"&&(a=t.audio),this.audioRecorder=new C(o,{type:"audio",bufferSize:this.bufferSize,sampleRate:this.sampleRate,numberOfAudioChannels:this.numberOfAudioChannels||2,disableLogs:this.disableLogs,recorderType:a,mimeType:p.audio,timeSlice:this.timeSlice,onTimeStamp:this.onTimeStamp}),t.video||this.audioRecorder.startRecording()),t.video){a=null,typeof t.video=="function"&&(a=t.video);var _=o;if(fe()&&!!t.audio&&typeof t.audio=="function"){var d=H(o,"video")[0];n?(_=new g,_.addTrack(d),a&&a===Te&&(a=N)):(_=new g,_.addTrack(d))}this.videoRecorder=new C(_,{type:"video",video:this.video,canvas:this.canvas,frameInterval:this.frameInterval||10,disableLogs:this.disableLogs,recorderType:a,mimeType:p.video,timeSlice:this.timeSlice,onTimeStamp:this.onTimeStamp,workerPath:this.workerPath,webAssemblyPath:this.webAssemblyPath,frameRate:this.frameRate,bitrate:this.bitrate}),t.audio||this.videoRecorder.startRecording()}if(!!t.audio&&!!t.video){var b=this,u=fe()===!0;(t.audio instanceof ye&&!!t.video||t.audio!==!0&&t.video!==!0&&t.audio!==t.video)&&(u=!1),u===!0?(b.audioRecorder=null,b.videoRecorder.startRecording()):b.videoRecorder.initRecorder(function(){b.audioRecorder.initRecorder(function(){b.videoRecorder.startRecording(),b.audioRecorder.startRecording()})})}t.gif&&(a=null,typeof t.gif=="function"&&(a=t.gif),this.gifRecorder=new C(o,{type:"gif",frameRate:this.frameRate||200,quality:this.quality||10,disableLogs:this.disableLogs,recorderType:a,mimeType:p.gif}),this.gifRecorder.startRecording())},this.stopRecording=function(t){t=t||function(){},this.audioRecorder&&this.audioRecorder.stopRecording(function(a){t(a,"audio")}),this.videoRecorder&&this.videoRecorder.stopRecording(function(a){t(a,"video")}),this.gifRecorder&&this.gifRecorder.stopRecording(function(a){t(a,"gif")})},this.pauseRecording=function(){this.audioRecorder&&this.audioRecorder.pauseRecording(),this.videoRecorder&&this.videoRecorder.pauseRecording(),this.gifRecorder&&this.gifRecorder.pauseRecording()},this.resumeRecording=function(){this.audioRecorder&&this.audioRecorder.resumeRecording(),this.videoRecorder&&this.videoRecorder.resumeRecording(),this.gifRecorder&&this.gifRecorder.resumeRecording()},this.getBlob=function(t){var a={};return this.audioRecorder&&(a.audio=this.audioRecorder.getBlob()),this.videoRecorder&&(a.video=this.videoRecorder.getBlob()),this.gifRecorder&&(a.gif=this.gifRecorder.getBlob()),t&&t(a),a},this.destroy=function(){this.audioRecorder&&(this.audioRecorder.destroy(),this.audioRecorder=null),this.videoRecorder&&(this.videoRecorder.destroy(),this.videoRecorder=null),this.gifRecorder&&(this.gifRecorder.destroy(),this.gifRecorder=null)},this.getDataURL=function(t){this.getBlob(function(_){_.audio&&_.video?a(_.audio,function(d){a(_.video,function(b){t({audio:d,video:b})})}):_.audio?a(_.audio,function(d){t({audio:d})}):_.video&&a(_.video,function(d){t({video:d})})});function a(_,d){if(typeof Worker<"u"){var b=p(function(M){postMessage(new FileReaderSync().readAsDataURL(M))});b.onmessage=function(R){d(R.data)},b.postMessage(_)}else{var u=new FileReader;u.readAsDataURL(_),u.onload=function(R){d(R.target.result)}}}function p(_){var d=G.createObjectURL(new Blob([_.toString(),"this.onmessage =  function (eee) {"+_.name+"(eee.data);}"],{type:"application/javascript"})),b=new Worker(d),u;if(typeof G<"u")u=G;else if(typeof webkitURL<"u")u=webkitURL;else throw"Neither URL nor webkitURL detected.";return u.revokeObjectURL(d),b}},this.writeToDisk=function(){C.writeToDisk({audio:this.audioRecorder,video:this.videoRecorder,gif:this.gifRecorder})},this.save=function(t){t=t||{audio:!0,video:!0,gif:!0},!!t.audio&&this.audioRecorder&&this.audioRecorder.save(typeof t.audio=="string"?t.audio:""),!!t.video&&this.videoRecorder&&this.videoRecorder.save(typeof t.video=="string"?t.video:""),!!t.gif&&this.gifRecorder&&this.gifRecorder.save(typeof t.gif=="string"?t.gif:"")}}m.getFromDisk=C.getFromDisk,m.writeToDisk=C.writeToDisk,typeof C<"u"&&(C.MRecordRTC=m);var O="Fake/5.0 (FakeOS) AppleWebKit/123 (KHTML, like Gecko) Fake/12.3.4567.89 Fake/123.45";(function(o){!o||typeof window<"u"||typeof Q>"u"||(Q.navigator={userAgent:O,getUserMedia:function(){}},Q.console||(Q.console={}),(typeof Q.console.log>"u"||typeof Q.console.error>"u")&&(Q.console.error=Q.console.log=Q.console.log||function(){console.log(arguments)}),typeof document>"u"&&(o.document={documentElement:{appendChild:function(){return""}}},document.createElement=document.captureStream=document.mozCaptureStream=function(){var t={getContext:function(){return t},play:function(){},pause:function(){},drawImage:function(){},toDataURL:function(){return""},style:{}};return t},o.HTMLVideoElement=function(){}),typeof location>"u"&&(o.location={protocol:"file:",href:"",hash:""}),typeof screen>"u"&&(o.screen={width:0,height:0}),typeof G>"u"&&(o.URL={createObjectURL:function(){return""},revokeObjectURL:function(){return""}}),o.window=Q)})(typeof Q<"u"?Q:null);var D=window.requestAnimationFrame;if(typeof D>"u"){if(typeof webkitRequestAnimationFrame<"u")D=webkitRequestAnimationFrame;else if(typeof mozRequestAnimationFrame<"u")D=mozRequestAnimationFrame;else if(typeof msRequestAnimationFrame<"u")D=msRequestAnimationFrame;else if(typeof D>"u"){var Y=0;D=function(o,t){var a=new Date().getTime(),p=Math.max(0,16-(a-Y)),_=setTimeout(function(){o(a+p)},p);return Y=a+p,_}}}var F=window.cancelAnimationFrame;typeof F>"u"&&(typeof webkitCancelAnimationFrame<"u"?F=webkitCancelAnimationFrame:typeof mozCancelAnimationFrame<"u"?F=mozCancelAnimationFrame:typeof msCancelAnimationFrame<"u"?F=msCancelAnimationFrame:typeof F>"u"&&(F=function(o){clearTimeout(o)}));var k=window.AudioContext;typeof k>"u"&&(typeof webkitAudioContext<"u"&&(k=webkitAudioContext),typeof mozAudioContext<"u"&&(k=mozAudioContext));var G=window.URL;typeof G>"u"&&typeof webkitURL<"u"&&(G=webkitURL),typeof navigator<"u"&&typeof navigator.getUserMedia>"u"&&(typeof navigator.webkitGetUserMedia<"u"&&(navigator.getUserMedia=navigator.webkitGetUserMedia),typeof navigator.mozGetUserMedia<"u"&&(navigator.getUserMedia=navigator.mozGetUserMedia));var e=navigator.userAgent.indexOf("Edge")!==-1&&(!!navigator.msSaveBlob||!!navigator.msSaveOrOpenBlob),r=!!window.opera||navigator.userAgent.indexOf("OPR/")!==-1,n=navigator.userAgent.toLowerCase().indexOf("firefox")>-1&&"netscape"in window&&/ rv:/.test(navigator.userAgent),s=!r&&!e&&!!navigator.webkitGetUserMedia||j()||navigator.userAgent.toLowerCase().indexOf("chrome/")!==-1,h=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);h&&!s&&navigator.userAgent.indexOf("CriOS")!==-1&&(h=!1,s=!0);var g=window.MediaStream;typeof g>"u"&&typeof webkitMediaStream<"u"&&(g=webkitMediaStream),typeof g<"u"&&typeof g.prototype.stop>"u"&&(g.prototype.stop=function(){this.getTracks().forEach(function(o){o.stop()})});function f(o){var t=1e3,a=["Bytes","KB","MB","GB","TB"];if(o===0)return"0 Bytes";var p=parseInt(Math.floor(Math.log(o)/Math.log(t)),10);return(o/Math.pow(t,p)).toPrecision(3)+" "+a[p]}function B(o,t){if(!o)throw"Blob object is required.";if(!o.type)try{o.type="video/webm"}catch{}var a=(o.type||"video/webm").split("/")[1];if(a.indexOf(";")!==-1&&(a=a.split(";")[0]),t&&t.indexOf(".")!==-1){var p=t.split(".");t=p[0],a=p[1]}var _=(t||Math.round(Math.random()*9999999999)+888888888)+"."+a;if(typeof navigator.msSaveOrOpenBlob<"u")return navigator.msSaveOrOpenBlob(o,_);if(typeof navigator.msSaveBlob<"u")return navigator.msSaveBlob(o,_);var d=document.createElement("a");d.href=G.createObjectURL(o),d.download=_,d.style="display:none;opacity:0;color:transparent;",(document.body||document.documentElement).appendChild(d),typeof d.click=="function"?d.click():(d.target="_blank",d.dispatchEvent(new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0}))),G.revokeObjectURL(d.href)}function j(){return typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&!!process.versions.electron||typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent.indexOf("Electron")>=0}function H(o,t){return!o||!o.getTracks?[]:o.getTracks().filter(function(a){return a.kind===(t||"audio")})}function ae(o,t){"srcObject"in t?t.srcObject=o:"mozSrcObject"in t?t.mozSrcObject=o:t.srcObject=o}function ce(o,t){if(typeof EBML>"u")throw new Error("Please link: https://www.webrtc-experiment.com/EBML.js");var a=new EBML.Reader,p=new EBML.Decoder,_=EBML.tools,d=new FileReader;d.onload=function(b){var u=p.decode(this.result);u.forEach(function(L){a.read(L)}),a.stop();var R=_.makeMetadataSeekable(a.metadatas,a.duration,a.cues),M=this.result.slice(a.metadataSize),A=new Blob([R,M],{type:"video/webm"});t(A)},d.readAsArrayBuffer(o)}typeof C<"u"&&(C.invokeSaveAsDialog=B,C.getTracks=H,C.getSeekableBlob=ce,C.bytesToSize=f,C.isElectron=j);/**
 * Storage is a standalone object used by {@link RecordRTC} to store reusable objects e.g. "new AudioContext".
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @example
 * Storage.AudioContext === webkitAudioContext
 * @property {webkitAudioContext} AudioContext - Keeps a reference to AudioContext object.
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 */var ue={};typeof k<"u"?ue.AudioContext=k:typeof webkitAudioContext<"u"&&(ue.AudioContext=webkitAudioContext),typeof C<"u"&&(C.Storage=ue);function fe(){if(n||h||e)return!0;var o=navigator.userAgent,t=""+parseFloat(navigator.appVersion),a=parseInt(navigator.appVersion,10),p,_;return(s||r)&&(p=o.indexOf("Chrome"),t=o.substring(p+7)),(_=t.indexOf(";"))!==-1&&(t=t.substring(0,_)),(_=t.indexOf(" "))!==-1&&(t=t.substring(0,_)),a=parseInt(""+t,10),isNaN(a)&&(t=""+parseFloat(navigator.appVersion),a=parseInt(navigator.appVersion,10)),a>=49}/**
 * MediaStreamRecorder is an abstraction layer for {@link https://w3c.github.io/mediacapture-record/MediaRecorder.html|MediaRecorder API}. It is used by {@link RecordRTC} to record MediaStream(s) in both Chrome and Firefox.
 * @summary Runs top over {@link https://w3c.github.io/mediacapture-record/MediaRecorder.html|MediaRecorder API}.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://github.com/muaz-khan|Muaz Khan}
 * @typedef MediaStreamRecorder
 * @class
 * @example
 * var config = {
 *     mimeType: 'video/webm', // vp8, vp9, h264, mkv, opus/vorbis
 *     audioBitsPerSecond : 256 * 8 * 1024,
 *     videoBitsPerSecond : 256 * 8 * 1024,
 *     bitsPerSecond: 256 * 8 * 1024,  // if this is provided, skip above two
 *     checkForInactiveTracks: true,
 *     timeSlice: 1000, // concatenate intervals based blobs
 *     ondataavailable: function() {} // get intervals based blobs
 * }
 * var recorder = new MediaStreamRecorder(mediaStream, config);
 * recorder.record();
 * recorder.stop(function(blob) {
 *     video.src = URL.createObjectURL(blob);
 *
 *     // or
 *     var blob = recorder.blob;
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @param {object} config - {disableLogs:true, initCallback: function, mimeType: "video/webm", timeSlice: 1000}
 * @throws Will throw an error if first argument "MediaStream" is missing. Also throws error if "MediaRecorder API" are not supported by the browser.
 */function N(o,t){var A=this;if(typeof o>"u")throw'First argument "MediaStream" is required.';if(typeof MediaRecorder>"u")throw"Your browser does not support the Media Recorder API. Please try other modules e.g. WhammyRecorder or StereoAudioRecorder.";if(t=t||{mimeType:"video/webm"},t.type==="audio"){if(H(o,"video").length&&H(o,"audio").length){var a;navigator.mozGetUserMedia?(a=new g,a.addTrack(H(o,"audio")[0])):a=new g(H(o,"audio")),o=a}(!t.mimeType||t.mimeType.toString().toLowerCase().indexOf("audio")===-1)&&(t.mimeType=s?"audio/webm":"audio/ogg"),t.mimeType&&t.mimeType.toString().toLowerCase()!=="audio/ogg"&&!!navigator.mozGetUserMedia&&(t.mimeType="audio/ogg")}var p=[];this.getArrayOfBlobs=function(){return p},this.record=function(){A.blob=null,A.clearRecordedData(),A.timestamps=[],M=[],p=[];var L=t;t.disableLogs||console.log("Passing following config over MediaRecorder API.",L),u&&(u=null),s&&!fe()&&(L="video/vp8"),typeof MediaRecorder.isTypeSupported=="function"&&L.mimeType&&(MediaRecorder.isTypeSupported(L.mimeType)||(t.disableLogs||console.warn("MediaRecorder API seems unable to record mimeType:",L.mimeType),L.mimeType=t.type==="audio"?"audio/webm":"video/webm"));try{u=new MediaRecorder(o,L),t.mimeType=L.mimeType}catch{u=new MediaRecorder(o)}L.mimeType&&!MediaRecorder.isTypeSupported&&"canRecordMimeType"in u&&u.canRecordMimeType(L.mimeType)===!1&&(t.disableLogs||console.warn("MediaRecorder API seems unable to record mimeType:",L.mimeType)),u.ondataavailable=function(T){if(T.data&&M.push("ondataavailable: "+f(T.data.size)),typeof t.timeSlice=="number"){if(T.data&&T.data.size&&(p.push(T.data),_(),typeof t.ondataavailable=="function")){var x=t.getNativeBlob?T.data:new Blob([T.data],{type:d(L)});t.ondataavailable(x)}return}if(!T.data||!T.data.size||T.data.size<100||A.blob){A.recordingCallback&&(A.recordingCallback(new Blob([],{type:d(L)})),A.recordingCallback=null);return}A.blob=t.getNativeBlob?T.data:new Blob([T.data],{type:d(L)}),A.recordingCallback&&(A.recordingCallback(A.blob),A.recordingCallback=null)},u.onstart=function(){M.push("started")},u.onpause=function(){M.push("paused")},u.onresume=function(){M.push("resumed")},u.onstop=function(){M.push("stopped")},u.onerror=function(T){!T||(T.name||(T.name="UnknownError"),M.push("error: "+T),t.disableLogs||(T.name.toString().toLowerCase().indexOf("invalidstate")!==-1?console.error("The MediaRecorder is not in a state in which the proposed operation is allowed to be executed.",T):T.name.toString().toLowerCase().indexOf("notsupported")!==-1?console.error("MIME type (",L.mimeType,") is not supported.",T):T.name.toString().toLowerCase().indexOf("security")!==-1?console.error("MediaRecorder security error",T):T.name==="OutOfMemory"?console.error("The UA has exhaused the available memory. User agents SHOULD provide as much additional information as possible in the message attribute.",T):T.name==="IllegalStreamModification"?console.error("A modification to the stream has occurred that makes it impossible to continue recording. An example would be the addition of a Track while recording is occurring. User agents SHOULD provide as much additional information as possible in the message attribute.",T):T.name==="OtherRecordingError"?console.error("Used for an fatal error other than those listed above. User agents SHOULD provide as much additional information as possible in the message attribute.",T):T.name==="GenericError"?console.error("The UA cannot provide the codec or recording option that has been requested.",T):console.error("MediaRecorder Error",T)),function(x){if(!A.manuallyStopped&&u&&u.state==="inactive"){delete t.timeslice,u.start(10*60*1e3);return}setTimeout(x,1e3)}(),u.state!=="inactive"&&u.state!=="stopped"&&u.stop())},typeof t.timeSlice=="number"?(_(),u.start(t.timeSlice)):u.start(36e5),t.initCallback&&t.initCallback()},this.timestamps=[];function _(){A.timestamps.push(new Date().getTime()),typeof t.onTimeStamp=="function"&&t.onTimeStamp(A.timestamps[A.timestamps.length-1],A.timestamps)}function d(L){return u&&u.mimeType?u.mimeType:L.mimeType||"video/webm"}this.stop=function(L){L=L||function(){},A.manuallyStopped=!0,u&&(this.recordingCallback=L,u.state==="recording"&&u.stop(),typeof t.timeSlice=="number"&&setTimeout(function(){A.blob=new Blob(p,{type:d(t)}),A.recordingCallback(A.blob)},100))},this.pause=function(){!u||u.state==="recording"&&u.pause()},this.resume=function(){!u||u.state==="paused"&&u.resume()},this.clearRecordedData=function(){u&&u.state==="recording"&&A.stop(b),b()};function b(){p=[],u=null,A.timestamps=[]}var u;this.getInternalRecorder=function(){return u};function R(){if("active"in o){if(!o.active)return!1}else if("ended"in o&&o.ended)return!1;return!0}this.blob=null,this.getState=function(){return u&&u.state||"inactive"};var M=[];this.getAllStates=function(){return M},typeof t.checkForInactiveTracks>"u"&&(t.checkForInactiveTracks=!1);var A=this;(function L(){if(!(!u||t.checkForInactiveTracks===!1)){if(R()===!1){t.disableLogs||console.log("MediaStream seems stopped."),A.stop();return}setTimeout(L,1e3)}})(),this.name="MediaStreamRecorder",this.toString=function(){return this.name}}typeof C<"u"&&(C.MediaStreamRecorder=N);/**
 * StereoAudioRecorder is a standalone class used by {@link RecordRTC} to bring "stereo" audio-recording in chrome.
 * @summary JavaScript standalone object for stereo audio recording.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef StereoAudioRecorder
 * @class
 * @example
 * var recorder = new StereoAudioRecorder(MediaStream, {
 *     sampleRate: 44100,
 *     bufferSize: 4096
 * });
 * recorder.record();
 * recorder.stop(function(blob) {
 *     video.src = URL.createObjectURL(blob);
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @param {object} config - {sampleRate: 44100, bufferSize: 4096, numberOfAudioChannels: 1, etc.}
 */function ye(o,t){if(!H(o,"audio").length)throw"Your stream has no audio tracks.";t=t||{};var a=this,p=[],_=[],d=!1,b=0,u,R=2,M=t.desiredSampRate;t.leftChannel===!0&&(R=1),t.numberOfAudioChannels===1&&(R=1),(!R||R<1)&&(R=2),t.disableLogs||console.log("StereoAudioRecorder is set to record number of channels: "+R),typeof t.checkForInactiveTracks>"u"&&(t.checkForInactiveTracks=!0);function A(){if(t.checkForInactiveTracks===!1)return!0;if("active"in o){if(!o.active)return!1}else if("ended"in o&&o.ended)return!1;return!0}this.record=function(){if(A()===!1)throw"Please make sure MediaStream is active.";E(),y=S=!1,d=!0,typeof t.timeSlice<"u"&&$()};function L(q,ie){function ee(te,Be){var he=te.numberOfAudioChannels,se=te.leftBuffers.slice(0),xe=te.rightBuffers.slice(0),_e=te.sampleRate,Ae=te.internalInterleavedLength,le=te.desiredSampRate;he===2&&(se=We(se,Ae),xe=We(xe,Ae),le&&(se=Ce(se,le,_e),xe=Ce(xe,le,_e))),he===1&&(se=We(se,Ae),le&&(se=Ce(se,le,_e))),le&&(_e=le);function Ce(re,ve,pe){var me=Math.round(re.length*(ve/pe)),oe=[],Re=Number((re.length-1)/(me-1));oe[0]=re[0];for(var Le=1;Le<me-1;Le++){var Xe=Le*Re,Je=Number(Math.floor(Xe)).toFixed(),lt=Number(Math.ceil(Xe)).toFixed(),ct=Xe-Je;oe[Le]=je(re[Je],re[lt],ct)}return oe[me-1]=re[re.length-1],oe}function je(re,ve,pe){return re+(ve-re)*pe}function We(re,ve){for(var pe=new Float64Array(ve),me=0,oe=re.length,Re=0;Re<oe;Re++){var Le=re[Re];pe.set(Le,me),me+=Le.length}return pe}function st(re,ve){for(var pe=re.length+ve.length,me=new Float64Array(pe),oe=0,Re=0;Re<pe;)me[Re++]=re[oe],me[Re++]=ve[oe],oe++;return me}function Ee(re,ve,pe){for(var me=pe.length,oe=0;oe<me;oe++)re.setUint8(ve+oe,pe.charCodeAt(oe))}var He;he===2&&(He=st(se,xe)),he===1&&(He=se);var Ge=He.length,dt=44+Ge*2,qe=new ArrayBuffer(dt),ne=new DataView(qe);Ee(ne,0,"RIFF"),ne.setUint32(4,36+Ge*2,!0),Ee(ne,8,"WAVE"),Ee(ne,12,"fmt "),ne.setUint32(16,16,!0),ne.setUint16(20,1,!0),ne.setUint16(22,he,!0),ne.setUint32(24,_e,!0),ne.setUint32(28,_e*he*2,!0),ne.setUint16(32,he*2,!0),ne.setUint16(34,16,!0),Ee(ne,36,"data"),ne.setUint32(40,Ge*2,!0);for(var ut=Ge,Ke=44,ft=1,ze=0;ze<ut;ze++)ne.setInt16(Ke,He[ze]*(32767*ft),!0),Ke+=2;if(Be)return Be({buffer:qe,view:ne});postMessage({buffer:qe,view:ne})}if(q.noWorker){ee(q,function(te){ie(te.buffer,te.view)});return}var ke=T(ee);ke.onmessage=function(te){ie(te.data.buffer,te.data.view),G.revokeObjectURL(ke.workerURL),ke.terminate()},ke.postMessage(q)}function T(q){var ie=G.createObjectURL(new Blob([q.toString(),";this.onmessage =  function (eee) {"+q.name+"(eee.data);}"],{type:"application/javascript"})),ee=new Worker(ie);return ee.workerURL=ie,ee}this.stop=function(q){q=q||function(){},d=!1,L({desiredSampRate:M,sampleRate:c,numberOfAudioChannels:R,internalInterleavedLength:b,leftBuffers:p,rightBuffers:R===1?[]:_,noWorker:t.noWorker},function(ie,ee){a.blob=new Blob([ee],{type:"audio/wav"}),a.buffer=new ArrayBuffer(ee.buffer.byteLength),a.view=ee,a.sampleRate=M||c,a.bufferSize=V,a.length=b,y=!1,q&&q(a.blob)})},typeof C.Storage>"u"&&(C.Storage={AudioContextConstructor:null,AudioContext:window.AudioContext||window.webkitAudioContext}),(!C.Storage.AudioContextConstructor||C.Storage.AudioContextConstructor.state==="closed")&&(C.Storage.AudioContextConstructor=new C.Storage.AudioContext);var x=C.Storage.AudioContextConstructor,w=x.createMediaStreamSource(o),U=[0,256,512,1024,2048,4096,8192,16384],V=typeof t.bufferSize>"u"?4096:t.bufferSize;if(U.indexOf(V)===-1&&(t.disableLogs||console.log("Legal values for buffer-size are "+JSON.stringify(U,null,"	"))),x.createJavaScriptNode)u=x.createJavaScriptNode(V,R,R);else if(x.createScriptProcessor)u=x.createScriptProcessor(V,R,R);else throw"WebAudio API has no support on this browser.";w.connect(u),t.bufferSize||(V=u.bufferSize);var c=typeof t.sampleRate<"u"?t.sampleRate:x.sampleRate||44100;(c<22050||c>96e3)&&(t.disableLogs||console.log("sample-rate must be under range 22050 and 96000.")),t.disableLogs||t.desiredSampRate&&console.log("Desired sample-rate: "+t.desiredSampRate);var S=!1;this.pause=function(){S=!0},this.resume=function(){if(A()===!1)throw"Please make sure MediaStream is active.";if(!d){t.disableLogs||console.log("Seems recording has been restarted."),this.record();return}S=!1},this.clearRecordedData=function(){t.checkForInactiveTracks=!1,d&&this.stop(l),l()};function E(){p=[],_=[],b=0,y=!1,d=!1,S=!1,x=null,a.leftchannel=p,a.rightchannel=_,a.numberOfAudioChannels=R,a.desiredSampRate=M,a.sampleRate=c,a.recordingLength=b,P={left:[],right:[],recordingLength:0}}function l(){u&&(u.onaudioprocess=null,u.disconnect(),u=null),w&&(w.disconnect(),w=null),E()}this.name="StereoAudioRecorder",this.toString=function(){return this.name};var y=!1;function I(q){if(!S){if(A()===!1&&(t.disableLogs||console.log("MediaStream seems stopped."),u.disconnect(),d=!1),!d){w&&(w.disconnect(),w=null);return}y||(y=!0,t.onAudioProcessStarted&&t.onAudioProcessStarted(),t.initCallback&&t.initCallback());var ie=q.inputBuffer.getChannelData(0),ee=new Float32Array(ie);if(p.push(ee),R===2){var ke=q.inputBuffer.getChannelData(1),te=new Float32Array(ke);_.push(te)}b+=V,a.recordingLength=b,typeof t.timeSlice<"u"&&(P.recordingLength+=V,P.left.push(ee),R===2&&P.right.push(te))}}u.onaudioprocess=I,x.createMediaStreamDestination?u.connect(x.createMediaStreamDestination()):u.connect(x.destination),this.leftchannel=p,this.rightchannel=_,this.numberOfAudioChannels=R,this.desiredSampRate=M,this.sampleRate=c,a.recordingLength=b;var P={left:[],right:[],recordingLength:0};function $(){!d||typeof t.ondataavailable!="function"||typeof t.timeSlice>"u"||(P.left.length?(L({desiredSampRate:M,sampleRate:c,numberOfAudioChannels:R,internalInterleavedLength:P.recordingLength,leftBuffers:P.left,rightBuffers:R===1?[]:P.right},function(q,ie){var ee=new Blob([ie],{type:"audio/wav"});t.ondataavailable(ee),setTimeout($,t.timeSlice)}),P={left:[],right:[],recordingLength:0}):setTimeout($,t.timeSlice))}}typeof C<"u"&&(C.StereoAudioRecorder=ye);/**
 * CanvasRecorder is a standalone class used by {@link RecordRTC} to bring HTML5-Canvas recording into video WebM. It uses HTML2Canvas library and runs top over {@link Whammy}.
 * @summary HTML2Canvas recording into video WebM.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef CanvasRecorder
 * @class
 * @example
 * var recorder = new CanvasRecorder(htmlElement, { disableLogs: true, useWhammyRecorder: true });
 * recorder.record();
 * recorder.stop(function(blob) {
 *     video.src = URL.createObjectURL(blob);
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {HTMLElement} htmlElement - querySelector/getElementById/getElementsByTagName[0]/etc.
 * @param {object} config - {disableLogs:true, initCallback: function}
 */function be(o,t){if(typeof html2canvas>"u")throw"Please link: https://www.webrtc-experiment.com/screenshot.js";t=t||{},t.frameInterval||(t.frameInterval=10);var a=!1;["captureStream","mozCaptureStream","webkitCaptureStream"].forEach(function(U){U in document.createElement("canvas")&&(a=!0)});var p=(!!window.webkitRTCPeerConnection||!!window.webkitGetUserMedia)&&!!window.chrome,_=50,d=navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./);p&&d&&d[2]&&(_=parseInt(d[2],10)),p&&_<52&&(a=!1),t.useWhammyRecorder&&(a=!1);var b,u;if(a)if(t.disableLogs||console.log("Your browser supports both MediRecorder API and canvas.captureStream!"),o instanceof HTMLCanvasElement)b=o;else if(o instanceof CanvasRenderingContext2D)b=o.canvas;else throw"Please pass either HTMLCanvasElement or CanvasRenderingContext2D.";else navigator.mozGetUserMedia&&(t.disableLogs||console.error("Canvas recording is NOT supported in Firefox."));var R;this.record=function(){if(R=!0,a&&!t.useWhammyRecorder){var U;"captureStream"in b?U=b.captureStream(25):"mozCaptureStream"in b?U=b.mozCaptureStream(25):"webkitCaptureStream"in b&&(U=b.webkitCaptureStream(25));try{var V=new g;V.addTrack(H(U,"video")[0]),U=V}catch{}if(!U)throw"captureStream API are NOT available.";u=new N(U,{mimeType:t.mimeType||"video/webm"}),u.record()}else w.frames=[],x=new Date().getTime(),T();t.initCallback&&t.initCallback()},this.getWebPImages=function(U){if(o.nodeName.toLowerCase()!=="canvas"){U();return}var V=w.frames.length;w.frames.forEach(function(c,S){var E=V-S;t.disableLogs||console.log(E+"/"+V+" frames remaining"),t.onEncodingCallback&&t.onEncodingCallback(E,V);var l=c.image.toDataURL("image/webp",1);w.frames[S].image=l}),t.disableLogs||console.log("Generating WebM"),U()},this.stop=function(U){R=!1;var V=this;if(a&&u){u.stop(U);return}this.getWebPImages(function(){w.compile(function(c){t.disableLogs||console.log("Recording finished!"),V.blob=c,V.blob.forEach&&(V.blob=new Blob([],{type:"video/webm"})),U&&U(V.blob),w.frames=[]})})};var M=!1;this.pause=function(){if(M=!0,u instanceof N){u.pause();return}},this.resume=function(){if(M=!1,u instanceof N){u.resume();return}R||this.record()},this.clearRecordedData=function(){R&&this.stop(A),A()};function A(){w.frames=[],R=!1,M=!1}this.name="CanvasRecorder",this.toString=function(){return this.name};function L(){var U=document.createElement("canvas"),V=U.getContext("2d");return U.width=o.width,U.height=o.height,V.drawImage(o,0,0),U}function T(){if(M)return x=new Date().getTime(),setTimeout(T,500);if(o.nodeName.toLowerCase()==="canvas"){var U=new Date().getTime()-x;x=new Date().getTime(),w.frames.push({image:L(),duration:U}),R&&setTimeout(T,t.frameInterval);return}html2canvas(o,{grabMouse:typeof t.showMousePointer>"u"||t.showMousePointer,onrendered:function(V){var c=new Date().getTime()-x;if(!c)return setTimeout(T,t.frameInterval);x=new Date().getTime(),w.frames.push({image:V.toDataURL("image/webp",1),duration:c}),R&&setTimeout(T,t.frameInterval)}})}var x=new Date().getTime(),w=new Se.Video(100)}typeof C<"u"&&(C.CanvasRecorder=be);/**
 * WhammyRecorder is a standalone class used by {@link RecordRTC} to bring video recording in Chrome. It runs top over {@link Whammy}.
 * @summary Video recording feature in Chrome.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef WhammyRecorder
 * @class
 * @example
 * var recorder = new WhammyRecorder(mediaStream);
 * recorder.record();
 * recorder.stop(function(blob) {
 *     video.src = URL.createObjectURL(blob);
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @param {object} config - {disableLogs: true, initCallback: function, video: HTMLVideoElement, etc.}
 */function Te(o,t){t=t||{},t.frameInterval||(t.frameInterval=10),t.disableLogs||console.log("Using frames-interval:",t.frameInterval),this.record=function(){t.width||(t.width=320),t.height||(t.height=240),t.video||(t.video={width:t.width,height:t.height}),t.canvas||(t.canvas={width:t.width,height:t.height}),R.width=t.canvas.width||320,R.height=t.canvas.height||240,M=R.getContext("2d"),t.video&&t.video instanceof HTMLVideoElement?(A=t.video.cloneNode(),t.initCallback&&t.initCallback()):(A=document.createElement("video"),ae(o,A),A.onloadedmetadata=function(){t.initCallback&&t.initCallback()},A.width=t.video.width,A.height=t.video.height),A.muted=!0,A.play(),L=new Date().getTime(),T=new Se.Video,t.disableLogs||(console.log("canvas resolutions",R.width,"*",R.height),console.log("video width/height",A.width||R.width,"*",A.height||R.height)),a(t.frameInterval)};function a(x){x=typeof x<"u"?x:10;var w=new Date().getTime()-L;if(!w)return setTimeout(a,x,x);if(b)return L=new Date().getTime(),setTimeout(a,100);L=new Date().getTime(),A.paused&&A.play(),M.drawImage(A,0,0,R.width,R.height),T.frames.push({duration:w,image:R.toDataURL("image/webp")}),d||setTimeout(a,x,x)}function p(x){var w=-1,U=x.length;(function V(){if(w++,w===U){x.callback();return}setTimeout(function(){x.functionToLoop(V,w)},1)})()}function _(x,w,U,V,c){var S=document.createElement("canvas");S.width=R.width,S.height=R.height;var E=S.getContext("2d"),l=[],y=w===-1,I=w&&w>0&&w<=x.length?w:x.length,P={r:0,g:0,b:0},$=Math.sqrt(Math.pow(255,2)+Math.pow(255,2)+Math.pow(255,2)),q=U&&U>=0&&U<=1?U:0,ie=V&&V>=0&&V<=1?V:0,ee=!1;p({length:I,functionToLoop:function(ke,te){var Be,he,se,xe=function(){!ee&&se-Be<=se*ie||(y&&(ee=!0),l.push(x[te])),ke()};if(ee)xe();else{var _e=new Image;_e.onload=function(){E.drawImage(_e,0,0,R.width,R.height);var Ae=E.getImageData(0,0,R.width,R.height);Be=0,he=Ae.data.length,se=Ae.data.length/4;for(var le=0;le<he;le+=4){var Ce={r:Ae.data[le],g:Ae.data[le+1],b:Ae.data[le+2]},je=Math.sqrt(Math.pow(Ce.r-P.r,2)+Math.pow(Ce.g-P.g,2)+Math.pow(Ce.b-P.b,2));je<=$*q&&Be++}xe()},_e.src=x[te].image}},callback:function(){l=l.concat(x.slice(I)),l.length<=0&&l.push(x[x.length-1]),c(l)}})}var d=!1;this.stop=function(x){x=x||function(){},d=!0;var w=this;setTimeout(function(){_(T.frames,-1,null,null,function(U){T.frames=U,t.advertisement&&t.advertisement.length&&(T.frames=t.advertisement.concat(T.frames)),T.compile(function(V){w.blob=V,w.blob.forEach&&(w.blob=new Blob([],{type:"video/webm"})),x&&x(w.blob)})})},10)};var b=!1;this.pause=function(){b=!0},this.resume=function(){b=!1,d&&this.record()},this.clearRecordedData=function(){d||this.stop(u),u()};function u(){T.frames=[],d=!0,b=!1}this.name="WhammyRecorder",this.toString=function(){return this.name};var R=document.createElement("canvas"),M=R.getContext("2d"),A,L,T}typeof C<"u"&&(C.WhammyRecorder=Te);/**
 * Whammy is a standalone class used by {@link RecordRTC} to bring video recording in Chrome. It is written by {@link https://github.com/antimatter15|antimatter15}
 * @summary A real time javascript webm encoder based on a canvas hack.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef Whammy
 * @class
 * @example
 * var recorder = new Whammy().Video(15);
 * recorder.add(context || canvas || dataURL);
 * var output = recorder.compile();
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 */var Se=function(){function o(p){this.frames=[],this.duration=p||1,this.quality=.8}o.prototype.add=function(p,_){if("canvas"in p&&(p=p.canvas),"toDataURL"in p&&(p=p.toDataURL("image/webp",this.quality)),!/^data:image\/webp;base64,/ig.test(p))throw"Input must be formatted properly as a base64 encoded DataURI of type image/webp";this.frames.push({image:p,duration:_||this.duration})};function t(p){var _=G.createObjectURL(new Blob([p.toString(),"this.onmessage =  function (eee) {"+p.name+"(eee.data);}"],{type:"application/javascript"})),d=new Worker(_);return G.revokeObjectURL(_),d}function a(p){function _(c){var S=b(c);if(!S)return[];for(var E=3e4,l=[{id:440786851,data:[{data:1,id:17030},{data:1,id:17143},{data:4,id:17138},{data:8,id:17139},{data:"webm",id:17026},{data:2,id:17031},{data:2,id:17029}]},{id:408125543,data:[{id:357149030,data:[{data:1e6,id:2807729},{data:"whammy",id:19840},{data:"whammy",id:22337},{data:U(S.duration),id:17545}]},{id:374648427,data:[{id:174,data:[{data:1,id:215},{data:1,id:29637},{data:0,id:156},{data:"und",id:2274716},{data:"V_VP8",id:134},{data:"VP8",id:2459272},{data:1,id:131},{id:224,data:[{data:S.width,id:176},{data:S.height,id:186}]}]}]}]}],y=0,I=0;y<c.length;){var P=[],$=0;do P.push(c[y]),$+=c[y].duration,y++;while(y<c.length&&$<E);var q=0,ie={id:524531317,data:d(I,q,P)};l[1].data.push(ie),I+=$}return A(l)}function d(c,S,E){return[{data:c,id:231}].concat(E.map(function(l){var y=L({discardable:0,frame:l.data.slice(4),invisible:0,keyframe:1,lacing:0,trackNum:1,timecode:Math.round(S)});return S+=l.duration,{data:y,id:163}}))}function b(c){if(!c[0]){postMessage({error:"Something went wrong. Maybe WebP format is not supported in the current browser."});return}for(var S=c[0].width,E=c[0].height,l=c[0].duration,y=1;y<c.length;y++)l+=c[y].duration;return{duration:l,width:S,height:E}}function u(c){for(var S=[];c>0;)S.push(c&255),c=c>>8;return new Uint8Array(S.reverse())}function R(c){return new Uint8Array(c.split("").map(function(S){return S.charCodeAt(0)}))}function M(c){var S=[],E=c.length%8?new Array(9-c.length%8).join("0"):"";c=E+c;for(var l=0;l<c.length;l+=8)S.push(parseInt(c.substr(l,8),2));return new Uint8Array(S)}function A(c){for(var S=[],E=0;E<c.length;E++){var l=c[E].data;typeof l=="object"&&(l=A(l)),typeof l=="number"&&(l=M(l.toString(2))),typeof l=="string"&&(l=R(l));var y=l.size||l.byteLength||l.length,I=Math.ceil(Math.ceil(Math.log(y)/Math.log(2))/8),P=y.toString(2),$=new Array(I*7+7+1-P.length).join("0")+P,q=new Array(I).join("0")+"1"+$;S.push(u(c[E].id)),S.push(M(q)),S.push(l)}return new Blob(S,{type:"video/webm"})}function L(c){var S=0;if(c.keyframe&&(S|=128),c.invisible&&(S|=8),c.lacing&&(S|=c.lacing<<1),c.discardable&&(S|=1),c.trackNum>127)throw"TrackNumber > 127 not supported";var E=[c.trackNum|128,c.timecode>>8,c.timecode&255,S].map(function(l){return String.fromCharCode(l)}).join("")+c.frame;return E}function T(c){for(var S=c.RIFF[0].WEBP[0],E=S.indexOf("\x9D*"),l=0,y=[];l<4;l++)y[l]=S.charCodeAt(E+3+l);var I,P,$;return $=y[1]<<8|y[0],I=$&16383,$=y[3]<<8|y[2],P=$&16383,{width:I,height:P,data:S,riff:c}}function x(c,S){return parseInt(c.substr(S+4,4).split("").map(function(E){var l=E.charCodeAt(0).toString(2);return new Array(8-l.length+1).join("0")+l}).join(""),2)}function w(c){for(var S=0,E={};S<c.length;){var l=c.substr(S,4),y=x(c,S),I=c.substr(S+4+4,y);S+=4+4+y,E[l]=E[l]||[],l==="RIFF"||l==="LIST"?E[l].push(w(I)):E[l].push(I)}return E}function U(c){return[].slice.call(new Uint8Array(new Float64Array([c]).buffer),0).map(function(S){return String.fromCharCode(S)}).reverse().join("")}var V=new _(p.map(function(c){var S=T(w(atob(c.image.slice(23))));return S.duration=c.duration,S}));postMessage(V)}return o.prototype.compile=function(p){var _=t(a);_.onmessage=function(d){if(d.data.error){console.error(d.data.error);return}p(d.data)},_.postMessage(this.frames)},{Video:o}}();typeof C<"u"&&(C.Whammy=Se);/**
 * DiskStorage is a standalone object used by {@link RecordRTC} to store recorded blobs in IndexedDB storage.
 * @summary Writing blobs into IndexedDB.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @example
 * DiskStorage.Store({
 *     audioBlob: yourAudioBlob,
 *     videoBlob: yourVideoBlob,
 *     gifBlob  : yourGifBlob
 * });
 * DiskStorage.Fetch(function(dataURL, type) {
 *     if(type === 'audioBlob') { }
 *     if(type === 'videoBlob') { }
 *     if(type === 'gifBlob')   { }
 * });
 * // DiskStorage.dataStoreName = 'recordRTC';
 * // DiskStorage.onError = function(error) { };
 * @property {function} init - This method must be called once to initialize IndexedDB ObjectStore. Though, it is auto-used internally.
 * @property {function} Fetch - This method fetches stored blobs from IndexedDB.
 * @property {function} Store - This method stores blobs in IndexedDB.
 * @property {function} onError - This function is invoked for any known/unknown error.
 * @property {string} dataStoreName - Name of the ObjectStore created in IndexedDB storage.
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 */var J={init:function(){var o=this;if(typeof indexedDB>"u"||typeof indexedDB.open>"u"){console.error("IndexedDB API are not available in this browser.");return}var t=1,a=this.dbName||location.href.replace(/\/|:|#|%|\.|\[|\]/g,""),p,_=indexedDB.open(a,t);function d(u){u.createObjectStore(o.dataStoreName)}function b(){var u=p.transaction([o.dataStoreName],"readwrite");o.videoBlob&&u.objectStore(o.dataStoreName).put(o.videoBlob,"videoBlob"),o.gifBlob&&u.objectStore(o.dataStoreName).put(o.gifBlob,"gifBlob"),o.audioBlob&&u.objectStore(o.dataStoreName).put(o.audioBlob,"audioBlob");function R(M){u.objectStore(o.dataStoreName).get(M).onsuccess=function(A){o.callback&&o.callback(A.target.result,M)}}R("audioBlob"),R("videoBlob"),R("gifBlob")}_.onerror=o.onError,_.onsuccess=function(){if(p=_.result,p.onerror=o.onError,p.setVersion)if(p.version!==t){var u=p.setVersion(t);u.onsuccess=function(){d(p),b()}}else b();else b()},_.onupgradeneeded=function(u){d(u.target.result)}},Fetch:function(o){return this.callback=o,this.init(),this},Store:function(o){return this.audioBlob=o.audioBlob,this.videoBlob=o.videoBlob,this.gifBlob=o.gifBlob,this.init(),this},onError:function(o){console.error(JSON.stringify(o,null,"	"))},dataStoreName:"recordRTC",dbName:null};typeof C<"u"&&(C.DiskStorage=J);/**
 * GifRecorder is standalone calss used by {@link RecordRTC} to record video or canvas into animated gif.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef GifRecorder
 * @class
 * @example
 * var recorder = new GifRecorder(mediaStream || canvas || context, { onGifPreview: function, onGifRecordingStarted: function, width: 1280, height: 720, frameRate: 200, quality: 10 });
 * recorder.record();
 * recorder.stop(function(blob) {
 *     img.src = URL.createObjectURL(blob);
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object or HTMLCanvasElement or CanvasRenderingContext2D.
 * @param {object} config - {disableLogs:true, initCallback: function, width: 320, height: 240, frameRate: 200, quality: 10}
 */function we(o,t){if(typeof GIFEncoder>"u"){var a=document.createElement("script");a.src="https://www.webrtc-experiment.com/gif-recorder.js",(document.body||document.documentElement).appendChild(a)}t=t||{};var p=o instanceof CanvasRenderingContext2D||o instanceof HTMLCanvasElement;this.record=function(){if(typeof GIFEncoder>"u"){setTimeout(x.record,1e3);return}if(!R){setTimeout(x.record,1e3);return}p||(t.width||(t.width=M.offsetWidth||320),t.height||(t.height=M.offsetHeight||240),t.video||(t.video={width:t.width,height:t.height}),t.canvas||(t.canvas={width:t.width,height:t.height}),b.width=t.canvas.width||320,b.height=t.canvas.height||240,M.width=t.video.width||320,M.height=t.video.height||240),T=new GIFEncoder,T.setRepeat(0),T.setDelay(t.frameRate||200),T.setQuality(t.quality||10),T.start(),typeof t.onGifRecordingStarted=="function"&&t.onGifRecordingStarted();function w(U){if(x.clearedRecordedData!==!0){if(_)return setTimeout(function(){w(U)},100);A=D(w),typeof L===void 0&&(L=U),!(U-L<90)&&(!p&&M.paused&&M.play(),p||u.drawImage(M,0,0,b.width,b.height),t.onGifPreview&&t.onGifPreview(b.toDataURL("image/png")),T.addFrame(u),L=U)}}A=D(w),t.initCallback&&t.initCallback()},this.stop=function(w){w=w||function(){},A&&F(A),this.blob=new Blob([new Uint8Array(T.stream().bin)],{type:"image/gif"}),w(this.blob),T.stream().bin=[]};var _=!1;this.pause=function(){_=!0},this.resume=function(){_=!1},this.clearRecordedData=function(){x.clearedRecordedData=!0,d()};function d(){T&&(T.stream().bin=[])}this.name="GifRecorder",this.toString=function(){return this.name};var b=document.createElement("canvas"),u=b.getContext("2d");p&&(o instanceof CanvasRenderingContext2D?(u=o,b=u.canvas):o instanceof HTMLCanvasElement&&(u=o.getContext("2d"),b=o));var R=!0;if(!p){var M=document.createElement("video");M.muted=!0,M.autoplay=!0,M.playsInline=!0,R=!1,M.onloadedmetadata=function(){R=!0},ae(o,M),M.play()}var A=null,L,T,x=this}typeof C<"u"&&(C.GifRecorder=we);function Oe(o,t){var a="Fake/5.0 (FakeOS) AppleWebKit/123 (KHTML, like Gecko) Fake/12.3.4567.89 Fake/123.45";(function(l){typeof C<"u"||!l||typeof window<"u"||typeof Q>"u"||(Q.navigator={userAgent:a,getUserMedia:function(){}},Q.console||(Q.console={}),(typeof Q.console.log>"u"||typeof Q.console.error>"u")&&(Q.console.error=Q.console.log=Q.console.log||function(){console.log(arguments)}),typeof document>"u"&&(l.document={documentElement:{appendChild:function(){return""}}},document.createElement=document.captureStream=document.mozCaptureStream=function(){var y={getContext:function(){return y},play:function(){},pause:function(){},drawImage:function(){},toDataURL:function(){return""},style:{}};return y},l.HTMLVideoElement=function(){}),typeof location>"u"&&(l.location={protocol:"file:",href:"",hash:""}),typeof screen>"u"&&(l.screen={width:0,height:0}),typeof M>"u"&&(l.URL={createObjectURL:function(){return""},revokeObjectURL:function(){return""}}),l.window=Q)})(typeof Q<"u"?Q:null),t=t||"multi-streams-mixer";var p=[],_=!1,d=document.createElement("canvas"),b=d.getContext("2d");d.style.opacity=0,d.style.position="absolute",d.style.zIndex=-1,d.style.top="-1000em",d.style.left="-1000em",d.className=t,(document.body||document.documentElement).appendChild(d),this.disableLogs=!1,this.frameInterval=10,this.width=360,this.height=240,this.useGainNode=!0;var u=this,R=window.AudioContext;typeof R>"u"&&(typeof webkitAudioContext<"u"&&(R=webkitAudioContext),typeof mozAudioContext<"u"&&(R=mozAudioContext));var M=window.URL;typeof M>"u"&&typeof webkitURL<"u"&&(M=webkitURL),typeof navigator<"u"&&typeof navigator.getUserMedia>"u"&&(typeof navigator.webkitGetUserMedia<"u"&&(navigator.getUserMedia=navigator.webkitGetUserMedia),typeof navigator.mozGetUserMedia<"u"&&(navigator.getUserMedia=navigator.mozGetUserMedia));var A=window.MediaStream;typeof A>"u"&&typeof webkitMediaStream<"u"&&(A=webkitMediaStream),typeof A<"u"&&typeof A.prototype.stop>"u"&&(A.prototype.stop=function(){this.getTracks().forEach(function(l){l.stop()})});var L={};typeof R<"u"?L.AudioContext=R:typeof webkitAudioContext<"u"&&(L.AudioContext=webkitAudioContext);function T(l,y){"srcObject"in y?y.srcObject=l:"mozSrcObject"in y?y.mozSrcObject=l:y.srcObject=l}this.startDrawingFrames=function(){x()};function x(){if(!_){var l=p.length,y=!1,I=[];if(p.forEach(function($){$.stream||($.stream={}),$.stream.fullcanvas?y=$:I.push($)}),y)d.width=y.stream.width,d.height=y.stream.height;else if(I.length){d.width=l>1?I[0].width*2:I[0].width;var P=1;(l===3||l===4)&&(P=2),(l===5||l===6)&&(P=3),(l===7||l===8)&&(P=4),(l===9||l===10)&&(P=5),d.height=I[0].height*P}else d.width=u.width||360,d.height=u.height||240;y&&y instanceof HTMLVideoElement&&w(y),I.forEach(function($,q){w($,q)}),setTimeout(x,u.frameInterval)}}function w(l,y){if(!_){var I=0,P=0,$=l.width,q=l.height;y===1&&(I=l.width),y===2&&(P=l.height),y===3&&(I=l.width,P=l.height),y===4&&(P=l.height*2),y===5&&(I=l.width,P=l.height*2),y===6&&(P=l.height*3),y===7&&(I=l.width,P=l.height*3),typeof l.stream.left<"u"&&(I=l.stream.left),typeof l.stream.top<"u"&&(P=l.stream.top),typeof l.stream.width<"u"&&($=l.stream.width),typeof l.stream.height<"u"&&(q=l.stream.height),b.drawImage(l,I,P,$,q),typeof l.stream.onRender=="function"&&l.stream.onRender(b,I,P,$,q,y)}}function U(){_=!1;var l=V(),y=c();return y&&y.getTracks().filter(function(I){return I.kind==="audio"}).forEach(function(I){l.addTrack(I)}),o.forEach(function(I){I.fullcanvas}),l}function V(){E();var l;"captureStream"in d?l=d.captureStream():"mozCaptureStream"in d?l=d.mozCaptureStream():u.disableLogs||console.error("Upgrade to latest Chrome or otherwise enable this flag: chrome://flags/#enable-experimental-web-platform-features");var y=new A;return l.getTracks().filter(function(I){return I.kind==="video"}).forEach(function(I){y.addTrack(I)}),d.stream=y,y}function c(){L.AudioContextConstructor||(L.AudioContextConstructor=new L.AudioContext),u.audioContext=L.AudioContextConstructor,u.audioSources=[],u.useGainNode===!0&&(u.gainNode=u.audioContext.createGain(),u.gainNode.connect(u.audioContext.destination),u.gainNode.gain.value=0);var l=0;if(o.forEach(function(y){if(!!y.getTracks().filter(function(P){return P.kind==="audio"}).length){l++;var I=u.audioContext.createMediaStreamSource(y);u.useGainNode===!0&&I.connect(u.gainNode),u.audioSources.push(I)}}),!!l)return u.audioDestination=u.audioContext.createMediaStreamDestination(),u.audioSources.forEach(function(y){y.connect(u.audioDestination)}),u.audioDestination.stream}function S(l){var y=document.createElement("video");return T(l,y),y.className=t,y.muted=!0,y.volume=0,y.width=l.width||u.width||360,y.height=l.height||u.height||240,y.play(),y}this.appendStreams=function(l){if(!l)throw"First parameter is required.";l instanceof Array||(l=[l]),l.forEach(function(y){var I=new A;if(y.getTracks().filter(function(q){return q.kind==="video"}).length){var P=S(y);P.stream=y,p.push(P),I.addTrack(y.getTracks().filter(function(q){return q.kind==="video"})[0])}if(y.getTracks().filter(function(q){return q.kind==="audio"}).length){var $=u.audioContext.createMediaStreamSource(y);u.audioDestination=u.audioContext.createMediaStreamDestination(),$.connect(u.audioDestination),I.addTrack(u.audioDestination.stream.getTracks().filter(function(q){return q.kind==="audio"})[0])}o.push(I)})},this.releaseStreams=function(){p=[],_=!0,u.gainNode&&(u.gainNode.disconnect(),u.gainNode=null),u.audioSources.length&&(u.audioSources.forEach(function(l){l.disconnect()}),u.audioSources=[]),u.audioDestination&&(u.audioDestination.disconnect(),u.audioDestination=null),u.audioContext&&u.audioContext.close(),u.audioContext=null,b.clearRect(0,0,d.width,d.height),d.stream&&(d.stream.stop(),d.stream=null)},this.resetVideoStreams=function(l){l&&!(l instanceof Array)&&(l=[l]),E(l)};function E(l){p=[],l=l||o,l.forEach(function(y){if(!!y.getTracks().filter(function(P){return P.kind==="video"}).length){var I=S(y);I.stream=y,p.push(I)}})}this.name="MultiStreamsMixer",this.toString=function(){return this.name},this.getMixedStream=U}typeof C>"u"&&(Z.exports=Oe);/**
 * MultiStreamRecorder can record multiple videos in single container.
 * @summary Multi-videos recorder.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef MultiStreamRecorder
 * @class
 * @example
 * var options = {
 *     mimeType: 'video/webm'
 * }
 * var recorder = new MultiStreamRecorder(ArrayOfMediaStreams, options);
 * recorder.record();
 * recorder.stop(function(blob) {
 *     video.src = URL.createObjectURL(blob);
 *
 *     // or
 *     var blob = recorder.blob;
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStreams} mediaStreams - Array of MediaStreams.
 * @param {object} config - {disableLogs:true, frameInterval: 1, mimeType: "video/webm"}
 */function W(o,t){o=o||[];var a=this,p,_;t=t||{elementClass:"multi-streams-mixer",mimeType:"video/webm",video:{width:360,height:240}},t.frameInterval||(t.frameInterval=10),t.video||(t.video={}),t.video.width||(t.video.width=360),t.video.height||(t.video.height=240),this.record=function(){p=new Oe(o,t.elementClass||"multi-streams-mixer"),d().length&&(p.frameInterval=t.frameInterval||10,p.width=t.video.width||360,p.height=t.video.height||240,p.startDrawingFrames()),t.previewStream&&typeof t.previewStream=="function"&&t.previewStream(p.getMixedStream()),_=new N(p.getMixedStream(),t),_.record()};function d(){var b=[];return o.forEach(function(u){H(u,"video").forEach(function(R){b.push(R)})}),b}this.stop=function(b){!_||_.stop(function(u){a.blob=u,b(u),a.clearRecordedData()})},this.pause=function(){_&&_.pause()},this.resume=function(){_&&_.resume()},this.clearRecordedData=function(){_&&(_.clearRecordedData(),_=null),p&&(p.releaseStreams(),p=null)},this.addStreams=function(b){if(!b)throw"First parameter is required.";b instanceof Array||(b=[b]),o.concat(b),!(!_||!p)&&(p.appendStreams(b),t.previewStream&&typeof t.previewStream=="function"&&t.previewStream(p.getMixedStream()))},this.resetVideoStreams=function(b){!p||(b&&!(b instanceof Array)&&(b=[b]),p.resetVideoStreams(b))},this.getMixer=function(){return p},this.name="MultiStreamRecorder",this.toString=function(){return this.name}}typeof C<"u"&&(C.MultiStreamRecorder=W);/**
 * RecordRTCPromisesHandler adds promises support in {@link RecordRTC}. Try a {@link https://github.com/muaz-khan/RecordRTC/blob/master/simple-demos/RecordRTCPromisesHandler.html|demo here}
 * @summary Promises for {@link RecordRTC}
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef RecordRTCPromisesHandler
 * @class
 * @example
 * var recorder = new RecordRTCPromisesHandler(mediaStream, options);
 * recorder.startRecording()
 *         .then(successCB)
 *         .catch(errorCB);
 * // Note: You can access all RecordRTC API using "recorder.recordRTC" e.g. 
 * recorder.recordRTC.onStateChanged = function(state) {};
 * recorder.recordRTC.setRecordingDuration(5000);
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - Single media-stream object, array of media-streams, html-canvas-element, etc.
 * @param {object} config - {type:"video", recorderType: MediaStreamRecorder, disableLogs: true, numberOfAudioChannels: 1, bufferSize: 0, sampleRate: 0, video: HTMLVideoElement, etc.}
 * @throws Will throw an error if "new" keyword is not used to initiate "RecordRTCPromisesHandler". Also throws error if first argument "MediaStream" is missing.
 * @requires {@link RecordRTC}
 */function z(o,t){if(!this)throw'Use "new RecordRTCPromisesHandler()"';if(typeof o>"u")throw'First argument "MediaStream" is required.';var a=this;a.recordRTC=new C(o,t),this.startRecording=function(){return new Promise(function(p,_){try{a.recordRTC.startRecording(),p()}catch(d){_(d)}})},this.stopRecording=function(){return new Promise(function(p,_){try{a.recordRTC.stopRecording(function(d){if(a.blob=a.recordRTC.getBlob(),!a.blob||!a.blob.size){_("Empty blob.",a.blob);return}p(d)})}catch(d){_(d)}})},this.pauseRecording=function(){return new Promise(function(p,_){try{a.recordRTC.pauseRecording(),p()}catch(d){_(d)}})},this.resumeRecording=function(){return new Promise(function(p,_){try{a.recordRTC.resumeRecording(),p()}catch(d){_(d)}})},this.getDataURL=function(p){return new Promise(function(_,d){try{a.recordRTC.getDataURL(function(b){_(b)})}catch(b){d(b)}})},this.getBlob=function(){return new Promise(function(p,_){try{p(a.recordRTC.getBlob())}catch(d){_(d)}})},this.getInternalRecorder=function(){return new Promise(function(p,_){try{p(a.recordRTC.getInternalRecorder())}catch(d){_(d)}})},this.reset=function(){return new Promise(function(p,_){try{p(a.recordRTC.reset())}catch(d){_(d)}})},this.destroy=function(){return new Promise(function(p,_){try{p(a.recordRTC.destroy())}catch(d){_(d)}})},this.getState=function(){return new Promise(function(p,_){try{p(a.recordRTC.getState())}catch(d){_(d)}})},this.blob=null,this.version="5.6.2"}typeof C<"u"&&(C.RecordRTCPromisesHandler=z);/**
 * WebAssemblyRecorder lets you create webm videos in JavaScript via WebAssembly. The library consumes raw RGBA32 buffers (4 bytes per pixel) and turns them into a webm video with the given framerate and quality. This makes it compatible out-of-the-box with ImageData from a CANVAS. With realtime mode you can also use webm-wasm for streaming webm videos.
 * @summary Video recording feature in Chrome, Firefox and maybe Edge.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef WebAssemblyRecorder
 * @class
 * @example
 * var recorder = new WebAssemblyRecorder(mediaStream);
 * recorder.record();
 * recorder.stop(function(blob) {
 *     video.src = URL.createObjectURL(blob);
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @param {object} config - {webAssemblyPath:'webm-wasm.wasm',workerPath: 'webm-worker.js', frameRate: 30, width: 1920, height: 1080, bitrate: 1024, realtime: true}
 */function X(o,t){(typeof ReadableStream>"u"||typeof WritableStream>"u")&&console.error("Following polyfill is strongly recommended: https://unpkg.com/@mattiasbuelens/web-streams-polyfill/dist/polyfill.min.js"),t=t||{},t.width=t.width||640,t.height=t.height||480,t.frameRate=t.frameRate||30,t.bitrate=t.bitrate||1200,t.realtime=t.realtime||!0;var a;function p(){return new ReadableStream({start:function(M){var A=document.createElement("canvas"),L=document.createElement("video"),T=!0;L.srcObject=o,L.muted=!0,L.height=t.height,L.width=t.width,L.volume=0,L.onplaying=function(){A.width=t.width,A.height=t.height;var x=A.getContext("2d"),w=1e3/t.frameRate,U=setInterval(function(){if(a&&(clearInterval(U),M.close()),T&&(T=!1,t.onVideoProcessStarted&&t.onVideoProcessStarted()),x.drawImage(L,0,0),M._controlledReadableStream.state!=="closed")try{M.enqueue(x.getImageData(0,0,t.width,t.height))}catch{}},w)},L.play()}})}var _;function d(M,A){if(!t.workerPath&&!A){a=!1,fetch("https://unpkg.com/webm-wasm@latest/dist/webm-worker.js").then(function(T){T.arrayBuffer().then(function(x){d(M,x)})});return}if(!t.workerPath&&A instanceof ArrayBuffer){var L=new Blob([A],{type:"text/javascript"});t.workerPath=G.createObjectURL(L)}t.workerPath||console.error("workerPath parameter is missing."),_=new Worker(t.workerPath),_.postMessage(t.webAssemblyPath||"https://unpkg.com/webm-wasm@latest/dist/webm-wasm.wasm"),_.addEventListener("message",function(T){T.data==="READY"?(_.postMessage({width:t.width,height:t.height,bitrate:t.bitrate||1200,timebaseDen:t.frameRate||30,realtime:t.realtime}),p().pipeTo(new WritableStream({write:function(x){if(a){console.error("Got image, but recorder is finished!");return}_.postMessage(x.data.buffer,[x.data.buffer])}}))):T.data&&(b||R.push(T.data))})}this.record=function(){R=[],b=!1,this.blob=null,d(o),typeof t.initCallback=="function"&&t.initCallback()};var b;this.pause=function(){b=!0},this.resume=function(){b=!1};function u(M){if(!_){M&&M();return}_.addEventListener("message",function(A){A.data===null&&(_.terminate(),_=null,M&&M())}),_.postMessage(null)}var R=[];this.stop=function(M){a=!0;var A=this;u(function(){A.blob=new Blob(R,{type:"video/webm"}),M(A.blob)})},this.name="WebAssemblyRecorder",this.toString=function(){return this.name},this.clearRecordedData=function(){R=[],b=!1,this.blob=null},this.blob=null}typeof C<"u"&&(C.WebAssemblyRecorder=X)})(ot);var at={};/*!
 *  howler.js v2.2.3
 *  howlerjs.com
 *
 *  (c) 2013-2020, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */(function(Z){(function(){var C=function(){this.init()};C.prototype={init:function(){var e=this||i;return e._counter=1e3,e._html5AudioPool=[],e.html5PoolSize=10,e._codecs={},e._howls=[],e._muted=!1,e._volume=1,e._canPlayEvent="canplaythrough",e._navigator=typeof window<"u"&&window.navigator?window.navigator:null,e.masterGain=null,e.noAudio=!1,e.usingWebAudio=!0,e.autoSuspend=!0,e.ctx=null,e.autoUnlock=!0,e._setup(),e},volume:function(e){var r=this||i;if(e=parseFloat(e),r.ctx||G(),typeof e<"u"&&e>=0&&e<=1){if(r._volume=e,r._muted)return r;r.usingWebAudio&&r.masterGain.gain.setValueAtTime(e,i.ctx.currentTime);for(var n=0;n<r._howls.length;n++)if(!r._howls[n]._webAudio)for(var s=r._howls[n]._getSoundIds(),h=0;h<s.length;h++){var g=r._howls[n]._soundById(s[h]);g&&g._node&&(g._node.volume=g._volume*e)}return r}return r._volume},mute:function(e){var r=this||i;r.ctx||G(),r._muted=e,r.usingWebAudio&&r.masterGain.gain.setValueAtTime(e?0:r._volume,i.ctx.currentTime);for(var n=0;n<r._howls.length;n++)if(!r._howls[n]._webAudio)for(var s=r._howls[n]._getSoundIds(),h=0;h<s.length;h++){var g=r._howls[n]._soundById(s[h]);g&&g._node&&(g._node.muted=e?!0:g._muted)}return r},stop:function(){for(var e=this||i,r=0;r<e._howls.length;r++)e._howls[r].stop();return e},unload:function(){for(var e=this||i,r=e._howls.length-1;r>=0;r--)e._howls[r].unload();return e.usingWebAudio&&e.ctx&&typeof e.ctx.close<"u"&&(e.ctx.close(),e.ctx=null,G()),e},codecs:function(e){return(this||i)._codecs[e.replace(/^x-/,"")]},_setup:function(){var e=this||i;if(e.state=e.ctx&&e.ctx.state||"suspended",e._autoSuspend(),!e.usingWebAudio)if(typeof Audio<"u")try{var r=new Audio;typeof r.oncanplaythrough>"u"&&(e._canPlayEvent="canplay")}catch{e.noAudio=!0}else e.noAudio=!0;try{var r=new Audio;r.muted&&(e.noAudio=!0)}catch{}return e.noAudio||e._setupCodecs(),e},_setupCodecs:function(){var e=this||i,r=null;try{r=typeof Audio<"u"?new Audio:null}catch{return e}if(!r||typeof r.canPlayType!="function")return e;var n=r.canPlayType("audio/mpeg;").replace(/^no$/,""),s=e._navigator?e._navigator.userAgent:"",h=s.match(/OPR\/([0-6].)/g),g=h&&parseInt(h[0].split("/")[1],10)<33,f=s.indexOf("Safari")!==-1&&s.indexOf("Chrome")===-1,B=s.match(/Version\/(.*?) /),j=f&&B&&parseInt(B[1],10)<15;return e._codecs={mp3:!!(!g&&(n||r.canPlayType("audio/mp3;").replace(/^no$/,""))),mpeg:!!n,opus:!!r.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!r.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!r.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(r.canPlayType('audio/wav; codecs="1"')||r.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!r.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!r.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(r.canPlayType("audio/x-m4a;")||r.canPlayType("audio/m4a;")||r.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(r.canPlayType("audio/x-m4b;")||r.canPlayType("audio/m4b;")||r.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(r.canPlayType("audio/x-mp4;")||r.canPlayType("audio/mp4;")||r.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!(!j&&r.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:!!(!j&&r.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:!!r.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(r.canPlayType("audio/x-flac;")||r.canPlayType("audio/flac;")).replace(/^no$/,"")},e},_unlockAudio:function(){var e=this||i;if(!(e._audioUnlocked||!e.ctx)){e._audioUnlocked=!1,e.autoUnlock=!1,!e._mobileUnloaded&&e.ctx.sampleRate!==44100&&(e._mobileUnloaded=!0,e.unload()),e._scratchBuffer=e.ctx.createBuffer(1,1,22050);var r=function(n){for(;e._html5AudioPool.length<e.html5PoolSize;)try{var s=new Audio;s._unlocked=!0,e._releaseHtml5Audio(s)}catch{e.noAudio=!0;break}for(var h=0;h<e._howls.length;h++)if(!e._howls[h]._webAudio)for(var g=e._howls[h]._getSoundIds(),f=0;f<g.length;f++){var B=e._howls[h]._soundById(g[f]);B&&B._node&&!B._node._unlocked&&(B._node._unlocked=!0,B._node.load())}e._autoResume();var j=e.ctx.createBufferSource();j.buffer=e._scratchBuffer,j.connect(e.ctx.destination),typeof j.start>"u"?j.noteOn(0):j.start(0),typeof e.ctx.resume=="function"&&e.ctx.resume(),j.onended=function(){j.disconnect(0),e._audioUnlocked=!0,document.removeEventListener("touchstart",r,!0),document.removeEventListener("touchend",r,!0),document.removeEventListener("click",r,!0),document.removeEventListener("keydown",r,!0);for(var H=0;H<e._howls.length;H++)e._howls[H]._emit("unlock")}};return document.addEventListener("touchstart",r,!0),document.addEventListener("touchend",r,!0),document.addEventListener("click",r,!0),document.addEventListener("keydown",r,!0),e}},_obtainHtml5Audio:function(){var e=this||i;if(e._html5AudioPool.length)return e._html5AudioPool.pop();var r=new Audio().play();return r&&typeof Promise<"u"&&(r instanceof Promise||typeof r.then=="function")&&r.catch(function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")}),new Audio},_releaseHtml5Audio:function(e){var r=this||i;return e._unlocked&&r._html5AudioPool.push(e),r},_autoSuspend:function(){var e=this;if(!(!e.autoSuspend||!e.ctx||typeof e.ctx.suspend>"u"||!i.usingWebAudio)){for(var r=0;r<e._howls.length;r++)if(e._howls[r]._webAudio){for(var n=0;n<e._howls[r]._sounds.length;n++)if(!e._howls[r]._sounds[n]._paused)return e}return e._suspendTimer&&clearTimeout(e._suspendTimer),e._suspendTimer=setTimeout(function(){if(!!e.autoSuspend){e._suspendTimer=null,e.state="suspending";var s=function(){e.state="suspended",e._resumeAfterSuspend&&(delete e._resumeAfterSuspend,e._autoResume())};e.ctx.suspend().then(s,s)}},3e4),e}},_autoResume:function(){var e=this;if(!(!e.ctx||typeof e.ctx.resume>"u"||!i.usingWebAudio))return e.state==="running"&&e.ctx.state!=="interrupted"&&e._suspendTimer?(clearTimeout(e._suspendTimer),e._suspendTimer=null):e.state==="suspended"||e.state==="running"&&e.ctx.state==="interrupted"?(e.ctx.resume().then(function(){e.state="running";for(var r=0;r<e._howls.length;r++)e._howls[r]._emit("resume")}),e._suspendTimer&&(clearTimeout(e._suspendTimer),e._suspendTimer=null)):e.state==="suspending"&&(e._resumeAfterSuspend=!0),e}};var i=new C,v=function(e){var r=this;if(!e.src||e.src.length===0){console.error("An array of source files must be passed with any new Howl.");return}r.init(e)};v.prototype={init:function(e){var r=this;return i.ctx||G(),r._autoplay=e.autoplay||!1,r._format=typeof e.format!="string"?e.format:[e.format],r._html5=e.html5||!1,r._muted=e.mute||!1,r._loop=e.loop||!1,r._pool=e.pool||5,r._preload=typeof e.preload=="boolean"||e.preload==="metadata"?e.preload:!0,r._rate=e.rate||1,r._sprite=e.sprite||{},r._src=typeof e.src!="string"?e.src:[e.src],r._volume=e.volume!==void 0?e.volume:1,r._xhr={method:e.xhr&&e.xhr.method?e.xhr.method:"GET",headers:e.xhr&&e.xhr.headers?e.xhr.headers:null,withCredentials:e.xhr&&e.xhr.withCredentials?e.xhr.withCredentials:!1},r._duration=0,r._state="unloaded",r._sounds=[],r._endTimers={},r._queue=[],r._playLock=!1,r._onend=e.onend?[{fn:e.onend}]:[],r._onfade=e.onfade?[{fn:e.onfade}]:[],r._onload=e.onload?[{fn:e.onload}]:[],r._onloaderror=e.onloaderror?[{fn:e.onloaderror}]:[],r._onplayerror=e.onplayerror?[{fn:e.onplayerror}]:[],r._onpause=e.onpause?[{fn:e.onpause}]:[],r._onplay=e.onplay?[{fn:e.onplay}]:[],r._onstop=e.onstop?[{fn:e.onstop}]:[],r._onmute=e.onmute?[{fn:e.onmute}]:[],r._onvolume=e.onvolume?[{fn:e.onvolume}]:[],r._onrate=e.onrate?[{fn:e.onrate}]:[],r._onseek=e.onseek?[{fn:e.onseek}]:[],r._onunlock=e.onunlock?[{fn:e.onunlock}]:[],r._onresume=[],r._webAudio=i.usingWebAudio&&!r._html5,typeof i.ctx<"u"&&i.ctx&&i.autoUnlock&&i._unlockAudio(),i._howls.push(r),r._autoplay&&r._queue.push({event:"play",action:function(){r.play()}}),r._preload&&r._preload!=="none"&&r.load(),r},load:function(){var e=this,r=null;if(i.noAudio){e._emit("loaderror",null,"No audio support.");return}typeof e._src=="string"&&(e._src=[e._src]);for(var n=0;n<e._src.length;n++){var s,h;if(e._format&&e._format[n])s=e._format[n];else{if(h=e._src[n],typeof h!="string"){e._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}s=/^data:audio\/([^;,]+);/i.exec(h),s||(s=/\.([^.]+)$/.exec(h.split("?",1)[0])),s&&(s=s[1].toLowerCase())}if(s||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),s&&i.codecs(s)){r=e._src[n];break}}if(!r){e._emit("loaderror",null,"No codec support for selected audio sources.");return}return e._src=r,e._state="loading",window.location.protocol==="https:"&&r.slice(0,5)==="http:"&&(e._html5=!0,e._webAudio=!1),new m(e),e._webAudio&&D(e),e},play:function(e,r){var n=this,s=null;if(typeof e=="number")s=e,e=null;else{if(typeof e=="string"&&n._state==="loaded"&&!n._sprite[e])return null;if(typeof e>"u"&&(e="__default",!n._playLock)){for(var h=0,g=0;g<n._sounds.length;g++)n._sounds[g]._paused&&!n._sounds[g]._ended&&(h++,s=n._sounds[g]._id);h===1?e=null:s=null}}var f=s?n._soundById(s):n._inactiveSound();if(!f)return null;if(s&&!e&&(e=f._sprite||"__default"),n._state!=="loaded"){f._sprite=e,f._ended=!1;var B=f._id;return n._queue.push({event:"play",action:function(){n.play(B)}}),B}if(s&&!f._paused)return r||n._loadQueue("play"),f._id;n._webAudio&&i._autoResume();var j=Math.max(0,f._seek>0?f._seek:n._sprite[e][0]/1e3),H=Math.max(0,(n._sprite[e][0]+n._sprite[e][1])/1e3-j),ae=H*1e3/Math.abs(f._rate),ce=n._sprite[e][0]/1e3,ue=(n._sprite[e][0]+n._sprite[e][1])/1e3;f._sprite=e,f._ended=!1;var fe=function(){f._paused=!1,f._seek=j,f._start=ce,f._stop=ue,f._loop=!!(f._loop||n._sprite[e][2])};if(j>=ue){n._ended(f);return}var N=f._node;if(n._webAudio){var ye=function(){n._playLock=!1,fe(),n._refreshBuffer(f);var J=f._muted||n._muted?0:f._volume;N.gain.setValueAtTime(J,i.ctx.currentTime),f._playStart=i.ctx.currentTime,typeof N.bufferSource.start>"u"?f._loop?N.bufferSource.noteGrainOn(0,j,86400):N.bufferSource.noteGrainOn(0,j,H):f._loop?N.bufferSource.start(0,j,86400):N.bufferSource.start(0,j,H),ae!==1/0&&(n._endTimers[f._id]=setTimeout(n._ended.bind(n,f),ae)),r||setTimeout(function(){n._emit("play",f._id),n._loadQueue()},0)};i.state==="running"&&i.ctx.state!=="interrupted"?ye():(n._playLock=!0,n.once("resume",ye),n._clearTimer(f._id))}else{var be=function(){N.currentTime=j,N.muted=f._muted||n._muted||i._muted||N.muted,N.volume=f._volume*i.volume(),N.playbackRate=f._rate;try{var J=N.play();if(J&&typeof Promise<"u"&&(J instanceof Promise||typeof J.then=="function")?(n._playLock=!0,fe(),J.then(function(){n._playLock=!1,N._unlocked=!0,r?n._loadQueue():n._emit("play",f._id)}).catch(function(){n._playLock=!1,n._emit("playerror",f._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),f._ended=!0,f._paused=!0})):r||(n._playLock=!1,fe(),n._emit("play",f._id)),N.playbackRate=f._rate,N.paused){n._emit("playerror",f._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");return}e!=="__default"||f._loop?n._endTimers[f._id]=setTimeout(n._ended.bind(n,f),ae):(n._endTimers[f._id]=function(){n._ended(f),N.removeEventListener("ended",n._endTimers[f._id],!1)},N.addEventListener("ended",n._endTimers[f._id],!1))}catch(we){n._emit("playerror",f._id,we)}};N.src==="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"&&(N.src=n._src,N.load());var Te=window&&window.ejecta||!N.readyState&&i._navigator.isCocoonJS;if(N.readyState>=3||Te)be();else{n._playLock=!0,n._state="loading";var Se=function(){n._state="loaded",be(),N.removeEventListener(i._canPlayEvent,Se,!1)};N.addEventListener(i._canPlayEvent,Se,!1),n._clearTimer(f._id)}}return f._id},pause:function(e){var r=this;if(r._state!=="loaded"||r._playLock)return r._queue.push({event:"pause",action:function(){r.pause(e)}}),r;for(var n=r._getSoundIds(e),s=0;s<n.length;s++){r._clearTimer(n[s]);var h=r._soundById(n[s]);if(h&&!h._paused&&(h._seek=r.seek(n[s]),h._rateSeek=0,h._paused=!0,r._stopFade(n[s]),h._node))if(r._webAudio){if(!h._node.bufferSource)continue;typeof h._node.bufferSource.stop>"u"?h._node.bufferSource.noteOff(0):h._node.bufferSource.stop(0),r._cleanBuffer(h._node)}else(!isNaN(h._node.duration)||h._node.duration===1/0)&&h._node.pause();arguments[1]||r._emit("pause",h?h._id:null)}return r},stop:function(e,r){var n=this;if(n._state!=="loaded"||n._playLock)return n._queue.push({event:"stop",action:function(){n.stop(e)}}),n;for(var s=n._getSoundIds(e),h=0;h<s.length;h++){n._clearTimer(s[h]);var g=n._soundById(s[h]);g&&(g._seek=g._start||0,g._rateSeek=0,g._paused=!0,g._ended=!0,n._stopFade(s[h]),g._node&&(n._webAudio?g._node.bufferSource&&(typeof g._node.bufferSource.stop>"u"?g._node.bufferSource.noteOff(0):g._node.bufferSource.stop(0),n._cleanBuffer(g._node)):(!isNaN(g._node.duration)||g._node.duration===1/0)&&(g._node.currentTime=g._start||0,g._node.pause(),g._node.duration===1/0&&n._clearSound(g._node))),r||n._emit("stop",g._id))}return n},mute:function(e,r){var n=this;if(n._state!=="loaded"||n._playLock)return n._queue.push({event:"mute",action:function(){n.mute(e,r)}}),n;if(typeof r>"u")if(typeof e=="boolean")n._muted=e;else return n._muted;for(var s=n._getSoundIds(r),h=0;h<s.length;h++){var g=n._soundById(s[h]);g&&(g._muted=e,g._interval&&n._stopFade(g._id),n._webAudio&&g._node?g._node.gain.setValueAtTime(e?0:g._volume,i.ctx.currentTime):g._node&&(g._node.muted=i._muted?!0:e),n._emit("mute",g._id))}return n},volume:function(){var e=this,r=arguments,n,s;if(r.length===0)return e._volume;if(r.length===1||r.length===2&&typeof r[1]>"u"){var h=e._getSoundIds(),g=h.indexOf(r[0]);g>=0?s=parseInt(r[0],10):n=parseFloat(r[0])}else r.length>=2&&(n=parseFloat(r[0]),s=parseInt(r[1],10));var f;if(typeof n<"u"&&n>=0&&n<=1){if(e._state!=="loaded"||e._playLock)return e._queue.push({event:"volume",action:function(){e.volume.apply(e,r)}}),e;typeof s>"u"&&(e._volume=n),s=e._getSoundIds(s);for(var B=0;B<s.length;B++)f=e._soundById(s[B]),f&&(f._volume=n,r[2]||e._stopFade(s[B]),e._webAudio&&f._node&&!f._muted?f._node.gain.setValueAtTime(n,i.ctx.currentTime):f._node&&!f._muted&&(f._node.volume=n*i.volume()),e._emit("volume",f._id))}else return f=s?e._soundById(s):e._sounds[0],f?f._volume:0;return e},fade:function(e,r,n,s){var h=this;if(h._state!=="loaded"||h._playLock)return h._queue.push({event:"fade",action:function(){h.fade(e,r,n,s)}}),h;e=Math.min(Math.max(0,parseFloat(e)),1),r=Math.min(Math.max(0,parseFloat(r)),1),n=parseFloat(n),h.volume(e,s);for(var g=h._getSoundIds(s),f=0;f<g.length;f++){var B=h._soundById(g[f]);if(B){if(s||h._stopFade(g[f]),h._webAudio&&!B._muted){var j=i.ctx.currentTime,H=j+n/1e3;B._volume=e,B._node.gain.setValueAtTime(e,j),B._node.gain.linearRampToValueAtTime(r,H)}h._startFadeInterval(B,e,r,n,g[f],typeof s>"u")}}return h},_startFadeInterval:function(e,r,n,s,h,g){var f=this,B=r,j=n-r,H=Math.abs(j/.01),ae=Math.max(4,H>0?s/H:s),ce=Date.now();e._fadeTo=n,e._interval=setInterval(function(){var ue=(Date.now()-ce)/s;ce=Date.now(),B+=j*ue,B=Math.round(B*100)/100,j<0?B=Math.max(n,B):B=Math.min(n,B),f._webAudio?e._volume=B:f.volume(B,e._id,!0),g&&(f._volume=B),(n<r&&B<=n||n>r&&B>=n)&&(clearInterval(e._interval),e._interval=null,e._fadeTo=null,f.volume(n,e._id),f._emit("fade",e._id))},ae)},_stopFade:function(e){var r=this,n=r._soundById(e);return n&&n._interval&&(r._webAudio&&n._node.gain.cancelScheduledValues(i.ctx.currentTime),clearInterval(n._interval),n._interval=null,r.volume(n._fadeTo,e),n._fadeTo=null,r._emit("fade",e)),r},loop:function(){var e=this,r=arguments,n,s,h;if(r.length===0)return e._loop;if(r.length===1)if(typeof r[0]=="boolean")n=r[0],e._loop=n;else return h=e._soundById(parseInt(r[0],10)),h?h._loop:!1;else r.length===2&&(n=r[0],s=parseInt(r[1],10));for(var g=e._getSoundIds(s),f=0;f<g.length;f++)h=e._soundById(g[f]),h&&(h._loop=n,e._webAudio&&h._node&&h._node.bufferSource&&(h._node.bufferSource.loop=n,n&&(h._node.bufferSource.loopStart=h._start||0,h._node.bufferSource.loopEnd=h._stop,e.playing(g[f])&&(e.pause(g[f],!0),e.play(g[f],!0)))));return e},rate:function(){var e=this,r=arguments,n,s;if(r.length===0)s=e._sounds[0]._id;else if(r.length===1){var h=e._getSoundIds(),g=h.indexOf(r[0]);g>=0?s=parseInt(r[0],10):n=parseFloat(r[0])}else r.length===2&&(n=parseFloat(r[0]),s=parseInt(r[1],10));var f;if(typeof n=="number"){if(e._state!=="loaded"||e._playLock)return e._queue.push({event:"rate",action:function(){e.rate.apply(e,r)}}),e;typeof s>"u"&&(e._rate=n),s=e._getSoundIds(s);for(var B=0;B<s.length;B++)if(f=e._soundById(s[B]),f){e.playing(s[B])&&(f._rateSeek=e.seek(s[B]),f._playStart=e._webAudio?i.ctx.currentTime:f._playStart),f._rate=n,e._webAudio&&f._node&&f._node.bufferSource?f._node.bufferSource.playbackRate.setValueAtTime(n,i.ctx.currentTime):f._node&&(f._node.playbackRate=n);var j=e.seek(s[B]),H=(e._sprite[f._sprite][0]+e._sprite[f._sprite][1])/1e3-j,ae=H*1e3/Math.abs(f._rate);(e._endTimers[s[B]]||!f._paused)&&(e._clearTimer(s[B]),e._endTimers[s[B]]=setTimeout(e._ended.bind(e,f),ae)),e._emit("rate",f._id)}}else return f=e._soundById(s),f?f._rate:e._rate;return e},seek:function(){var e=this,r=arguments,n,s;if(r.length===0)e._sounds.length&&(s=e._sounds[0]._id);else if(r.length===1){var h=e._getSoundIds(),g=h.indexOf(r[0]);g>=0?s=parseInt(r[0],10):e._sounds.length&&(s=e._sounds[0]._id,n=parseFloat(r[0]))}else r.length===2&&(n=parseFloat(r[0]),s=parseInt(r[1],10));if(typeof s>"u")return 0;if(typeof n=="number"&&(e._state!=="loaded"||e._playLock))return e._queue.push({event:"seek",action:function(){e.seek.apply(e,r)}}),e;var f=e._soundById(s);if(f)if(typeof n=="number"&&n>=0){var B=e.playing(s);B&&e.pause(s,!0),f._seek=n,f._ended=!1,e._clearTimer(s),!e._webAudio&&f._node&&!isNaN(f._node.duration)&&(f._node.currentTime=n);var j=function(){B&&e.play(s,!0),e._emit("seek",s)};if(B&&!e._webAudio){var H=function(){e._playLock?setTimeout(H,0):j()};setTimeout(H,0)}else j()}else if(e._webAudio){var ae=e.playing(s)?i.ctx.currentTime-f._playStart:0,ce=f._rateSeek?f._rateSeek-f._seek:0;return f._seek+(ce+ae*Math.abs(f._rate))}else return f._node.currentTime;return e},playing:function(e){var r=this;if(typeof e=="number"){var n=r._soundById(e);return n?!n._paused:!1}for(var s=0;s<r._sounds.length;s++)if(!r._sounds[s]._paused)return!0;return!1},duration:function(e){var r=this,n=r._duration,s=r._soundById(e);return s&&(n=r._sprite[s._sprite][1]/1e3),n},state:function(){return this._state},unload:function(){for(var e=this,r=e._sounds,n=0;n<r.length;n++)r[n]._paused||e.stop(r[n]._id),e._webAudio||(e._clearSound(r[n]._node),r[n]._node.removeEventListener("error",r[n]._errorFn,!1),r[n]._node.removeEventListener(i._canPlayEvent,r[n]._loadFn,!1),r[n]._node.removeEventListener("ended",r[n]._endFn,!1),i._releaseHtml5Audio(r[n]._node)),delete r[n]._node,e._clearTimer(r[n]._id);var s=i._howls.indexOf(e);s>=0&&i._howls.splice(s,1);var h=!0;for(n=0;n<i._howls.length;n++)if(i._howls[n]._src===e._src||e._src.indexOf(i._howls[n]._src)>=0){h=!1;break}return O&&h&&delete O[e._src],i.noAudio=!1,e._state="unloaded",e._sounds=[],e=null,null},on:function(e,r,n,s){var h=this,g=h["_on"+e];return typeof r=="function"&&g.push(s?{id:n,fn:r,once:s}:{id:n,fn:r}),h},off:function(e,r,n){var s=this,h=s["_on"+e],g=0;if(typeof r=="number"&&(n=r,r=null),r||n)for(g=0;g<h.length;g++){var f=n===h[g].id;if(r===h[g].fn&&f||!r&&f){h.splice(g,1);break}}else if(e)s["_on"+e]=[];else{var B=Object.keys(s);for(g=0;g<B.length;g++)B[g].indexOf("_on")===0&&Array.isArray(s[B[g]])&&(s[B[g]]=[])}return s},once:function(e,r,n){var s=this;return s.on(e,r,n,1),s},_emit:function(e,r,n){for(var s=this,h=s["_on"+e],g=h.length-1;g>=0;g--)(!h[g].id||h[g].id===r||e==="load")&&(setTimeout(function(f){f.call(this,r,n)}.bind(s,h[g].fn),0),h[g].once&&s.off(e,h[g].fn,h[g].id));return s._loadQueue(e),s},_loadQueue:function(e){var r=this;if(r._queue.length>0){var n=r._queue[0];n.event===e&&(r._queue.shift(),r._loadQueue()),e||n.action()}return r},_ended:function(e){var r=this,n=e._sprite;if(!r._webAudio&&e._node&&!e._node.paused&&!e._node.ended&&e._node.currentTime<e._stop)return setTimeout(r._ended.bind(r,e),100),r;var s=!!(e._loop||r._sprite[n][2]);if(r._emit("end",e._id),!r._webAudio&&s&&r.stop(e._id,!0).play(e._id),r._webAudio&&s){r._emit("play",e._id),e._seek=e._start||0,e._rateSeek=0,e._playStart=i.ctx.currentTime;var h=(e._stop-e._start)*1e3/Math.abs(e._rate);r._endTimers[e._id]=setTimeout(r._ended.bind(r,e),h)}return r._webAudio&&!s&&(e._paused=!0,e._ended=!0,e._seek=e._start||0,e._rateSeek=0,r._clearTimer(e._id),r._cleanBuffer(e._node),i._autoSuspend()),!r._webAudio&&!s&&r.stop(e._id,!0),r},_clearTimer:function(e){var r=this;if(r._endTimers[e]){if(typeof r._endTimers[e]!="function")clearTimeout(r._endTimers[e]);else{var n=r._soundById(e);n&&n._node&&n._node.removeEventListener("ended",r._endTimers[e],!1)}delete r._endTimers[e]}return r},_soundById:function(e){for(var r=this,n=0;n<r._sounds.length;n++)if(e===r._sounds[n]._id)return r._sounds[n];return null},_inactiveSound:function(){var e=this;e._drain();for(var r=0;r<e._sounds.length;r++)if(e._sounds[r]._ended)return e._sounds[r].reset();return new m(e)},_drain:function(){var e=this,r=e._pool,n=0,s=0;if(!(e._sounds.length<r)){for(s=0;s<e._sounds.length;s++)e._sounds[s]._ended&&n++;for(s=e._sounds.length-1;s>=0;s--){if(n<=r)return;e._sounds[s]._ended&&(e._webAudio&&e._sounds[s]._node&&e._sounds[s]._node.disconnect(0),e._sounds.splice(s,1),n--)}}},_getSoundIds:function(e){var r=this;if(typeof e>"u"){for(var n=[],s=0;s<r._sounds.length;s++)n.push(r._sounds[s]._id);return n}else return[e]},_refreshBuffer:function(e){var r=this;return e._node.bufferSource=i.ctx.createBufferSource(),e._node.bufferSource.buffer=O[r._src],e._panner?e._node.bufferSource.connect(e._panner):e._node.bufferSource.connect(e._node),e._node.bufferSource.loop=e._loop,e._loop&&(e._node.bufferSource.loopStart=e._start||0,e._node.bufferSource.loopEnd=e._stop||0),e._node.bufferSource.playbackRate.setValueAtTime(e._rate,i.ctx.currentTime),r},_cleanBuffer:function(e){var r=this,n=i._navigator&&i._navigator.vendor.indexOf("Apple")>=0;if(i._scratchBuffer&&e.bufferSource&&(e.bufferSource.onended=null,e.bufferSource.disconnect(0),n))try{e.bufferSource.buffer=i._scratchBuffer}catch{}return e.bufferSource=null,r},_clearSound:function(e){var r=/MSIE |Trident\//.test(i._navigator&&i._navigator.userAgent);r||(e.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var m=function(e){this._parent=e,this.init()};m.prototype={init:function(){var e=this,r=e._parent;return e._muted=r._muted,e._loop=r._loop,e._volume=r._volume,e._rate=r._rate,e._seek=0,e._paused=!0,e._ended=!0,e._sprite="__default",e._id=++i._counter,r._sounds.push(e),e.create(),e},create:function(){var e=this,r=e._parent,n=i._muted||e._muted||e._parent._muted?0:e._volume;return r._webAudio?(e._node=typeof i.ctx.createGain>"u"?i.ctx.createGainNode():i.ctx.createGain(),e._node.gain.setValueAtTime(n,i.ctx.currentTime),e._node.paused=!0,e._node.connect(i.masterGain)):i.noAudio||(e._node=i._obtainHtml5Audio(),e._errorFn=e._errorListener.bind(e),e._node.addEventListener("error",e._errorFn,!1),e._loadFn=e._loadListener.bind(e),e._node.addEventListener(i._canPlayEvent,e._loadFn,!1),e._endFn=e._endListener.bind(e),e._node.addEventListener("ended",e._endFn,!1),e._node.src=r._src,e._node.preload=r._preload===!0?"auto":r._preload,e._node.volume=n*i.volume(),e._node.load()),e},reset:function(){var e=this,r=e._parent;return e._muted=r._muted,e._loop=r._loop,e._volume=r._volume,e._rate=r._rate,e._seek=0,e._rateSeek=0,e._paused=!0,e._ended=!0,e._sprite="__default",e._id=++i._counter,e},_errorListener:function(){var e=this;e._parent._emit("loaderror",e._id,e._node.error?e._node.error.code:0),e._node.removeEventListener("error",e._errorFn,!1)},_loadListener:function(){var e=this,r=e._parent;r._duration=Math.ceil(e._node.duration*10)/10,Object.keys(r._sprite).length===0&&(r._sprite={__default:[0,r._duration*1e3]}),r._state!=="loaded"&&(r._state="loaded",r._emit("load"),r._loadQueue()),e._node.removeEventListener(i._canPlayEvent,e._loadFn,!1)},_endListener:function(){var e=this,r=e._parent;r._duration===1/0&&(r._duration=Math.ceil(e._node.duration*10)/10,r._sprite.__default[1]===1/0&&(r._sprite.__default[1]=r._duration*1e3),r._ended(e)),e._node.removeEventListener("ended",e._endFn,!1)}};var O={},D=function(e){var r=e._src;if(O[r]){e._duration=O[r].duration,k(e);return}if(/^data:[^;]+;base64,/.test(r)){for(var n=atob(r.split(",")[1]),s=new Uint8Array(n.length),h=0;h<n.length;++h)s[h]=n.charCodeAt(h);F(s.buffer,e)}else{var g=new XMLHttpRequest;g.open(e._xhr.method,r,!0),g.withCredentials=e._xhr.withCredentials,g.responseType="arraybuffer",e._xhr.headers&&Object.keys(e._xhr.headers).forEach(function(f){g.setRequestHeader(f,e._xhr.headers[f])}),g.onload=function(){var f=(g.status+"")[0];if(f!=="0"&&f!=="2"&&f!=="3"){e._emit("loaderror",null,"Failed loading audio file with status: "+g.status+".");return}F(g.response,e)},g.onerror=function(){e._webAudio&&(e._html5=!0,e._webAudio=!1,e._sounds=[],delete O[r],e.load())},Y(g)}},Y=function(e){try{e.send()}catch{e.onerror()}},F=function(e,r){var n=function(){r._emit("loaderror",null,"Decoding audio data failed.")},s=function(h){h&&r._sounds.length>0?(O[r._src]=h,k(r,h)):n()};typeof Promise<"u"&&i.ctx.decodeAudioData.length===1?i.ctx.decodeAudioData(e).then(s).catch(n):i.ctx.decodeAudioData(e,s,n)},k=function(e,r){r&&!e._duration&&(e._duration=r.duration),Object.keys(e._sprite).length===0&&(e._sprite={__default:[0,e._duration*1e3]}),e._state!=="loaded"&&(e._state="loaded",e._emit("load"),e._loadQueue())},G=function(){if(!!i.usingWebAudio){try{typeof AudioContext<"u"?i.ctx=new AudioContext:typeof webkitAudioContext<"u"?i.ctx=new webkitAudioContext:i.usingWebAudio=!1}catch{i.usingWebAudio=!1}i.ctx||(i.usingWebAudio=!1);var e=/iP(hone|od|ad)/.test(i._navigator&&i._navigator.platform),r=i._navigator&&i._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),n=r?parseInt(r[1],10):null;if(e&&n&&n<9){var s=/safari/.test(i._navigator&&i._navigator.userAgent.toLowerCase());i._navigator&&!s&&(i.usingWebAudio=!1)}i.usingWebAudio&&(i.masterGain=typeof i.ctx.createGain>"u"?i.ctx.createGainNode():i.ctx.createGain(),i.masterGain.gain.setValueAtTime(i._muted?0:i._volume,i.ctx.currentTime),i.masterGain.connect(i.ctx.destination)),i._setup()}};Z.Howler=i,Z.Howl=v,typeof Q<"u"?(Q.HowlerGlobal=C,Q.Howler=i,Q.Howl=v,Q.Sound=m):typeof window<"u"&&(window.HowlerGlobal=C,window.Howler=i,window.Howl=v,window.Sound=m)})();/*!
 *  Spatial Plugin - Adds support for stereo and 3D audio where Web Audio is supported.
 *  
 *  howler.js v2.2.3
 *  howlerjs.com
 *
 *  (c) 2013-2020, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */(function(){HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(i){var v=this;if(!v.ctx||!v.ctx.listener)return v;for(var m=v._howls.length-1;m>=0;m--)v._howls[m].stereo(i);return v},HowlerGlobal.prototype.pos=function(i,v,m){var O=this;if(!O.ctx||!O.ctx.listener)return O;if(v=typeof v!="number"?O._pos[1]:v,m=typeof m!="number"?O._pos[2]:m,typeof i=="number")O._pos=[i,v,m],typeof O.ctx.listener.positionX<"u"?(O.ctx.listener.positionX.setTargetAtTime(O._pos[0],Howler.ctx.currentTime,.1),O.ctx.listener.positionY.setTargetAtTime(O._pos[1],Howler.ctx.currentTime,.1),O.ctx.listener.positionZ.setTargetAtTime(O._pos[2],Howler.ctx.currentTime,.1)):O.ctx.listener.setPosition(O._pos[0],O._pos[1],O._pos[2]);else return O._pos;return O},HowlerGlobal.prototype.orientation=function(i,v,m,O,D,Y){var F=this;if(!F.ctx||!F.ctx.listener)return F;var k=F._orientation;if(v=typeof v!="number"?k[1]:v,m=typeof m!="number"?k[2]:m,O=typeof O!="number"?k[3]:O,D=typeof D!="number"?k[4]:D,Y=typeof Y!="number"?k[5]:Y,typeof i=="number")F._orientation=[i,v,m,O,D,Y],typeof F.ctx.listener.forwardX<"u"?(F.ctx.listener.forwardX.setTargetAtTime(i,Howler.ctx.currentTime,.1),F.ctx.listener.forwardY.setTargetAtTime(v,Howler.ctx.currentTime,.1),F.ctx.listener.forwardZ.setTargetAtTime(m,Howler.ctx.currentTime,.1),F.ctx.listener.upX.setTargetAtTime(O,Howler.ctx.currentTime,.1),F.ctx.listener.upY.setTargetAtTime(D,Howler.ctx.currentTime,.1),F.ctx.listener.upZ.setTargetAtTime(Y,Howler.ctx.currentTime,.1)):F.ctx.listener.setOrientation(i,v,m,O,D,Y);else return k;return F},Howl.prototype.init=function(i){return function(v){var m=this;return m._orientation=v.orientation||[1,0,0],m._stereo=v.stereo||null,m._pos=v.pos||null,m._pannerAttr={coneInnerAngle:typeof v.coneInnerAngle<"u"?v.coneInnerAngle:360,coneOuterAngle:typeof v.coneOuterAngle<"u"?v.coneOuterAngle:360,coneOuterGain:typeof v.coneOuterGain<"u"?v.coneOuterGain:0,distanceModel:typeof v.distanceModel<"u"?v.distanceModel:"inverse",maxDistance:typeof v.maxDistance<"u"?v.maxDistance:1e4,panningModel:typeof v.panningModel<"u"?v.panningModel:"HRTF",refDistance:typeof v.refDistance<"u"?v.refDistance:1,rolloffFactor:typeof v.rolloffFactor<"u"?v.rolloffFactor:1},m._onstereo=v.onstereo?[{fn:v.onstereo}]:[],m._onpos=v.onpos?[{fn:v.onpos}]:[],m._onorientation=v.onorientation?[{fn:v.onorientation}]:[],i.call(this,v)}}(Howl.prototype.init),Howl.prototype.stereo=function(i,v){var m=this;if(!m._webAudio)return m;if(m._state!=="loaded")return m._queue.push({event:"stereo",action:function(){m.stereo(i,v)}}),m;var O=typeof Howler.ctx.createStereoPanner>"u"?"spatial":"stereo";if(typeof v>"u")if(typeof i=="number")m._stereo=i,m._pos=[i,0,0];else return m._stereo;for(var D=m._getSoundIds(v),Y=0;Y<D.length;Y++){var F=m._soundById(D[Y]);if(F)if(typeof i=="number")F._stereo=i,F._pos=[i,0,0],F._node&&(F._pannerAttr.panningModel="equalpower",(!F._panner||!F._panner.pan)&&C(F,O),O==="spatial"?typeof F._panner.positionX<"u"?(F._panner.positionX.setValueAtTime(i,Howler.ctx.currentTime),F._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),F._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):F._panner.setPosition(i,0,0):F._panner.pan.setValueAtTime(i,Howler.ctx.currentTime)),m._emit("stereo",F._id);else return F._stereo}return m},Howl.prototype.pos=function(i,v,m,O){var D=this;if(!D._webAudio)return D;if(D._state!=="loaded")return D._queue.push({event:"pos",action:function(){D.pos(i,v,m,O)}}),D;if(v=typeof v!="number"?0:v,m=typeof m!="number"?-.5:m,typeof O>"u")if(typeof i=="number")D._pos=[i,v,m];else return D._pos;for(var Y=D._getSoundIds(O),F=0;F<Y.length;F++){var k=D._soundById(Y[F]);if(k)if(typeof i=="number")k._pos=[i,v,m],k._node&&((!k._panner||k._panner.pan)&&C(k,"spatial"),typeof k._panner.positionX<"u"?(k._panner.positionX.setValueAtTime(i,Howler.ctx.currentTime),k._panner.positionY.setValueAtTime(v,Howler.ctx.currentTime),k._panner.positionZ.setValueAtTime(m,Howler.ctx.currentTime)):k._panner.setPosition(i,v,m)),D._emit("pos",k._id);else return k._pos}return D},Howl.prototype.orientation=function(i,v,m,O){var D=this;if(!D._webAudio)return D;if(D._state!=="loaded")return D._queue.push({event:"orientation",action:function(){D.orientation(i,v,m,O)}}),D;if(v=typeof v!="number"?D._orientation[1]:v,m=typeof m!="number"?D._orientation[2]:m,typeof O>"u")if(typeof i=="number")D._orientation=[i,v,m];else return D._orientation;for(var Y=D._getSoundIds(O),F=0;F<Y.length;F++){var k=D._soundById(Y[F]);if(k)if(typeof i=="number")k._orientation=[i,v,m],k._node&&(k._panner||(k._pos||(k._pos=D._pos||[0,0,-.5]),C(k,"spatial")),typeof k._panner.orientationX<"u"?(k._panner.orientationX.setValueAtTime(i,Howler.ctx.currentTime),k._panner.orientationY.setValueAtTime(v,Howler.ctx.currentTime),k._panner.orientationZ.setValueAtTime(m,Howler.ctx.currentTime)):k._panner.setOrientation(i,v,m)),D._emit("orientation",k._id);else return k._orientation}return D},Howl.prototype.pannerAttr=function(){var i=this,v=arguments,m,O,D;if(!i._webAudio)return i;if(v.length===0)return i._pannerAttr;if(v.length===1)if(typeof v[0]=="object")m=v[0],typeof O>"u"&&(m.pannerAttr||(m.pannerAttr={coneInnerAngle:m.coneInnerAngle,coneOuterAngle:m.coneOuterAngle,coneOuterGain:m.coneOuterGain,distanceModel:m.distanceModel,maxDistance:m.maxDistance,refDistance:m.refDistance,rolloffFactor:m.rolloffFactor,panningModel:m.panningModel}),i._pannerAttr={coneInnerAngle:typeof m.pannerAttr.coneInnerAngle<"u"?m.pannerAttr.coneInnerAngle:i._coneInnerAngle,coneOuterAngle:typeof m.pannerAttr.coneOuterAngle<"u"?m.pannerAttr.coneOuterAngle:i._coneOuterAngle,coneOuterGain:typeof m.pannerAttr.coneOuterGain<"u"?m.pannerAttr.coneOuterGain:i._coneOuterGain,distanceModel:typeof m.pannerAttr.distanceModel<"u"?m.pannerAttr.distanceModel:i._distanceModel,maxDistance:typeof m.pannerAttr.maxDistance<"u"?m.pannerAttr.maxDistance:i._maxDistance,refDistance:typeof m.pannerAttr.refDistance<"u"?m.pannerAttr.refDistance:i._refDistance,rolloffFactor:typeof m.pannerAttr.rolloffFactor<"u"?m.pannerAttr.rolloffFactor:i._rolloffFactor,panningModel:typeof m.pannerAttr.panningModel<"u"?m.pannerAttr.panningModel:i._panningModel});else return D=i._soundById(parseInt(v[0],10)),D?D._pannerAttr:i._pannerAttr;else v.length===2&&(m=v[0],O=parseInt(v[1],10));for(var Y=i._getSoundIds(O),F=0;F<Y.length;F++)if(D=i._soundById(Y[F]),D){var k=D._pannerAttr;k={coneInnerAngle:typeof m.coneInnerAngle<"u"?m.coneInnerAngle:k.coneInnerAngle,coneOuterAngle:typeof m.coneOuterAngle<"u"?m.coneOuterAngle:k.coneOuterAngle,coneOuterGain:typeof m.coneOuterGain<"u"?m.coneOuterGain:k.coneOuterGain,distanceModel:typeof m.distanceModel<"u"?m.distanceModel:k.distanceModel,maxDistance:typeof m.maxDistance<"u"?m.maxDistance:k.maxDistance,refDistance:typeof m.refDistance<"u"?m.refDistance:k.refDistance,rolloffFactor:typeof m.rolloffFactor<"u"?m.rolloffFactor:k.rolloffFactor,panningModel:typeof m.panningModel<"u"?m.panningModel:k.panningModel};var G=D._panner;G?(G.coneInnerAngle=k.coneInnerAngle,G.coneOuterAngle=k.coneOuterAngle,G.coneOuterGain=k.coneOuterGain,G.distanceModel=k.distanceModel,G.maxDistance=k.maxDistance,G.refDistance=k.refDistance,G.rolloffFactor=k.rolloffFactor,G.panningModel=k.panningModel):(D._pos||(D._pos=i._pos||[0,0,-.5]),C(D,"spatial"))}return i},Sound.prototype.init=function(i){return function(){var v=this,m=v._parent;v._orientation=m._orientation,v._stereo=m._stereo,v._pos=m._pos,v._pannerAttr=m._pannerAttr,i.call(this),v._stereo?m.stereo(v._stereo):v._pos&&m.pos(v._pos[0],v._pos[1],v._pos[2],v._id)}}(Sound.prototype.init),Sound.prototype.reset=function(i){return function(){var v=this,m=v._parent;return v._orientation=m._orientation,v._stereo=m._stereo,v._pos=m._pos,v._pannerAttr=m._pannerAttr,v._stereo?m.stereo(v._stereo):v._pos?m.pos(v._pos[0],v._pos[1],v._pos[2],v._id):v._panner&&(v._panner.disconnect(0),v._panner=void 0,m._refreshBuffer(v)),i.call(this)}}(Sound.prototype.reset);var C=function(i,v){v=v||"spatial",v==="spatial"?(i._panner=Howler.ctx.createPanner(),i._panner.coneInnerAngle=i._pannerAttr.coneInnerAngle,i._panner.coneOuterAngle=i._pannerAttr.coneOuterAngle,i._panner.coneOuterGain=i._pannerAttr.coneOuterGain,i._panner.distanceModel=i._pannerAttr.distanceModel,i._panner.maxDistance=i._pannerAttr.maxDistance,i._panner.refDistance=i._pannerAttr.refDistance,i._panner.rolloffFactor=i._pannerAttr.rolloffFactor,i._panner.panningModel=i._pannerAttr.panningModel,typeof i._panner.positionX<"u"?(i._panner.positionX.setValueAtTime(i._pos[0],Howler.ctx.currentTime),i._panner.positionY.setValueAtTime(i._pos[1],Howler.ctx.currentTime),i._panner.positionZ.setValueAtTime(i._pos[2],Howler.ctx.currentTime)):i._panner.setPosition(i._pos[0],i._pos[1],i._pos[2]),typeof i._panner.orientationX<"u"?(i._panner.orientationX.setValueAtTime(i._orientation[0],Howler.ctx.currentTime),i._panner.orientationY.setValueAtTime(i._orientation[1],Howler.ctx.currentTime),i._panner.orientationZ.setValueAtTime(i._orientation[2],Howler.ctx.currentTime)):i._panner.setOrientation(i._orientation[0],i._orientation[1],i._orientation[2])):(i._panner=Howler.ctx.createStereoPanner(),i._panner.pan.setValueAtTime(i._stereo,Howler.ctx.currentTime)),i._panner.connect(i._node),i._paused||i._parent.pause(i._id,!0).play(i._id,!0)}})()})(at);const Dt=(Z,C)=>{const i=document.createElement("a");return i.style.display="none",i.setAttribute("href",Z),i.setAttribute("download",C),document.body.appendChild(i),setTimeout(function(){i.click(),document.body.removeChild(i)},66),!0},Bt={class:"container"},It={class:"content",id:"msg_content"},Ft=["id"],Ot={class:"avatar"},Pt=["src"],Ut={class:"time"},Et=["onClick"],Ht=["src"],Gt=["src"],Vt={class:"footer"},Nt={class:"form"},jt={key:0,class:"card"},Wt={key:0},qt={class:"gird-box"},zt=["src"],Xt={class:"grid-text"},$t={key:1},Yt={class:"gird-box"},Qt=["src"],Zt={class:"grid-text"},Kt=["onClick"],Jt={class:"gird-box"},er=["src"],tr={class:"grid-text"},rr=pt({__name:"Chat",setup(Z){var we,Oe;const C=mt(),i=ht(),v=_t(),m=St(),O=Me(""),D=Me(!1),Y=Me([]),F=()=>D.value=!D.value,k=C.query.rid,G=Number(C.query.is_group||0),e=C.query.nickname,r=C.query.avatar,n=Me(!1),s=Me(!1);Me(!0);const h=Me(null),g=[{key:"photo",text:"\u7167\u7247",icon:xt},{key:"camera",text:"\u62CD\u6444",icon:kt},{key:"yuyin_call",text:"\u8BED\u97F3",icon:Lt},{key:"video_call",text:"\u89C6\u9891",icon:Ct},{key:"file",text:"\u6587\u4EF6",icon:nt}],f={cmd:G?et.group_chat:et.private_chat,rid:Number(k),is_group:Boolean(G),to_nickname:e,to_avatar:r,from_nickname:(we=v.userInfo)==null?void 0:we.nickname,from_avatar:(Oe=v.userInfo)==null?void 0:Oe.avatar},B=()=>{i.send({...f,content:O.value||"Hello",type:Ue.text})},j=W=>{var z;return W===((z=v.userInfo)==null?void 0:z.id)},H=(W,z)=>{var o;if(j(W))return(o=v.userInfo)==null?void 0:o.avatar;const X=Y.value.find(t=>t.id===W);return X?X.avatar:""},ae=(W,z)=>{var o;if(j(W))return(o=v.userInfo)==null?void 0:o.nickname;const X=Y.value.find(t=>t.id===W);return X?X.nickname:""},ce=vt(()=>i.list.filter(z=>{const X=z.suid===Number(k),o=z.rid===Number(k);return(X||o)&&Number(z.is_group)===G}).map(z=>({...z,is_me:j(z.suid),avatar:H(z.suid),nickname:ae(z.suid)}))),ue=async()=>{if(s.value)return;const z=document.querySelectorAll(".msg-item")[0].getAttribute("id");s.value=!0,i.list.filter(X=>{const o=X.suid===Number(k),t=X.rid===Number(k);return(o||t)&&Number(X.is_group)===G});try{await bt(500),await i.queryHistory({rid:k,seq:ce.value.length?ce.value[0].time:0,is_group:Boolean(G)}),s.value=!1,setTimeout(()=>{const X=document.querySelector(`#${z}`);i.scrollTo(X.offsetTop)},100)}catch(X){s.value=!1,n.value=X.message}},fe=()=>{G?Mt({id:k}).then(W=>{Y.value=W.data.list}):m.queryProfile([Number(k)]).then(W=>{Y.value=W}),i.markHasRead({pid:Number(k)})};gt(()=>{fe()}),yt(()=>{var W;(W=h.value)==null||W.addEventListener("scroll",z=>{z.target.scrollTop===0&&ue()})});const N=W=>wt(W).format("hh:mm:ss"),ye=W=>{console.log("afterRead",W.file);const z=new FormData;z.append("file",W.file),Ze(z).then(X=>{X.data&&i.send({...f,content:X.data.url,type:Ue.image,title:W.file.name})})},be=W=>{console.log("afterReadFile",W.file);const z=new FormData;z.append("file",W.file),Ze(z).then(X=>{X.data&&i.send({...f,content:X.data.url,title:W.file.name,type:Ue.file})})},Te=async W=>{if(W.key==="video_call"){G||i.setDialUser({id:+k,nickname:e,avatar:r});return}if(W.key==="yuyin_call"){let z=await navigator.mediaDevices.getUserMedia({video:!0,audio:!0}),X=new ot.exports.RecordRTCPromisesHandler(z,{type:"audio"});X.startRecording();const o=p=>new Promise(_=>setTimeout(_,p));At("\u5F55\u52363S"),await o(3e3),await X.stopRecording();let t=await X.getBlob();const a=new FormData;a.append("file",t),Ze(a).then(p=>{p.data&&i.send({...f,content:p.data.url,type:Ue.audio})})}},Se=W=>{var z=new at.Howl({src:[W]});console.log(z),z.play()},J=(W,z)=>{Dt(W,z)};return(W,z)=>{const X=Ie("VanLoading"),o=Ie("van-icon"),t=Ie("van-loading"),a=Ie("van-field"),p=Ie("van-button"),_=Ie("van-uploader");return de(),Ve(Tt,{title:$e(e)},{default:Ne(()=>[K("div",Bt,[K("div",{class:"list",id:"msg_list",ref_key:"scrollRef",ref:h},[K("div",It,[s.value?(de(),Ve(X,{key:0,class:"list-loading",size:"small"})):De("",!0),(de(!0),ge(Ye,null,tt($e(ce),d=>(de(),ge("div",{class:Qe(["item msg-item",{"is-me":d.is_me}]),id:"msg-item-"+d.time},[K("div",Ot,[K("img",{src:d.avatar,alt:""},null,8,Pt)]),K("div",{class:Qe(["main",{"is-me":d.is_me}])},[K("span",Ut,Fe(N(d.create_time)),1),K("div",{class:Qe(["content","msg-content-type-"+d.type])},[d.type===0?(de(),ge(Ye,{key:0},[rt(Fe(d.content),1)],64)):De("",!0),d.type===3?(de(),ge("div",{key:1,onClick:b=>J(d.content,d.title)},[K("span",null,Fe(d.title||"\u6587\u4EF6"),1),K("img",{class:"msg-icon",src:$e(nt),alt:""},null,8,Ht)],8,Et)):De("",!0),d.type===1?(de(),ge("img",{key:2,style:{"max-width":"80%"},src:d.content,alt:""},null,8,Gt)):De("",!0),d.type===2?(de(),Ve(o,{key:3,onClick:b=>Se(d.content),size:20,name:"volume-o"},null,8,["onClick"])):De("",!0),d.loading?(de(),Ve(t,{key:4,class:"loading",size:"20px",type:"spinner"})):De("",!0)],2)],2)],10,Ft))),256))])],512),K("div",Vt,[K("div",Nt,[Pe(a,{class:"input",modelValue:O.value,"onUpdate:modelValue":z[0]||(z[0]=d=>O.value=d),name:"content",placeholder:"\u8F93\u5165",clearable:"",rules:[{required:!0,message:"\u8BF7\u8F93\u5165"}]},null,8,["modelValue"]),Pe(p,{class:"btn",size:"small",onClick:B},{default:Ne(()=>[rt(" \u53D1\u9001 ")]),_:1}),Pe(o,{class:"icon-plus",name:"add-o",onClick:F})]),D.value?(de(),ge("div",jt,[(de(),ge(Ye,null,tt(g,d=>K("div",{class:"grid-item",key:d.key},[d.key==="photo"?(de(),ge("div",Wt,[Pe(_,{"after-read":ye},{default:Ne(()=>[K("div",qt,[K("img",{class:"grid-icon",src:d.icon,alt:""},null,8,zt),K("span",Xt,Fe(d.text),1)])]),_:2},1024)])):d.key==="file"?(de(),ge("div",$t,[Pe(_,{"after-read":be,accept:"image/*,.pdj,.zip,.doc,.docx,.xml,.pptx"},{default:Ne(()=>[K("div",Yt,[K("img",{class:"grid-icon",src:d.icon,alt:""},null,8,Qt),K("span",Zt,Fe(d.text),1)])]),_:2},1024)])):(de(),ge("div",{key:2,onClick:b=>Te(d)},[K("div",Jt,[K("img",{class:"grid-icon",src:d.icon,alt:""},null,8,er),K("span",tr,Fe(d.text),1)])],8,Kt))])),64))])):De("",!0)])])]),_:1},8,["title"])}}});const ar=Rt(rr,[["__scopeId","data-v-4d736da2"]]);export{ar as default};
