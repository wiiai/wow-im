import{c as J,r as nt,d as it,u as ot,a as gt,b as Fe,e as Ze,C as tt,o as yt,f as bt,w as wt,g as te,h as re,i as K,t as ke,j as Ee,k as Se,F as Ue,l as Ke,m as ve,n as At,v as Rt,p as Ne,q as je,s as Tt,x as rt,y as We,z as St,A as at,T as kt,_ as st,B as xt,D as Ct}from"./index.9e2263c7.js";import{u as Lt,T as Mt}from"./TLayout.16bcd6ac.js";var dt={exports:{}};(function(ee){/**
 * {@link https://github.com/muaz-khan/RecordRTC|RecordRTC} is a WebRTC JavaScript library for audio/video as well as screen activity recording. It supports Chrome, Firefox, Opera, Android, and Microsoft Edge. Platforms: Linux, Mac and Windows. 
 * @summary Record audio, video or screen inside the browser.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef RecordRTC
 * @class
 * @example
 * var recorder = RecordRTC(mediaStream or [arrayOfMediaStream], {
 *     type: 'video', // audio or video or gif or canvas
 *     recorderType: MediaStreamRecorder || CanvasRecorder || StereoAudioRecorder || Etc
 * });
 * recorder.startRecording();
 * @see For further information:
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - Single media-stream object, array of media-streams, html-canvas-element, etc.
 * @param {object} config - {type:"video", recorderType: MediaStreamRecorder, disableLogs: true, numberOfAudioChannels: 1, bufferSize: 0, sampleRate: 0, desiredSampRate: 16000, video: HTMLVideoElement, etc.}
 */function y(a,t){if(!a)throw"First parameter is required.";t=t||{type:"video"},t=new i(a,t);var o=this;function m(l){return t.disableLogs||console.log("RecordRTC version: ",o.version),l&&(t=new i(a,l)),t.disableLogs||console.log("started recording "+t.type+" stream."),A?(A.clearRecordedData(),A.record(),M("recording"),o.recordingDuration&&R(),o):(g(function(){o.recordingDuration&&R()}),o)}function g(l){l&&(t.initCallback=function(){l(),l=t.initCallback=null});var k=new p(a,t);A=new k(a,t),A.record(),M("recording"),t.disableLogs||console.log("Initialized recorderType:",A.constructor.name,"for output-type:",t.type)}function _(l){if(l=l||function(){},!A){x();return}if(o.state==="paused"){o.resumeRecording(),setTimeout(function(){_(l)},1);return}o.state!=="recording"&&!t.disableLogs&&console.warn('Recording state should be: "recording", however current state is: ',o.state),t.disableLogs||console.log("Stopped recording "+t.type+" stream."),t.type!=="gif"?A.stop(k):(A.stop(),k()),M("stopped");function k(H){if(!A){typeof l.call=="function"?l.call(o,""):l("");return}Object.keys(A).forEach(function(O){typeof A[O]!="function"&&(o[O]=A[O])});var u=A.blob;if(!u)if(H)A.blob=u=H;else throw"Recording failed.";if(u&&!t.disableLogs&&console.log(u.type,"->",f(u.size)),l){var b;try{b=q.createObjectURL(u)}catch{}typeof l.call=="function"?l.call(o,b):l(b)}!t.autoWriteToDisk||D(function(O){var P={};P[t.type+"Blob"]=O,Z.Store(P)})}}function w(){if(!A){x();return}if(o.state!=="recording"){t.disableLogs||console.warn("Unable to pause the recording. Recording state: ",o.state);return}M("paused"),A.pause(),t.disableLogs||console.log("Paused recording.")}function d(){if(!A){x();return}if(o.state!=="paused"){t.disableLogs||console.warn("Unable to resume the recording. Recording state: ",o.state);return}M("recording"),A.resume(),t.disableLogs||console.log("Resumed recording.")}function T(l){postMessage(new FileReaderSync().readAsDataURL(l))}function D(l,k){if(!l)throw"Pass a callback function over getDataURL.";var H=k?k.blob:(A||{}).blob;if(!H){t.disableLogs||console.warn("Blob encoder did not finish its job yet."),setTimeout(function(){D(l,k)},1e3);return}if(typeof Worker<"u"&&!navigator.mozGetUserMedia){var u=O(T);u.onmessage=function(P){l(P.data)},u.postMessage(H)}else{var b=new FileReader;b.readAsDataURL(H),b.onload=function(P){l(P.target.result)}}function O(P){try{var Q=q.createObjectURL(new Blob([P.toString(),"this.onmessage =  function (eee) {"+P.name+"(eee.data);}"],{type:"application/javascript"})),z=new Worker(Q);return q.revokeObjectURL(Q),z}catch{}}}function R(l){if(l=l||0,o.state==="paused"){setTimeout(function(){R(l)},1e3);return}if(o.state!=="stopped"){if(l>=o.recordingDuration){_(o.onRecordingStopped);return}l+=1e3,setTimeout(function(){R(l)},1e3)}}function M(l){!o||(o.state=l,typeof o.onStateChanged.call=="function"?o.onStateChanged.call(o,l):o.onStateChanged(l))}var S='It seems that recorder is destroyed or "startRecording" is not invoked for '+t.type+" recorder.";function x(){t.disableLogs!==!0&&console.warn(S)}var A,U={startRecording:m,stopRecording:_,pauseRecording:w,resumeRecording:d,initRecorder:g,setRecordingDuration:function(l,k){if(typeof l>"u")throw"recordingDuration is required.";if(typeof l!="number")throw"recordingDuration must be a number.";return o.recordingDuration=l,o.onRecordingStopped=k||function(){},{onRecordingStopped:function(H){o.onRecordingStopped=H}}},clearRecordedData:function(){if(!A){x();return}A.clearRecordedData(),t.disableLogs||console.log("Cleared old recorded data.")},getBlob:function(){if(!A){x();return}return A.blob},getDataURL:D,toURL:function(){if(!A){x();return}return q.createObjectURL(A.blob)},getInternalRecorder:function(){return A},save:function(l){if(!A){x();return}F(A.blob,l)},getFromDisk:function(l){if(!A){x();return}y.getFromDisk(t.type,l)},setAdvertisementArray:function(l){t.advertisement=[];for(var k=l.length,H=0;H<k;H++)t.advertisement.push({duration:H,image:l[H]})},blob:null,bufferSize:0,sampleRate:0,buffer:null,reset:function(){o.state==="recording"&&!t.disableLogs&&console.warn("Stop an active recorder."),A&&typeof A.clearRecordedData=="function"&&A.clearRecordedData(),A=null,M("inactive"),o.blob=null},onStateChanged:function(l){t.disableLogs||console.log("Recorder state changed:",l)},state:"inactive",getState:function(){return o.state},destroy:function(){var l=t.disableLogs;t={disableLogs:!0},o.reset(),M("destroyed"),U=o=null,ce.AudioContextConstructor&&(ce.AudioContextConstructor.close(),ce.AudioContextConstructor=null),t.disableLogs=l,t.disableLogs||console.log("RecordRTC is destroyed.")},version:"5.6.2"};if(!this)return o=U,U;for(var j in U)this[j]=U[j];return o=this,U}y.version="5.6.2",ee.exports=y,y.getFromDisk=function(a,t){if(!t)throw"callback is mandatory.";console.log("Getting recorded "+(a==="all"?"blobs":a+" blob ")+" from disk!"),Z.Fetch(function(o,m){a!=="all"&&m===a+"Blob"&&t&&t(o),a==="all"&&t&&t(o,m.replace("Blob",""))})},y.writeToDisk=function(a){console.log("Writing recorded blob(s) to disk!"),a=a||{},a.audio&&a.video&&a.gif?a.audio.getDataURL(function(t){a.video.getDataURL(function(o){a.gif.getDataURL(function(m){Z.Store({audioBlob:t,videoBlob:o,gifBlob:m})})})}):a.audio&&a.video?a.audio.getDataURL(function(t){a.video.getDataURL(function(o){Z.Store({audioBlob:t,videoBlob:o})})}):a.audio&&a.gif?a.audio.getDataURL(function(t){a.gif.getDataURL(function(o){Z.Store({audioBlob:t,gifBlob:o})})}):a.video&&a.gif?a.video.getDataURL(function(t){a.gif.getDataURL(function(o){Z.Store({videoBlob:t,gifBlob:o})})}):a.audio?a.audio.getDataURL(function(t){Z.Store({audioBlob:t})}):a.video?a.video.getDataURL(function(t){Z.Store({videoBlob:t})}):a.gif&&a.gif.getDataURL(function(t){Z.Store({gifBlob:t})})};/**
 * {@link RecordRTCConfiguration} is an inner/private helper for {@link RecordRTC}.
 * @summary It configures the 2nd parameter passed over {@link RecordRTC} and returns a valid "config" object.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef RecordRTCConfiguration
 * @class
 * @example
 * var options = RecordRTCConfiguration(mediaStream, options);
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @param {object} config - {type:"video", disableLogs: true, numberOfAudioChannels: 1, bufferSize: 0, sampleRate: 0, video: HTMLVideoElement, getNativeBlob:true, etc.}
 */function i(a,t){return!t.recorderType&&!t.type&&(!!t.audio&&!!t.video?t.type="video":!!t.audio&&!t.video&&(t.type="audio")),t.recorderType&&!t.type&&(t.recorderType===G||t.recorderType===E||typeof Oe<"u"&&t.recorderType===Oe?t.type="video":t.recorderType===ae?t.type="gif":t.recorderType===Ae?t.type="audio":t.recorderType===W&&(V(a,"audio").length&&V(a,"video").length||!V(a,"audio").length&&V(a,"video").length?t.type="video":V(a,"audio").length&&!V(a,"video").length&&(t.type="audio"))),typeof W<"u"&&typeof MediaRecorder<"u"&&"requestData"in MediaRecorder.prototype&&(t.mimeType||(t.mimeType="video/webm"),t.type||(t.type=t.mimeType.split("/")[0]),t.bitsPerSecond),t.type||(t.mimeType&&(t.type=t.mimeType.split("/")[0]),t.type||(t.type="audio")),t}/**
 * {@link GetRecorderType} is an inner/private helper for {@link RecordRTC}.
 * @summary It returns best recorder-type available for your browser.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef GetRecorderType
 * @class
 * @example
 * var RecorderType = GetRecorderType(options);
 * var recorder = new RecorderType(options);
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @param {object} config - {type:"video", disableLogs: true, numberOfAudioChannels: 1, bufferSize: 0, sampleRate: 0, video: HTMLVideoElement, etc.}
 */function p(a,t){var o;return(s||e||r)&&(o=Ae),typeof MediaRecorder<"u"&&"requestData"in MediaRecorder.prototype&&!s&&(o=W),t.type==="video"&&(s||r)&&(o=G,typeof Oe<"u"&&typeof ReadableStream<"u"&&(o=Oe)),t.type==="gif"&&(o=ae),t.type==="canvas"&&(o=E),pe()&&o!==E&&o!==ae&&typeof MediaRecorder<"u"&&"requestData"in MediaRecorder.prototype&&(V(a,"video").length||V(a,"audio").length)&&(t.type==="audio"?typeof MediaRecorder.isTypeSupported=="function"&&MediaRecorder.isTypeSupported("audio/webm")&&(o=W):typeof MediaRecorder.isTypeSupported=="function"&&MediaRecorder.isTypeSupported("video/webm")&&(o=W)),a instanceof Array&&a.length&&(o=Y),t.recorderType&&(o=t.recorderType),!t.disableLogs&&!!o&&!!o.name&&console.log("Using recorderType:",o.name||o.constructor.name),!o&&h&&(o=W),o}/**
 * MRecordRTC runs on top of {@link RecordRTC} to bring multiple recordings in a single place, by providing simple API.
 * @summary MRecordRTC stands for "Multiple-RecordRTC".
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef MRecordRTC
 * @class
 * @example
 * var recorder = new MRecordRTC();
 * recorder.addStream(MediaStream);
 * recorder.mediaType = {
 *     audio: true, // or StereoAudioRecorder or MediaStreamRecorder
 *     video: true, // or WhammyRecorder or MediaStreamRecorder or WebAssemblyRecorder or CanvasRecorder
 *     gif: true    // or GifRecorder
 * };
 * // mimeType is optional and should be set only in advance cases.
 * recorder.mimeType = {
 *     audio: 'audio/wav',
 *     video: 'video/webm',
 *     gif:   'image/gif'
 * };
 * recorder.startRecording();
 * @see For further information:
 * @see {@link https://github.com/muaz-khan/RecordRTC/tree/master/MRecordRTC|MRecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @requires {@link RecordRTC}
 */function c(a){this.addStream=function(t){t&&(a=t)},this.mediaType={audio:!0,video:!0},this.startRecording=function(){var t=this.mediaType,o,m=this.mimeType||{audio:null,video:null,gif:null};if(typeof t.audio!="function"&&pe()&&!V(a,"audio").length&&(t.audio=!1),typeof t.video!="function"&&pe()&&!V(a,"video").length&&(t.video=!1),typeof t.gif!="function"&&pe()&&!V(a,"video").length&&(t.gif=!1),!t.audio&&!t.video&&!t.gif)throw"MediaStream must have either audio or video tracks.";if(t.audio&&(o=null,typeof t.audio=="function"&&(o=t.audio),this.audioRecorder=new y(a,{type:"audio",bufferSize:this.bufferSize,sampleRate:this.sampleRate,numberOfAudioChannels:this.numberOfAudioChannels||2,disableLogs:this.disableLogs,recorderType:o,mimeType:m.audio,timeSlice:this.timeSlice,onTimeStamp:this.onTimeStamp}),t.video||this.audioRecorder.startRecording()),t.video){o=null,typeof t.video=="function"&&(o=t.video);var g=a;if(pe()&&!!t.audio&&typeof t.audio=="function"){var _=V(a,"video")[0];n?(g=new v,g.addTrack(_),o&&o===G&&(o=W)):(g=new v,g.addTrack(_))}this.videoRecorder=new y(g,{type:"video",video:this.video,canvas:this.canvas,frameInterval:this.frameInterval||10,disableLogs:this.disableLogs,recorderType:o,mimeType:m.video,timeSlice:this.timeSlice,onTimeStamp:this.onTimeStamp,workerPath:this.workerPath,webAssemblyPath:this.webAssemblyPath,frameRate:this.frameRate,bitrate:this.bitrate}),t.audio||this.videoRecorder.startRecording()}if(!!t.audio&&!!t.video){var w=this,d=pe()===!0;(t.audio instanceof Ae&&!!t.video||t.audio!==!0&&t.video!==!0&&t.audio!==t.video)&&(d=!1),d===!0?(w.audioRecorder=null,w.videoRecorder.startRecording()):w.videoRecorder.initRecorder(function(){w.audioRecorder.initRecorder(function(){w.videoRecorder.startRecording(),w.audioRecorder.startRecording()})})}t.gif&&(o=null,typeof t.gif=="function"&&(o=t.gif),this.gifRecorder=new y(a,{type:"gif",frameRate:this.frameRate||200,quality:this.quality||10,disableLogs:this.disableLogs,recorderType:o,mimeType:m.gif}),this.gifRecorder.startRecording())},this.stopRecording=function(t){t=t||function(){},this.audioRecorder&&this.audioRecorder.stopRecording(function(o){t(o,"audio")}),this.videoRecorder&&this.videoRecorder.stopRecording(function(o){t(o,"video")}),this.gifRecorder&&this.gifRecorder.stopRecording(function(o){t(o,"gif")})},this.pauseRecording=function(){this.audioRecorder&&this.audioRecorder.pauseRecording(),this.videoRecorder&&this.videoRecorder.pauseRecording(),this.gifRecorder&&this.gifRecorder.pauseRecording()},this.resumeRecording=function(){this.audioRecorder&&this.audioRecorder.resumeRecording(),this.videoRecorder&&this.videoRecorder.resumeRecording(),this.gifRecorder&&this.gifRecorder.resumeRecording()},this.getBlob=function(t){var o={};return this.audioRecorder&&(o.audio=this.audioRecorder.getBlob()),this.videoRecorder&&(o.video=this.videoRecorder.getBlob()),this.gifRecorder&&(o.gif=this.gifRecorder.getBlob()),t&&t(o),o},this.destroy=function(){this.audioRecorder&&(this.audioRecorder.destroy(),this.audioRecorder=null),this.videoRecorder&&(this.videoRecorder.destroy(),this.videoRecorder=null),this.gifRecorder&&(this.gifRecorder.destroy(),this.gifRecorder=null)},this.getDataURL=function(t){this.getBlob(function(g){g.audio&&g.video?o(g.audio,function(_){o(g.video,function(w){t({audio:_,video:w})})}):g.audio?o(g.audio,function(_){t({audio:_})}):g.video&&o(g.video,function(_){t({video:_})})});function o(g,_){if(typeof Worker<"u"){var w=m(function(D){postMessage(new FileReaderSync().readAsDataURL(D))});w.onmessage=function(T){_(T.data)},w.postMessage(g)}else{var d=new FileReader;d.readAsDataURL(g),d.onload=function(T){_(T.target.result)}}}function m(g){var _=q.createObjectURL(new Blob([g.toString(),"this.onmessage =  function (eee) {"+g.name+"(eee.data);}"],{type:"application/javascript"})),w=new Worker(_),d;if(typeof q<"u")d=q;else if(typeof webkitURL<"u")d=webkitURL;else throw"Neither URL nor webkitURL detected.";return d.revokeObjectURL(_),w}},this.writeToDisk=function(){y.writeToDisk({audio:this.audioRecorder,video:this.videoRecorder,gif:this.gifRecorder})},this.save=function(t){t=t||{audio:!0,video:!0,gif:!0},!!t.audio&&this.audioRecorder&&this.audioRecorder.save(typeof t.audio=="string"?t.audio:""),!!t.video&&this.videoRecorder&&this.videoRecorder.save(typeof t.video=="string"?t.video:""),!!t.gif&&this.gifRecorder&&this.gifRecorder.save(typeof t.gif=="string"?t.gif:"")}}c.getFromDisk=y.getFromDisk,c.writeToDisk=y.writeToDisk,typeof y<"u"&&(y.MRecordRTC=c);var C="Fake/5.0 (FakeOS) AppleWebKit/123 (KHTML, like Gecko) Fake/12.3.4567.89 Fake/123.45";(function(a){!a||typeof window<"u"||typeof J>"u"||(J.navigator={userAgent:C,getUserMedia:function(){}},J.console||(J.console={}),(typeof J.console.log>"u"||typeof J.console.error>"u")&&(J.console.error=J.console.log=J.console.log||function(){console.log(arguments)}),typeof document>"u"&&(a.document={documentElement:{appendChild:function(){return""}}},document.createElement=document.captureStream=document.mozCaptureStream=function(){var t={getContext:function(){return t},play:function(){},pause:function(){},drawImage:function(){},toDataURL:function(){return""},style:{}};return t},a.HTMLVideoElement=function(){}),typeof location>"u"&&(a.location={protocol:"file:",href:"",hash:""}),typeof screen>"u"&&(a.screen={width:0,height:0}),typeof q>"u"&&(a.URL={createObjectURL:function(){return""},revokeObjectURL:function(){return""}}),a.window=J)})(typeof J<"u"?J:null);var B=window.requestAnimationFrame;if(typeof B>"u"){if(typeof webkitRequestAnimationFrame<"u")B=webkitRequestAnimationFrame;else if(typeof mozRequestAnimationFrame<"u")B=mozRequestAnimationFrame;else if(typeof msRequestAnimationFrame<"u")B=msRequestAnimationFrame;else if(typeof B>"u"){var N=0;B=function(a,t){var o=new Date().getTime(),m=Math.max(0,16-(o-N)),g=setTimeout(function(){a(o+m)},m);return N=o+m,g}}}var I=window.cancelAnimationFrame;typeof I>"u"&&(typeof webkitCancelAnimationFrame<"u"?I=webkitCancelAnimationFrame:typeof mozCancelAnimationFrame<"u"?I=mozCancelAnimationFrame:typeof msCancelAnimationFrame<"u"?I=msCancelAnimationFrame:typeof I>"u"&&(I=function(a){clearTimeout(a)}));var L=window.AudioContext;typeof L>"u"&&(typeof webkitAudioContext<"u"&&(L=webkitAudioContext),typeof mozAudioContext<"u"&&(L=mozAudioContext));var q=window.URL;typeof q>"u"&&typeof webkitURL<"u"&&(q=webkitURL),typeof navigator<"u"&&typeof navigator.getUserMedia>"u"&&(typeof navigator.webkitGetUserMedia<"u"&&(navigator.getUserMedia=navigator.webkitGetUserMedia),typeof navigator.mozGetUserMedia<"u"&&(navigator.getUserMedia=navigator.mozGetUserMedia));var e=navigator.userAgent.indexOf("Edge")!==-1&&(!!navigator.msSaveBlob||!!navigator.msSaveOrOpenBlob),r=!!window.opera||navigator.userAgent.indexOf("OPR/")!==-1,n=navigator.userAgent.toLowerCase().indexOf("firefox")>-1&&"netscape"in window&&/ rv:/.test(navigator.userAgent),s=!r&&!e&&!!navigator.webkitGetUserMedia||$()||navigator.userAgent.toLowerCase().indexOf("chrome/")!==-1,h=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);h&&!s&&navigator.userAgent.indexOf("CriOS")!==-1&&(h=!1,s=!0);var v=window.MediaStream;typeof v>"u"&&typeof webkitMediaStream<"u"&&(v=webkitMediaStream),typeof v<"u"&&typeof v.prototype.stop>"u"&&(v.prototype.stop=function(){this.getTracks().forEach(function(a){a.stop()})});function f(a){var t=1e3,o=["Bytes","KB","MB","GB","TB"];if(a===0)return"0 Bytes";var m=parseInt(Math.floor(Math.log(a)/Math.log(t)),10);return(a/Math.pow(t,m)).toPrecision(3)+" "+o[m]}function F(a,t){if(!a)throw"Blob object is required.";if(!a.type)try{a.type="video/webm"}catch{}var o=(a.type||"video/webm").split("/")[1];if(o.indexOf(";")!==-1&&(o=o.split(";")[0]),t&&t.indexOf(".")!==-1){var m=t.split(".");t=m[0],o=m[1]}var g=(t||Math.round(Math.random()*9999999999)+888888888)+"."+o;if(typeof navigator.msSaveOrOpenBlob<"u")return navigator.msSaveOrOpenBlob(a,g);if(typeof navigator.msSaveBlob<"u")return navigator.msSaveBlob(a,g);var _=document.createElement("a");_.href=q.createObjectURL(a),_.download=g,_.style="display:none;opacity:0;color:transparent;",(document.body||document.documentElement).appendChild(_),typeof _.click=="function"?_.click():(_.target="_blank",_.dispatchEvent(new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0}))),q.revokeObjectURL(_.href)}function $(){return typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&!!process.versions.electron||typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent.indexOf("Electron")>=0}function V(a,t){return!a||!a.getTracks?[]:a.getTracks().filter(function(o){return o.kind===(t||"audio")})}function fe(a,t){"srcObject"in t?t.srcObject=a:"mozSrcObject"in t?t.mozSrcObject=a:t.srcObject=a}function ge(a,t){if(typeof EBML>"u")throw new Error("Please link: https://www.webrtc-experiment.com/EBML.js");var o=new EBML.Reader,m=new EBML.Decoder,g=EBML.tools,_=new FileReader;_.onload=function(w){var d=m.decode(this.result);d.forEach(function(M){o.read(M)}),o.stop();var T=g.makeMetadataSeekable(o.metadatas,o.duration,o.cues),D=this.result.slice(o.metadataSize),R=new Blob([T,D],{type:"video/webm"});t(R)},_.readAsArrayBuffer(a)}typeof y<"u"&&(y.invokeSaveAsDialog=F,y.getTracks=V,y.getSeekableBlob=ge,y.bytesToSize=f,y.isElectron=$);/**
 * Storage is a standalone object used by {@link RecordRTC} to store reusable objects e.g. "new AudioContext".
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @example
 * Storage.AudioContext === webkitAudioContext
 * @property {webkitAudioContext} AudioContext - Keeps a reference to AudioContext object.
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 */var ce={};typeof L<"u"?ce.AudioContext=L:typeof webkitAudioContext<"u"&&(ce.AudioContext=webkitAudioContext),typeof y<"u"&&(y.Storage=ce);function pe(){if(n||h||e)return!0;var a=navigator.userAgent,t=""+parseFloat(navigator.appVersion),o=parseInt(navigator.appVersion,10),m,g;return(s||r)&&(m=a.indexOf("Chrome"),t=a.substring(m+7)),(g=t.indexOf(";"))!==-1&&(t=t.substring(0,g)),(g=t.indexOf(" "))!==-1&&(t=t.substring(0,g)),o=parseInt(""+t,10),isNaN(o)&&(t=""+parseFloat(navigator.appVersion),o=parseInt(navigator.appVersion,10)),o>=49}/**
 * MediaStreamRecorder is an abstraction layer for {@link https://w3c.github.io/mediacapture-record/MediaRecorder.html|MediaRecorder API}. It is used by {@link RecordRTC} to record MediaStream(s) in both Chrome and Firefox.
 * @summary Runs top over {@link https://w3c.github.io/mediacapture-record/MediaRecorder.html|MediaRecorder API}.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://github.com/muaz-khan|Muaz Khan}
 * @typedef MediaStreamRecorder
 * @class
 * @example
 * var config = {
 *     mimeType: 'video/webm', // vp8, vp9, h264, mkv, opus/vorbis
 *     audioBitsPerSecond : 256 * 8 * 1024,
 *     videoBitsPerSecond : 256 * 8 * 1024,
 *     bitsPerSecond: 256 * 8 * 1024,  // if this is provided, skip above two
 *     checkForInactiveTracks: true,
 *     timeSlice: 1000, // concatenate intervals based blobs
 *     ondataavailable: function() {} // get intervals based blobs
 * }
 * var recorder = new MediaStreamRecorder(mediaStream, config);
 * recorder.record();
 * recorder.stop(function(blob) {
 *     video.src = URL.createObjectURL(blob);
 *
 *     // or
 *     var blob = recorder.blob;
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @param {object} config - {disableLogs:true, initCallback: function, mimeType: "video/webm", timeSlice: 1000}
 * @throws Will throw an error if first argument "MediaStream" is missing. Also throws error if "MediaRecorder API" are not supported by the browser.
 */function W(a,t){var R=this;if(typeof a>"u")throw'First argument "MediaStream" is required.';if(typeof MediaRecorder>"u")throw"Your browser does not support the Media Recorder API. Please try other modules e.g. WhammyRecorder or StereoAudioRecorder.";if(t=t||{mimeType:"video/webm"},t.type==="audio"){if(V(a,"video").length&&V(a,"audio").length){var o;navigator.mozGetUserMedia?(o=new v,o.addTrack(V(a,"audio")[0])):o=new v(V(a,"audio")),a=o}(!t.mimeType||t.mimeType.toString().toLowerCase().indexOf("audio")===-1)&&(t.mimeType=s?"audio/webm":"audio/ogg"),t.mimeType&&t.mimeType.toString().toLowerCase()!=="audio/ogg"&&!!navigator.mozGetUserMedia&&(t.mimeType="audio/ogg")}var m=[];this.getArrayOfBlobs=function(){return m},this.record=function(){R.blob=null,R.clearRecordedData(),R.timestamps=[],D=[],m=[];var M=t;t.disableLogs||console.log("Passing following config over MediaRecorder API.",M),d&&(d=null),s&&!pe()&&(M="video/vp8"),typeof MediaRecorder.isTypeSupported=="function"&&M.mimeType&&(MediaRecorder.isTypeSupported(M.mimeType)||(t.disableLogs||console.warn("MediaRecorder API seems unable to record mimeType:",M.mimeType),M.mimeType=t.type==="audio"?"audio/webm":"video/webm"));try{d=new MediaRecorder(a,M),t.mimeType=M.mimeType}catch{d=new MediaRecorder(a)}M.mimeType&&!MediaRecorder.isTypeSupported&&"canRecordMimeType"in d&&d.canRecordMimeType(M.mimeType)===!1&&(t.disableLogs||console.warn("MediaRecorder API seems unable to record mimeType:",M.mimeType)),d.ondataavailable=function(S){if(S.data&&D.push("ondataavailable: "+f(S.data.size)),typeof t.timeSlice=="number"){if(S.data&&S.data.size&&(m.push(S.data),g(),typeof t.ondataavailable=="function")){var x=t.getNativeBlob?S.data:new Blob([S.data],{type:_(M)});t.ondataavailable(x)}return}if(!S.data||!S.data.size||S.data.size<100||R.blob){R.recordingCallback&&(R.recordingCallback(new Blob([],{type:_(M)})),R.recordingCallback=null);return}R.blob=t.getNativeBlob?S.data:new Blob([S.data],{type:_(M)}),R.recordingCallback&&(R.recordingCallback(R.blob),R.recordingCallback=null)},d.onstart=function(){D.push("started")},d.onpause=function(){D.push("paused")},d.onresume=function(){D.push("resumed")},d.onstop=function(){D.push("stopped")},d.onerror=function(S){!S||(S.name||(S.name="UnknownError"),D.push("error: "+S),t.disableLogs||(S.name.toString().toLowerCase().indexOf("invalidstate")!==-1?console.error("The MediaRecorder is not in a state in which the proposed operation is allowed to be executed.",S):S.name.toString().toLowerCase().indexOf("notsupported")!==-1?console.error("MIME type (",M.mimeType,") is not supported.",S):S.name.toString().toLowerCase().indexOf("security")!==-1?console.error("MediaRecorder security error",S):S.name==="OutOfMemory"?console.error("The UA has exhaused the available memory. User agents SHOULD provide as much additional information as possible in the message attribute.",S):S.name==="IllegalStreamModification"?console.error("A modification to the stream has occurred that makes it impossible to continue recording. An example would be the addition of a Track while recording is occurring. User agents SHOULD provide as much additional information as possible in the message attribute.",S):S.name==="OtherRecordingError"?console.error("Used for an fatal error other than those listed above. User agents SHOULD provide as much additional information as possible in the message attribute.",S):S.name==="GenericError"?console.error("The UA cannot provide the codec or recording option that has been requested.",S):console.error("MediaRecorder Error",S)),function(x){if(!R.manuallyStopped&&d&&d.state==="inactive"){delete t.timeslice,d.start(10*60*1e3);return}setTimeout(x,1e3)}(),d.state!=="inactive"&&d.state!=="stopped"&&d.stop())},typeof t.timeSlice=="number"?(g(),d.start(t.timeSlice)):d.start(36e5),t.initCallback&&t.initCallback()},this.timestamps=[];function g(){R.timestamps.push(new Date().getTime()),typeof t.onTimeStamp=="function"&&t.onTimeStamp(R.timestamps[R.timestamps.length-1],R.timestamps)}function _(M){return d&&d.mimeType?d.mimeType:M.mimeType||"video/webm"}this.stop=function(M){M=M||function(){},R.manuallyStopped=!0,d&&(this.recordingCallback=M,d.state==="recording"&&d.stop(),typeof t.timeSlice=="number"&&setTimeout(function(){R.blob=new Blob(m,{type:_(t)}),R.recordingCallback(R.blob)},100))},this.pause=function(){!d||d.state==="recording"&&d.pause()},this.resume=function(){!d||d.state==="paused"&&d.resume()},this.clearRecordedData=function(){d&&d.state==="recording"&&R.stop(w),w()};function w(){m=[],d=null,R.timestamps=[]}var d;this.getInternalRecorder=function(){return d};function T(){if("active"in a){if(!a.active)return!1}else if("ended"in a&&a.ended)return!1;return!0}this.blob=null,this.getState=function(){return d&&d.state||"inactive"};var D=[];this.getAllStates=function(){return D},typeof t.checkForInactiveTracks>"u"&&(t.checkForInactiveTracks=!1);var R=this;(function M(){if(!(!d||t.checkForInactiveTracks===!1)){if(T()===!1){t.disableLogs||console.log("MediaStream seems stopped."),R.stop();return}setTimeout(M,1e3)}})(),this.name="MediaStreamRecorder",this.toString=function(){return this.name}}typeof y<"u"&&(y.MediaStreamRecorder=W);/**
 * StereoAudioRecorder is a standalone class used by {@link RecordRTC} to bring "stereo" audio-recording in chrome.
 * @summary JavaScript standalone object for stereo audio recording.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef StereoAudioRecorder
 * @class
 * @example
 * var recorder = new StereoAudioRecorder(MediaStream, {
 *     sampleRate: 44100,
 *     bufferSize: 4096
 * });
 * recorder.record();
 * recorder.stop(function(blob) {
 *     video.src = URL.createObjectURL(blob);
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @param {object} config - {sampleRate: 44100, bufferSize: 4096, numberOfAudioChannels: 1, etc.}
 */function Ae(a,t){if(!V(a,"audio").length)throw"Your stream has no audio tracks.";t=t||{};var o=this,m=[],g=[],_=!1,w=0,d,T=2,D=t.desiredSampRate;t.leftChannel===!0&&(T=1),t.numberOfAudioChannels===1&&(T=1),(!T||T<1)&&(T=2),t.disableLogs||console.log("StereoAudioRecorder is set to record number of channels: "+T),typeof t.checkForInactiveTracks>"u"&&(t.checkForInactiveTracks=!0);function R(){if(t.checkForInactiveTracks===!1)return!0;if("active"in a){if(!a.active)return!1}else if("ended"in a&&a.ended)return!1;return!0}this.record=function(){if(R()===!1)throw"Please make sure MediaStream is active.";H(),b=k=!1,_=!0,typeof t.timeSlice<"u"&&Q()};function M(z,de){function ne(ie,Ie){var ye=ie.numberOfAudioChannels,le=ie.leftBuffers.slice(0),Le=ie.rightBuffers.slice(0),be=ie.sampleRate,Re=ie.internalInterleavedLength,he=ie.desiredSampRate;ye===2&&(le=$e(le,Re),Le=$e(Le,Re),he&&(le=Me(le,he,be),Le=Me(Le,he,be))),ye===1&&(le=$e(le,Re),he&&(le=Me(le,he,be))),he&&(be=he);function Me(oe,we,me){var _e=Math.round(oe.length*(we/me)),ue=[],Te=Number((oe.length-1)/(_e-1));ue[0]=oe[0];for(var De=1;De<_e-1;De++){var Ye=De*Te,et=Number(Math.floor(Ye)).toFixed(),_t=Number(Math.ceil(Ye)).toFixed(),vt=Ye-et;ue[De]=qe(oe[et],oe[_t],vt)}return ue[_e-1]=oe[oe.length-1],ue}function qe(oe,we,me){return oe+(we-oe)*me}function $e(oe,we){for(var me=new Float64Array(we),_e=0,ue=oe.length,Te=0;Te<ue;Te++){var De=oe[Te];me.set(De,_e),_e+=De.length}return me}function ct(oe,we){for(var me=oe.length+we.length,_e=new Float64Array(me),ue=0,Te=0;Te<me;)_e[Te++]=oe[ue],_e[Te++]=we[ue],ue++;return _e}function He(oe,we,me){for(var _e=me.length,ue=0;ue<_e;ue++)oe.setUint8(we+ue,me.charCodeAt(ue))}var Ge;ye===2&&(Ge=ct(le,Le)),ye===1&&(Ge=le);var Ve=Ge.length,pt=44+Ve*2,ze=new ArrayBuffer(pt),se=new DataView(ze);He(se,0,"RIFF"),se.setUint32(4,36+Ve*2,!0),He(se,8,"WAVE"),He(se,12,"fmt "),se.setUint32(16,16,!0),se.setUint16(20,1,!0),se.setUint16(22,ye,!0),se.setUint32(24,be,!0),se.setUint32(28,be*ye*2,!0),se.setUint16(32,ye*2,!0),se.setUint16(34,16,!0),He(se,36,"data"),se.setUint32(40,Ve*2,!0);for(var ht=Ve,Je=44,mt=1,Xe=0;Xe<ht;Xe++)se.setInt16(Je,Ge[Xe]*(32767*mt),!0),Je+=2;if(Ie)return Ie({buffer:ze,view:se});postMessage({buffer:ze,view:se})}if(z.noWorker){ne(z,function(ie){de(ie.buffer,ie.view)});return}var Ce=S(ne);Ce.onmessage=function(ie){de(ie.data.buffer,ie.data.view),q.revokeObjectURL(Ce.workerURL),Ce.terminate()},Ce.postMessage(z)}function S(z){var de=q.createObjectURL(new Blob([z.toString(),";this.onmessage =  function (eee) {"+z.name+"(eee.data);}"],{type:"application/javascript"})),ne=new Worker(de);return ne.workerURL=de,ne}this.stop=function(z){z=z||function(){},_=!1,M({desiredSampRate:D,sampleRate:l,numberOfAudioChannels:T,internalInterleavedLength:w,leftBuffers:m,rightBuffers:T===1?[]:g,noWorker:t.noWorker},function(de,ne){o.blob=new Blob([ne],{type:"audio/wav"}),o.buffer=new ArrayBuffer(ne.buffer.byteLength),o.view=ne,o.sampleRate=D||l,o.bufferSize=j,o.length=w,b=!1,z&&z(o.blob)})},typeof y.Storage>"u"&&(y.Storage={AudioContextConstructor:null,AudioContext:window.AudioContext||window.webkitAudioContext}),(!y.Storage.AudioContextConstructor||y.Storage.AudioContextConstructor.state==="closed")&&(y.Storage.AudioContextConstructor=new y.Storage.AudioContext);var x=y.Storage.AudioContextConstructor,A=x.createMediaStreamSource(a),U=[0,256,512,1024,2048,4096,8192,16384],j=typeof t.bufferSize>"u"?4096:t.bufferSize;if(U.indexOf(j)===-1&&(t.disableLogs||console.log("Legal values for buffer-size are "+JSON.stringify(U,null,"	"))),x.createJavaScriptNode)d=x.createJavaScriptNode(j,T,T);else if(x.createScriptProcessor)d=x.createScriptProcessor(j,T,T);else throw"WebAudio API has no support on this browser.";A.connect(d),t.bufferSize||(j=d.bufferSize);var l=typeof t.sampleRate<"u"?t.sampleRate:x.sampleRate||44100;(l<22050||l>96e3)&&(t.disableLogs||console.log("sample-rate must be under range 22050 and 96000.")),t.disableLogs||t.desiredSampRate&&console.log("Desired sample-rate: "+t.desiredSampRate);var k=!1;this.pause=function(){k=!0},this.resume=function(){if(R()===!1)throw"Please make sure MediaStream is active.";if(!_){t.disableLogs||console.log("Seems recording has been restarted."),this.record();return}k=!1},this.clearRecordedData=function(){t.checkForInactiveTracks=!1,_&&this.stop(u),u()};function H(){m=[],g=[],w=0,b=!1,_=!1,k=!1,x=null,o.leftchannel=m,o.rightchannel=g,o.numberOfAudioChannels=T,o.desiredSampRate=D,o.sampleRate=l,o.recordingLength=w,P={left:[],right:[],recordingLength:0}}function u(){d&&(d.onaudioprocess=null,d.disconnect(),d=null),A&&(A.disconnect(),A=null),H()}this.name="StereoAudioRecorder",this.toString=function(){return this.name};var b=!1;function O(z){if(!k){if(R()===!1&&(t.disableLogs||console.log("MediaStream seems stopped."),d.disconnect(),_=!1),!_){A&&(A.disconnect(),A=null);return}b||(b=!0,t.onAudioProcessStarted&&t.onAudioProcessStarted(),t.initCallback&&t.initCallback());var de=z.inputBuffer.getChannelData(0),ne=new Float32Array(de);if(m.push(ne),T===2){var Ce=z.inputBuffer.getChannelData(1),ie=new Float32Array(Ce);g.push(ie)}w+=j,o.recordingLength=w,typeof t.timeSlice<"u"&&(P.recordingLength+=j,P.left.push(ne),T===2&&P.right.push(ie))}}d.onaudioprocess=O,x.createMediaStreamDestination?d.connect(x.createMediaStreamDestination()):d.connect(x.destination),this.leftchannel=m,this.rightchannel=g,this.numberOfAudioChannels=T,this.desiredSampRate=D,this.sampleRate=l,o.recordingLength=w;var P={left:[],right:[],recordingLength:0};function Q(){!_||typeof t.ondataavailable!="function"||typeof t.timeSlice>"u"||(P.left.length?(M({desiredSampRate:D,sampleRate:l,numberOfAudioChannels:T,internalInterleavedLength:P.recordingLength,leftBuffers:P.left,rightBuffers:T===1?[]:P.right},function(z,de){var ne=new Blob([de],{type:"audio/wav"});t.ondataavailable(ne),setTimeout(Q,t.timeSlice)}),P={left:[],right:[],recordingLength:0}):setTimeout(Q,t.timeSlice))}}typeof y<"u"&&(y.StereoAudioRecorder=Ae);/**
 * CanvasRecorder is a standalone class used by {@link RecordRTC} to bring HTML5-Canvas recording into video WebM. It uses HTML2Canvas library and runs top over {@link Whammy}.
 * @summary HTML2Canvas recording into video WebM.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef CanvasRecorder
 * @class
 * @example
 * var recorder = new CanvasRecorder(htmlElement, { disableLogs: true, useWhammyRecorder: true });
 * recorder.record();
 * recorder.stop(function(blob) {
 *     video.src = URL.createObjectURL(blob);
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {HTMLElement} htmlElement - querySelector/getElementById/getElementsByTagName[0]/etc.
 * @param {object} config - {disableLogs:true, initCallback: function}
 */function E(a,t){if(typeof html2canvas>"u")throw"Please link: https://www.webrtc-experiment.com/screenshot.js";t=t||{},t.frameInterval||(t.frameInterval=10);var o=!1;["captureStream","mozCaptureStream","webkitCaptureStream"].forEach(function(U){U in document.createElement("canvas")&&(o=!0)});var m=(!!window.webkitRTCPeerConnection||!!window.webkitGetUserMedia)&&!!window.chrome,g=50,_=navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./);m&&_&&_[2]&&(g=parseInt(_[2],10)),m&&g<52&&(o=!1),t.useWhammyRecorder&&(o=!1);var w,d;if(o)if(t.disableLogs||console.log("Your browser supports both MediRecorder API and canvas.captureStream!"),a instanceof HTMLCanvasElement)w=a;else if(a instanceof CanvasRenderingContext2D)w=a.canvas;else throw"Please pass either HTMLCanvasElement or CanvasRenderingContext2D.";else navigator.mozGetUserMedia&&(t.disableLogs||console.error("Canvas recording is NOT supported in Firefox."));var T;this.record=function(){if(T=!0,o&&!t.useWhammyRecorder){var U;"captureStream"in w?U=w.captureStream(25):"mozCaptureStream"in w?U=w.mozCaptureStream(25):"webkitCaptureStream"in w&&(U=w.webkitCaptureStream(25));try{var j=new v;j.addTrack(V(U,"video")[0]),U=j}catch{}if(!U)throw"captureStream API are NOT available.";d=new W(U,{mimeType:t.mimeType||"video/webm"}),d.record()}else A.frames=[],x=new Date().getTime(),S();t.initCallback&&t.initCallback()},this.getWebPImages=function(U){if(a.nodeName.toLowerCase()!=="canvas"){U();return}var j=A.frames.length;A.frames.forEach(function(l,k){var H=j-k;t.disableLogs||console.log(H+"/"+j+" frames remaining"),t.onEncodingCallback&&t.onEncodingCallback(H,j);var u=l.image.toDataURL("image/webp",1);A.frames[k].image=u}),t.disableLogs||console.log("Generating WebM"),U()},this.stop=function(U){T=!1;var j=this;if(o&&d){d.stop(U);return}this.getWebPImages(function(){A.compile(function(l){t.disableLogs||console.log("Recording finished!"),j.blob=l,j.blob.forEach&&(j.blob=new Blob([],{type:"video/webm"})),U&&U(j.blob),A.frames=[]})})};var D=!1;this.pause=function(){if(D=!0,d instanceof W){d.pause();return}},this.resume=function(){if(D=!1,d instanceof W){d.resume();return}T||this.record()},this.clearRecordedData=function(){T&&this.stop(R),R()};function R(){A.frames=[],T=!1,D=!1}this.name="CanvasRecorder",this.toString=function(){return this.name};function M(){var U=document.createElement("canvas"),j=U.getContext("2d");return U.width=a.width,U.height=a.height,j.drawImage(a,0,0),U}function S(){if(D)return x=new Date().getTime(),setTimeout(S,500);if(a.nodeName.toLowerCase()==="canvas"){var U=new Date().getTime()-x;x=new Date().getTime(),A.frames.push({image:M(),duration:U}),T&&setTimeout(S,t.frameInterval);return}html2canvas(a,{grabMouse:typeof t.showMousePointer>"u"||t.showMousePointer,onrendered:function(j){var l=new Date().getTime()-x;if(!l)return setTimeout(S,t.frameInterval);x=new Date().getTime(),A.frames.push({image:j.toDataURL("image/webp",1),duration:l}),T&&setTimeout(S,t.frameInterval)}})}var x=new Date().getTime(),A=new X.Video(100)}typeof y<"u"&&(y.CanvasRecorder=E);/**
 * WhammyRecorder is a standalone class used by {@link RecordRTC} to bring video recording in Chrome. It runs top over {@link Whammy}.
 * @summary Video recording feature in Chrome.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef WhammyRecorder
 * @class
 * @example
 * var recorder = new WhammyRecorder(mediaStream);
 * recorder.record();
 * recorder.stop(function(blob) {
 *     video.src = URL.createObjectURL(blob);
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @param {object} config - {disableLogs: true, initCallback: function, video: HTMLVideoElement, etc.}
 */function G(a,t){t=t||{},t.frameInterval||(t.frameInterval=10),t.disableLogs||console.log("Using frames-interval:",t.frameInterval),this.record=function(){t.width||(t.width=320),t.height||(t.height=240),t.video||(t.video={width:t.width,height:t.height}),t.canvas||(t.canvas={width:t.width,height:t.height}),T.width=t.canvas.width||320,T.height=t.canvas.height||240,D=T.getContext("2d"),t.video&&t.video instanceof HTMLVideoElement?(R=t.video.cloneNode(),t.initCallback&&t.initCallback()):(R=document.createElement("video"),fe(a,R),R.onloadedmetadata=function(){t.initCallback&&t.initCallback()},R.width=t.video.width,R.height=t.video.height),R.muted=!0,R.play(),M=new Date().getTime(),S=new X.Video,t.disableLogs||(console.log("canvas resolutions",T.width,"*",T.height),console.log("video width/height",R.width||T.width,"*",R.height||T.height)),o(t.frameInterval)};function o(x){x=typeof x<"u"?x:10;var A=new Date().getTime()-M;if(!A)return setTimeout(o,x,x);if(w)return M=new Date().getTime(),setTimeout(o,100);M=new Date().getTime(),R.paused&&R.play(),D.drawImage(R,0,0,T.width,T.height),S.frames.push({duration:A,image:T.toDataURL("image/webp")}),_||setTimeout(o,x,x)}function m(x){var A=-1,U=x.length;(function j(){if(A++,A===U){x.callback();return}setTimeout(function(){x.functionToLoop(j,A)},1)})()}function g(x,A,U,j,l){var k=document.createElement("canvas");k.width=T.width,k.height=T.height;var H=k.getContext("2d"),u=[],b=A===-1,O=A&&A>0&&A<=x.length?A:x.length,P={r:0,g:0,b:0},Q=Math.sqrt(Math.pow(255,2)+Math.pow(255,2)+Math.pow(255,2)),z=U&&U>=0&&U<=1?U:0,de=j&&j>=0&&j<=1?j:0,ne=!1;m({length:O,functionToLoop:function(Ce,ie){var Ie,ye,le,Le=function(){!ne&&le-Ie<=le*de||(b&&(ne=!0),u.push(x[ie])),Ce()};if(ne)Le();else{var be=new Image;be.onload=function(){H.drawImage(be,0,0,T.width,T.height);var Re=H.getImageData(0,0,T.width,T.height);Ie=0,ye=Re.data.length,le=Re.data.length/4;for(var he=0;he<ye;he+=4){var Me={r:Re.data[he],g:Re.data[he+1],b:Re.data[he+2]},qe=Math.sqrt(Math.pow(Me.r-P.r,2)+Math.pow(Me.g-P.g,2)+Math.pow(Me.b-P.b,2));qe<=Q*z&&Ie++}Le()},be.src=x[ie].image}},callback:function(){u=u.concat(x.slice(O)),u.length<=0&&u.push(x[x.length-1]),l(u)}})}var _=!1;this.stop=function(x){x=x||function(){},_=!0;var A=this;setTimeout(function(){g(S.frames,-1,null,null,function(U){S.frames=U,t.advertisement&&t.advertisement.length&&(S.frames=t.advertisement.concat(S.frames)),S.compile(function(j){A.blob=j,A.blob.forEach&&(A.blob=new Blob([],{type:"video/webm"})),x&&x(A.blob)})})},10)};var w=!1;this.pause=function(){w=!0},this.resume=function(){w=!1,_&&this.record()},this.clearRecordedData=function(){_||this.stop(d),d()};function d(){S.frames=[],_=!0,w=!1}this.name="WhammyRecorder",this.toString=function(){return this.name};var T=document.createElement("canvas"),D=T.getContext("2d"),R,M,S}typeof y<"u"&&(y.WhammyRecorder=G);/**
 * Whammy is a standalone class used by {@link RecordRTC} to bring video recording in Chrome. It is written by {@link https://github.com/antimatter15|antimatter15}
 * @summary A real time javascript webm encoder based on a canvas hack.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef Whammy
 * @class
 * @example
 * var recorder = new Whammy().Video(15);
 * recorder.add(context || canvas || dataURL);
 * var output = recorder.compile();
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 */var X=function(){function a(m){this.frames=[],this.duration=m||1,this.quality=.8}a.prototype.add=function(m,g){if("canvas"in m&&(m=m.canvas),"toDataURL"in m&&(m=m.toDataURL("image/webp",this.quality)),!/^data:image\/webp;base64,/ig.test(m))throw"Input must be formatted properly as a base64 encoded DataURI of type image/webp";this.frames.push({image:m,duration:g||this.duration})};function t(m){var g=q.createObjectURL(new Blob([m.toString(),"this.onmessage =  function (eee) {"+m.name+"(eee.data);}"],{type:"application/javascript"})),_=new Worker(g);return q.revokeObjectURL(g),_}function o(m){function g(l){var k=w(l);if(!k)return[];for(var H=3e4,u=[{id:440786851,data:[{data:1,id:17030},{data:1,id:17143},{data:4,id:17138},{data:8,id:17139},{data:"webm",id:17026},{data:2,id:17031},{data:2,id:17029}]},{id:408125543,data:[{id:357149030,data:[{data:1e6,id:2807729},{data:"whammy",id:19840},{data:"whammy",id:22337},{data:U(k.duration),id:17545}]},{id:374648427,data:[{id:174,data:[{data:1,id:215},{data:1,id:29637},{data:0,id:156},{data:"und",id:2274716},{data:"V_VP8",id:134},{data:"VP8",id:2459272},{data:1,id:131},{id:224,data:[{data:k.width,id:176},{data:k.height,id:186}]}]}]}]}],b=0,O=0;b<l.length;){var P=[],Q=0;do P.push(l[b]),Q+=l[b].duration,b++;while(b<l.length&&Q<H);var z=0,de={id:524531317,data:_(O,z,P)};u[1].data.push(de),O+=Q}return R(u)}function _(l,k,H){return[{data:l,id:231}].concat(H.map(function(u){var b=M({discardable:0,frame:u.data.slice(4),invisible:0,keyframe:1,lacing:0,trackNum:1,timecode:Math.round(k)});return k+=u.duration,{data:b,id:163}}))}function w(l){if(!l[0]){postMessage({error:"Something went wrong. Maybe WebP format is not supported in the current browser."});return}for(var k=l[0].width,H=l[0].height,u=l[0].duration,b=1;b<l.length;b++)u+=l[b].duration;return{duration:u,width:k,height:H}}function d(l){for(var k=[];l>0;)k.push(l&255),l=l>>8;return new Uint8Array(k.reverse())}function T(l){return new Uint8Array(l.split("").map(function(k){return k.charCodeAt(0)}))}function D(l){var k=[],H=l.length%8?new Array(9-l.length%8).join("0"):"";l=H+l;for(var u=0;u<l.length;u+=8)k.push(parseInt(l.substr(u,8),2));return new Uint8Array(k)}function R(l){for(var k=[],H=0;H<l.length;H++){var u=l[H].data;typeof u=="object"&&(u=R(u)),typeof u=="number"&&(u=D(u.toString(2))),typeof u=="string"&&(u=T(u));var b=u.size||u.byteLength||u.length,O=Math.ceil(Math.ceil(Math.log(b)/Math.log(2))/8),P=b.toString(2),Q=new Array(O*7+7+1-P.length).join("0")+P,z=new Array(O).join("0")+"1"+Q;k.push(d(l[H].id)),k.push(D(z)),k.push(u)}return new Blob(k,{type:"video/webm"})}function M(l){var k=0;if(l.keyframe&&(k|=128),l.invisible&&(k|=8),l.lacing&&(k|=l.lacing<<1),l.discardable&&(k|=1),l.trackNum>127)throw"TrackNumber > 127 not supported";var H=[l.trackNum|128,l.timecode>>8,l.timecode&255,k].map(function(u){return String.fromCharCode(u)}).join("")+l.frame;return H}function S(l){for(var k=l.RIFF[0].WEBP[0],H=k.indexOf("\x9D*"),u=0,b=[];u<4;u++)b[u]=k.charCodeAt(H+3+u);var O,P,Q;return Q=b[1]<<8|b[0],O=Q&16383,Q=b[3]<<8|b[2],P=Q&16383,{width:O,height:P,data:k,riff:l}}function x(l,k){return parseInt(l.substr(k+4,4).split("").map(function(H){var u=H.charCodeAt(0).toString(2);return new Array(8-u.length+1).join("0")+u}).join(""),2)}function A(l){for(var k=0,H={};k<l.length;){var u=l.substr(k,4),b=x(l,k),O=l.substr(k+4+4,b);k+=4+4+b,H[u]=H[u]||[],u==="RIFF"||u==="LIST"?H[u].push(A(O)):H[u].push(O)}return H}function U(l){return[].slice.call(new Uint8Array(new Float64Array([l]).buffer),0).map(function(k){return String.fromCharCode(k)}).reverse().join("")}var j=new g(m.map(function(l){var k=S(A(atob(l.image.slice(23))));return k.duration=l.duration,k}));postMessage(j)}return a.prototype.compile=function(m){var g=t(o);g.onmessage=function(_){if(_.data.error){console.error(_.data.error);return}m(_.data)},g.postMessage(this.frames)},{Video:a}}();typeof y<"u"&&(y.Whammy=X);/**
 * DiskStorage is a standalone object used by {@link RecordRTC} to store recorded blobs in IndexedDB storage.
 * @summary Writing blobs into IndexedDB.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @example
 * DiskStorage.Store({
 *     audioBlob: yourAudioBlob,
 *     videoBlob: yourVideoBlob,
 *     gifBlob  : yourGifBlob
 * });
 * DiskStorage.Fetch(function(dataURL, type) {
 *     if(type === 'audioBlob') { }
 *     if(type === 'videoBlob') { }
 *     if(type === 'gifBlob')   { }
 * });
 * // DiskStorage.dataStoreName = 'recordRTC';
 * // DiskStorage.onError = function(error) { };
 * @property {function} init - This method must be called once to initialize IndexedDB ObjectStore. Though, it is auto-used internally.
 * @property {function} Fetch - This method fetches stored blobs from IndexedDB.
 * @property {function} Store - This method stores blobs in IndexedDB.
 * @property {function} onError - This function is invoked for any known/unknown error.
 * @property {string} dataStoreName - Name of the ObjectStore created in IndexedDB storage.
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 */var Z={init:function(){var a=this;if(typeof indexedDB>"u"||typeof indexedDB.open>"u"){console.error("IndexedDB API are not available in this browser.");return}var t=1,o=this.dbName||location.href.replace(/\/|:|#|%|\.|\[|\]/g,""),m,g=indexedDB.open(o,t);function _(d){d.createObjectStore(a.dataStoreName)}function w(){var d=m.transaction([a.dataStoreName],"readwrite");a.videoBlob&&d.objectStore(a.dataStoreName).put(a.videoBlob,"videoBlob"),a.gifBlob&&d.objectStore(a.dataStoreName).put(a.gifBlob,"gifBlob"),a.audioBlob&&d.objectStore(a.dataStoreName).put(a.audioBlob,"audioBlob");function T(D){d.objectStore(a.dataStoreName).get(D).onsuccess=function(R){a.callback&&a.callback(R.target.result,D)}}T("audioBlob"),T("videoBlob"),T("gifBlob")}g.onerror=a.onError,g.onsuccess=function(){if(m=g.result,m.onerror=a.onError,m.setVersion)if(m.version!==t){var d=m.setVersion(t);d.onsuccess=function(){_(m),w()}}else w();else w()},g.onupgradeneeded=function(d){_(d.target.result)}},Fetch:function(a){return this.callback=a,this.init(),this},Store:function(a){return this.audioBlob=a.audioBlob,this.videoBlob=a.videoBlob,this.gifBlob=a.gifBlob,this.init(),this},onError:function(a){console.error(JSON.stringify(a,null,"	"))},dataStoreName:"recordRTC",dbName:null};typeof y<"u"&&(y.DiskStorage=Z);/**
 * GifRecorder is standalone calss used by {@link RecordRTC} to record video or canvas into animated gif.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef GifRecorder
 * @class
 * @example
 * var recorder = new GifRecorder(mediaStream || canvas || context, { onGifPreview: function, onGifRecordingStarted: function, width: 1280, height: 720, frameRate: 200, quality: 10 });
 * recorder.record();
 * recorder.stop(function(blob) {
 *     img.src = URL.createObjectURL(blob);
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object or HTMLCanvasElement or CanvasRenderingContext2D.
 * @param {object} config - {disableLogs:true, initCallback: function, width: 320, height: 240, frameRate: 200, quality: 10}
 */function ae(a,t){if(typeof GIFEncoder>"u"){var o=document.createElement("script");o.src="https://www.webrtc-experiment.com/gif-recorder.js",(document.body||document.documentElement).appendChild(o)}t=t||{};var m=a instanceof CanvasRenderingContext2D||a instanceof HTMLCanvasElement;this.record=function(){if(typeof GIFEncoder>"u"){setTimeout(x.record,1e3);return}if(!T){setTimeout(x.record,1e3);return}m||(t.width||(t.width=D.offsetWidth||320),t.height||(t.height=D.offsetHeight||240),t.video||(t.video={width:t.width,height:t.height}),t.canvas||(t.canvas={width:t.width,height:t.height}),w.width=t.canvas.width||320,w.height=t.canvas.height||240,D.width=t.video.width||320,D.height=t.video.height||240),S=new GIFEncoder,S.setRepeat(0),S.setDelay(t.frameRate||200),S.setQuality(t.quality||10),S.start(),typeof t.onGifRecordingStarted=="function"&&t.onGifRecordingStarted();function A(U){if(x.clearedRecordedData!==!0){if(g)return setTimeout(function(){A(U)},100);R=B(A),typeof M===void 0&&(M=U),!(U-M<90)&&(!m&&D.paused&&D.play(),m||d.drawImage(D,0,0,w.width,w.height),t.onGifPreview&&t.onGifPreview(w.toDataURL("image/png")),S.addFrame(d),M=U)}}R=B(A),t.initCallback&&t.initCallback()},this.stop=function(A){A=A||function(){},R&&I(R),this.blob=new Blob([new Uint8Array(S.stream().bin)],{type:"image/gif"}),A(this.blob),S.stream().bin=[]};var g=!1;this.pause=function(){g=!0},this.resume=function(){g=!1},this.clearRecordedData=function(){x.clearedRecordedData=!0,_()};function _(){S&&(S.stream().bin=[])}this.name="GifRecorder",this.toString=function(){return this.name};var w=document.createElement("canvas"),d=w.getContext("2d");m&&(a instanceof CanvasRenderingContext2D?(d=a,w=d.canvas):a instanceof HTMLCanvasElement&&(d=a.getContext("2d"),w=a));var T=!0;if(!m){var D=document.createElement("video");D.muted=!0,D.autoplay=!0,D.playsInline=!0,T=!1,D.onloadedmetadata=function(){T=!0},fe(a,D),D.play()}var R=null,M,S,x=this}typeof y<"u"&&(y.GifRecorder=ae);function xe(a,t){var o="Fake/5.0 (FakeOS) AppleWebKit/123 (KHTML, like Gecko) Fake/12.3.4567.89 Fake/123.45";(function(u){typeof y<"u"||!u||typeof window<"u"||typeof J>"u"||(J.navigator={userAgent:o,getUserMedia:function(){}},J.console||(J.console={}),(typeof J.console.log>"u"||typeof J.console.error>"u")&&(J.console.error=J.console.log=J.console.log||function(){console.log(arguments)}),typeof document>"u"&&(u.document={documentElement:{appendChild:function(){return""}}},document.createElement=document.captureStream=document.mozCaptureStream=function(){var b={getContext:function(){return b},play:function(){},pause:function(){},drawImage:function(){},toDataURL:function(){return""},style:{}};return b},u.HTMLVideoElement=function(){}),typeof location>"u"&&(u.location={protocol:"file:",href:"",hash:""}),typeof screen>"u"&&(u.screen={width:0,height:0}),typeof D>"u"&&(u.URL={createObjectURL:function(){return""},revokeObjectURL:function(){return""}}),u.window=J)})(typeof J<"u"?J:null),t=t||"multi-streams-mixer";var m=[],g=!1,_=document.createElement("canvas"),w=_.getContext("2d");_.style.opacity=0,_.style.position="absolute",_.style.zIndex=-1,_.style.top="-1000em",_.style.left="-1000em",_.className=t,(document.body||document.documentElement).appendChild(_),this.disableLogs=!1,this.frameInterval=10,this.width=360,this.height=240,this.useGainNode=!0;var d=this,T=window.AudioContext;typeof T>"u"&&(typeof webkitAudioContext<"u"&&(T=webkitAudioContext),typeof mozAudioContext<"u"&&(T=mozAudioContext));var D=window.URL;typeof D>"u"&&typeof webkitURL<"u"&&(D=webkitURL),typeof navigator<"u"&&typeof navigator.getUserMedia>"u"&&(typeof navigator.webkitGetUserMedia<"u"&&(navigator.getUserMedia=navigator.webkitGetUserMedia),typeof navigator.mozGetUserMedia<"u"&&(navigator.getUserMedia=navigator.mozGetUserMedia));var R=window.MediaStream;typeof R>"u"&&typeof webkitMediaStream<"u"&&(R=webkitMediaStream),typeof R<"u"&&typeof R.prototype.stop>"u"&&(R.prototype.stop=function(){this.getTracks().forEach(function(u){u.stop()})});var M={};typeof T<"u"?M.AudioContext=T:typeof webkitAudioContext<"u"&&(M.AudioContext=webkitAudioContext);function S(u,b){"srcObject"in b?b.srcObject=u:"mozSrcObject"in b?b.mozSrcObject=u:b.srcObject=u}this.startDrawingFrames=function(){x()};function x(){if(!g){var u=m.length,b=!1,O=[];if(m.forEach(function(Q){Q.stream||(Q.stream={}),Q.stream.fullcanvas?b=Q:O.push(Q)}),b)_.width=b.stream.width,_.height=b.stream.height;else if(O.length){_.width=u>1?O[0].width*2:O[0].width;var P=1;(u===3||u===4)&&(P=2),(u===5||u===6)&&(P=3),(u===7||u===8)&&(P=4),(u===9||u===10)&&(P=5),_.height=O[0].height*P}else _.width=d.width||360,_.height=d.height||240;b&&b instanceof HTMLVideoElement&&A(b),O.forEach(function(Q,z){A(Q,z)}),setTimeout(x,d.frameInterval)}}function A(u,b){if(!g){var O=0,P=0,Q=u.width,z=u.height;b===1&&(O=u.width),b===2&&(P=u.height),b===3&&(O=u.width,P=u.height),b===4&&(P=u.height*2),b===5&&(O=u.width,P=u.height*2),b===6&&(P=u.height*3),b===7&&(O=u.width,P=u.height*3),typeof u.stream.left<"u"&&(O=u.stream.left),typeof u.stream.top<"u"&&(P=u.stream.top),typeof u.stream.width<"u"&&(Q=u.stream.width),typeof u.stream.height<"u"&&(z=u.stream.height),w.drawImage(u,O,P,Q,z),typeof u.stream.onRender=="function"&&u.stream.onRender(w,O,P,Q,z,b)}}function U(){g=!1;var u=j(),b=l();return b&&b.getTracks().filter(function(O){return O.kind==="audio"}).forEach(function(O){u.addTrack(O)}),a.forEach(function(O){O.fullcanvas}),u}function j(){H();var u;"captureStream"in _?u=_.captureStream():"mozCaptureStream"in _?u=_.mozCaptureStream():d.disableLogs||console.error("Upgrade to latest Chrome or otherwise enable this flag: chrome://flags/#enable-experimental-web-platform-features");var b=new R;return u.getTracks().filter(function(O){return O.kind==="video"}).forEach(function(O){b.addTrack(O)}),_.stream=b,b}function l(){M.AudioContextConstructor||(M.AudioContextConstructor=new M.AudioContext),d.audioContext=M.AudioContextConstructor,d.audioSources=[],d.useGainNode===!0&&(d.gainNode=d.audioContext.createGain(),d.gainNode.connect(d.audioContext.destination),d.gainNode.gain.value=0);var u=0;if(a.forEach(function(b){if(!!b.getTracks().filter(function(P){return P.kind==="audio"}).length){u++;var O=d.audioContext.createMediaStreamSource(b);d.useGainNode===!0&&O.connect(d.gainNode),d.audioSources.push(O)}}),!!u)return d.audioDestination=d.audioContext.createMediaStreamDestination(),d.audioSources.forEach(function(b){b.connect(d.audioDestination)}),d.audioDestination.stream}function k(u){var b=document.createElement("video");return S(u,b),b.className=t,b.muted=!0,b.volume=0,b.width=u.width||d.width||360,b.height=u.height||d.height||240,b.play(),b}this.appendStreams=function(u){if(!u)throw"First parameter is required.";u instanceof Array||(u=[u]),u.forEach(function(b){var O=new R;if(b.getTracks().filter(function(z){return z.kind==="video"}).length){var P=k(b);P.stream=b,m.push(P),O.addTrack(b.getTracks().filter(function(z){return z.kind==="video"})[0])}if(b.getTracks().filter(function(z){return z.kind==="audio"}).length){var Q=d.audioContext.createMediaStreamSource(b);d.audioDestination=d.audioContext.createMediaStreamDestination(),Q.connect(d.audioDestination),O.addTrack(d.audioDestination.stream.getTracks().filter(function(z){return z.kind==="audio"})[0])}a.push(O)})},this.releaseStreams=function(){m=[],g=!0,d.gainNode&&(d.gainNode.disconnect(),d.gainNode=null),d.audioSources.length&&(d.audioSources.forEach(function(u){u.disconnect()}),d.audioSources=[]),d.audioDestination&&(d.audioDestination.disconnect(),d.audioDestination=null),d.audioContext&&d.audioContext.close(),d.audioContext=null,w.clearRect(0,0,_.width,_.height),_.stream&&(_.stream.stop(),_.stream=null)},this.resetVideoStreams=function(u){u&&!(u instanceof Array)&&(u=[u]),H(u)};function H(u){m=[],u=u||a,u.forEach(function(b){if(!!b.getTracks().filter(function(P){return P.kind==="video"}).length){var O=k(b);O.stream=b,m.push(O)}})}this.name="MultiStreamsMixer",this.toString=function(){return this.name},this.getMixedStream=U}typeof y>"u"&&(ee.exports=xe);/**
 * MultiStreamRecorder can record multiple videos in single container.
 * @summary Multi-videos recorder.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef MultiStreamRecorder
 * @class
 * @example
 * var options = {
 *     mimeType: 'video/webm'
 * }
 * var recorder = new MultiStreamRecorder(ArrayOfMediaStreams, options);
 * recorder.record();
 * recorder.stop(function(blob) {
 *     video.src = URL.createObjectURL(blob);
 *
 *     // or
 *     var blob = recorder.blob;
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStreams} mediaStreams - Array of MediaStreams.
 * @param {object} config - {disableLogs:true, frameInterval: 1, mimeType: "video/webm"}
 */function Y(a,t){a=a||[];var o=this,m,g;t=t||{elementClass:"multi-streams-mixer",mimeType:"video/webm",video:{width:360,height:240}},t.frameInterval||(t.frameInterval=10),t.video||(t.video={}),t.video.width||(t.video.width=360),t.video.height||(t.video.height=240),this.record=function(){m=new xe(a,t.elementClass||"multi-streams-mixer"),_().length&&(m.frameInterval=t.frameInterval||10,m.width=t.video.width||360,m.height=t.video.height||240,m.startDrawingFrames()),t.previewStream&&typeof t.previewStream=="function"&&t.previewStream(m.getMixedStream()),g=new W(m.getMixedStream(),t),g.record()};function _(){var w=[];return a.forEach(function(d){V(d,"video").forEach(function(T){w.push(T)})}),w}this.stop=function(w){!g||g.stop(function(d){o.blob=d,w(d),o.clearRecordedData()})},this.pause=function(){g&&g.pause()},this.resume=function(){g&&g.resume()},this.clearRecordedData=function(){g&&(g.clearRecordedData(),g=null),m&&(m.releaseStreams(),m=null)},this.addStreams=function(w){if(!w)throw"First parameter is required.";w instanceof Array||(w=[w]),a.concat(w),!(!g||!m)&&(m.appendStreams(w),t.previewStream&&typeof t.previewStream=="function"&&t.previewStream(m.getMixedStream()))},this.resetVideoStreams=function(w){!m||(w&&!(w instanceof Array)&&(w=[w]),m.resetVideoStreams(w))},this.getMixer=function(){return m},this.name="MultiStreamRecorder",this.toString=function(){return this.name}}typeof y<"u"&&(y.MultiStreamRecorder=Y);/**
 * RecordRTCPromisesHandler adds promises support in {@link RecordRTC}. Try a {@link https://github.com/muaz-khan/RecordRTC/blob/master/simple-demos/RecordRTCPromisesHandler.html|demo here}
 * @summary Promises for {@link RecordRTC}
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef RecordRTCPromisesHandler
 * @class
 * @example
 * var recorder = new RecordRTCPromisesHandler(mediaStream, options);
 * recorder.startRecording()
 *         .then(successCB)
 *         .catch(errorCB);
 * // Note: You can access all RecordRTC API using "recorder.recordRTC" e.g. 
 * recorder.recordRTC.onStateChanged = function(state) {};
 * recorder.recordRTC.setRecordingDuration(5000);
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - Single media-stream object, array of media-streams, html-canvas-element, etc.
 * @param {object} config - {type:"video", recorderType: MediaStreamRecorder, disableLogs: true, numberOfAudioChannels: 1, bufferSize: 0, sampleRate: 0, video: HTMLVideoElement, etc.}
 * @throws Will throw an error if "new" keyword is not used to initiate "RecordRTCPromisesHandler". Also throws error if first argument "MediaStream" is missing.
 * @requires {@link RecordRTC}
 */function Be(a,t){if(!this)throw'Use "new RecordRTCPromisesHandler()"';if(typeof a>"u")throw'First argument "MediaStream" is required.';var o=this;o.recordRTC=new y(a,t),this.startRecording=function(){return new Promise(function(m,g){try{o.recordRTC.startRecording(),m()}catch(_){g(_)}})},this.stopRecording=function(){return new Promise(function(m,g){try{o.recordRTC.stopRecording(function(_){if(o.blob=o.recordRTC.getBlob(),!o.blob||!o.blob.size){g("Empty blob.",o.blob);return}m(_)})}catch(_){g(_)}})},this.pauseRecording=function(){return new Promise(function(m,g){try{o.recordRTC.pauseRecording(),m()}catch(_){g(_)}})},this.resumeRecording=function(){return new Promise(function(m,g){try{o.recordRTC.resumeRecording(),m()}catch(_){g(_)}})},this.getDataURL=function(m){return new Promise(function(g,_){try{o.recordRTC.getDataURL(function(w){g(w)})}catch(w){_(w)}})},this.getBlob=function(){return new Promise(function(m,g){try{m(o.recordRTC.getBlob())}catch(_){g(_)}})},this.getInternalRecorder=function(){return new Promise(function(m,g){try{m(o.recordRTC.getInternalRecorder())}catch(_){g(_)}})},this.reset=function(){return new Promise(function(m,g){try{m(o.recordRTC.reset())}catch(_){g(_)}})},this.destroy=function(){return new Promise(function(m,g){try{m(o.recordRTC.destroy())}catch(_){g(_)}})},this.getState=function(){return new Promise(function(m,g){try{m(o.recordRTC.getState())}catch(_){g(_)}})},this.blob=null,this.version="5.6.2"}typeof y<"u"&&(y.RecordRTCPromisesHandler=Be);/**
 * WebAssemblyRecorder lets you create webm videos in JavaScript via WebAssembly. The library consumes raw RGBA32 buffers (4 bytes per pixel) and turns them into a webm video with the given framerate and quality. This makes it compatible out-of-the-box with ImageData from a CANVAS. With realtime mode you can also use webm-wasm for streaming webm videos.
 * @summary Video recording feature in Chrome, Firefox and maybe Edge.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef WebAssemblyRecorder
 * @class
 * @example
 * var recorder = new WebAssemblyRecorder(mediaStream);
 * recorder.record();
 * recorder.stop(function(blob) {
 *     video.src = URL.createObjectURL(blob);
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @param {object} config - {webAssemblyPath:'webm-wasm.wasm',workerPath: 'webm-worker.js', frameRate: 30, width: 1920, height: 1080, bitrate: 1024, realtime: true}
 */function Oe(a,t){(typeof ReadableStream>"u"||typeof WritableStream>"u")&&console.error("Following polyfill is strongly recommended: https://unpkg.com/@mattiasbuelens/web-streams-polyfill/dist/polyfill.min.js"),t=t||{},t.width=t.width||640,t.height=t.height||480,t.frameRate=t.frameRate||30,t.bitrate=t.bitrate||1200,t.realtime=t.realtime||!0;var o;function m(){return new ReadableStream({start:function(D){var R=document.createElement("canvas"),M=document.createElement("video"),S=!0;M.srcObject=a,M.muted=!0,M.height=t.height,M.width=t.width,M.volume=0,M.onplaying=function(){R.width=t.width,R.height=t.height;var x=R.getContext("2d"),A=1e3/t.frameRate,U=setInterval(function(){if(o&&(clearInterval(U),D.close()),S&&(S=!1,t.onVideoProcessStarted&&t.onVideoProcessStarted()),x.drawImage(M,0,0),D._controlledReadableStream.state!=="closed")try{D.enqueue(x.getImageData(0,0,t.width,t.height))}catch{}},A)},M.play()}})}var g;function _(D,R){if(!t.workerPath&&!R){o=!1,fetch("https://unpkg.com/webm-wasm@latest/dist/webm-worker.js").then(function(S){S.arrayBuffer().then(function(x){_(D,x)})});return}if(!t.workerPath&&R instanceof ArrayBuffer){var M=new Blob([R],{type:"text/javascript"});t.workerPath=q.createObjectURL(M)}t.workerPath||console.error("workerPath parameter is missing."),g=new Worker(t.workerPath),g.postMessage(t.webAssemblyPath||"https://unpkg.com/webm-wasm@latest/dist/webm-wasm.wasm"),g.addEventListener("message",function(S){S.data==="READY"?(g.postMessage({width:t.width,height:t.height,bitrate:t.bitrate||1200,timebaseDen:t.frameRate||30,realtime:t.realtime}),m().pipeTo(new WritableStream({write:function(x){if(o){console.error("Got image, but recorder is finished!");return}g.postMessage(x.data.buffer,[x.data.buffer])}}))):S.data&&(w||T.push(S.data))})}this.record=function(){T=[],w=!1,this.blob=null,_(a),typeof t.initCallback=="function"&&t.initCallback()};var w;this.pause=function(){w=!0},this.resume=function(){w=!1};function d(D){if(!g){D&&D();return}g.addEventListener("message",function(R){R.data===null&&(g.terminate(),g=null,D&&D())}),g.postMessage(null)}var T=[];this.stop=function(D){o=!0;var R=this;d(function(){R.blob=new Blob(T,{type:"video/webm"}),D(R.blob)})},this.name="WebAssemblyRecorder",this.toString=function(){return this.name},this.clearRecordedData=function(){T=[],w=!1,this.blob=null},this.blob=null}typeof y<"u"&&(y.WebAssemblyRecorder=Oe)})(dt);var ut={};/*!
 *  howler.js v2.2.3
 *  howlerjs.com
 *
 *  (c) 2013-2020, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */(function(ee){(function(){var y=function(){this.init()};y.prototype={init:function(){var e=this||i;return e._counter=1e3,e._html5AudioPool=[],e.html5PoolSize=10,e._codecs={},e._howls=[],e._muted=!1,e._volume=1,e._canPlayEvent="canplaythrough",e._navigator=typeof window<"u"&&window.navigator?window.navigator:null,e.masterGain=null,e.noAudio=!1,e.usingWebAudio=!0,e.autoSuspend=!0,e.ctx=null,e.autoUnlock=!0,e._setup(),e},volume:function(e){var r=this||i;if(e=parseFloat(e),r.ctx||q(),typeof e<"u"&&e>=0&&e<=1){if(r._volume=e,r._muted)return r;r.usingWebAudio&&r.masterGain.gain.setValueAtTime(e,i.ctx.currentTime);for(var n=0;n<r._howls.length;n++)if(!r._howls[n]._webAudio)for(var s=r._howls[n]._getSoundIds(),h=0;h<s.length;h++){var v=r._howls[n]._soundById(s[h]);v&&v._node&&(v._node.volume=v._volume*e)}return r}return r._volume},mute:function(e){var r=this||i;r.ctx||q(),r._muted=e,r.usingWebAudio&&r.masterGain.gain.setValueAtTime(e?0:r._volume,i.ctx.currentTime);for(var n=0;n<r._howls.length;n++)if(!r._howls[n]._webAudio)for(var s=r._howls[n]._getSoundIds(),h=0;h<s.length;h++){var v=r._howls[n]._soundById(s[h]);v&&v._node&&(v._node.muted=e?!0:v._muted)}return r},stop:function(){for(var e=this||i,r=0;r<e._howls.length;r++)e._howls[r].stop();return e},unload:function(){for(var e=this||i,r=e._howls.length-1;r>=0;r--)e._howls[r].unload();return e.usingWebAudio&&e.ctx&&typeof e.ctx.close<"u"&&(e.ctx.close(),e.ctx=null,q()),e},codecs:function(e){return(this||i)._codecs[e.replace(/^x-/,"")]},_setup:function(){var e=this||i;if(e.state=e.ctx&&e.ctx.state||"suspended",e._autoSuspend(),!e.usingWebAudio)if(typeof Audio<"u")try{var r=new Audio;typeof r.oncanplaythrough>"u"&&(e._canPlayEvent="canplay")}catch{e.noAudio=!0}else e.noAudio=!0;try{var r=new Audio;r.muted&&(e.noAudio=!0)}catch{}return e.noAudio||e._setupCodecs(),e},_setupCodecs:function(){var e=this||i,r=null;try{r=typeof Audio<"u"?new Audio:null}catch{return e}if(!r||typeof r.canPlayType!="function")return e;var n=r.canPlayType("audio/mpeg;").replace(/^no$/,""),s=e._navigator?e._navigator.userAgent:"",h=s.match(/OPR\/([0-6].)/g),v=h&&parseInt(h[0].split("/")[1],10)<33,f=s.indexOf("Safari")!==-1&&s.indexOf("Chrome")===-1,F=s.match(/Version\/(.*?) /),$=f&&F&&parseInt(F[1],10)<15;return e._codecs={mp3:!!(!v&&(n||r.canPlayType("audio/mp3;").replace(/^no$/,""))),mpeg:!!n,opus:!!r.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!r.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!r.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(r.canPlayType('audio/wav; codecs="1"')||r.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!r.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!r.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(r.canPlayType("audio/x-m4a;")||r.canPlayType("audio/m4a;")||r.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(r.canPlayType("audio/x-m4b;")||r.canPlayType("audio/m4b;")||r.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(r.canPlayType("audio/x-mp4;")||r.canPlayType("audio/mp4;")||r.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!(!$&&r.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:!!(!$&&r.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:!!r.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(r.canPlayType("audio/x-flac;")||r.canPlayType("audio/flac;")).replace(/^no$/,"")},e},_unlockAudio:function(){var e=this||i;if(!(e._audioUnlocked||!e.ctx)){e._audioUnlocked=!1,e.autoUnlock=!1,!e._mobileUnloaded&&e.ctx.sampleRate!==44100&&(e._mobileUnloaded=!0,e.unload()),e._scratchBuffer=e.ctx.createBuffer(1,1,22050);var r=function(n){for(;e._html5AudioPool.length<e.html5PoolSize;)try{var s=new Audio;s._unlocked=!0,e._releaseHtml5Audio(s)}catch{e.noAudio=!0;break}for(var h=0;h<e._howls.length;h++)if(!e._howls[h]._webAudio)for(var v=e._howls[h]._getSoundIds(),f=0;f<v.length;f++){var F=e._howls[h]._soundById(v[f]);F&&F._node&&!F._node._unlocked&&(F._node._unlocked=!0,F._node.load())}e._autoResume();var $=e.ctx.createBufferSource();$.buffer=e._scratchBuffer,$.connect(e.ctx.destination),typeof $.start>"u"?$.noteOn(0):$.start(0),typeof e.ctx.resume=="function"&&e.ctx.resume(),$.onended=function(){$.disconnect(0),e._audioUnlocked=!0,document.removeEventListener("touchstart",r,!0),document.removeEventListener("touchend",r,!0),document.removeEventListener("click",r,!0),document.removeEventListener("keydown",r,!0);for(var V=0;V<e._howls.length;V++)e._howls[V]._emit("unlock")}};return document.addEventListener("touchstart",r,!0),document.addEventListener("touchend",r,!0),document.addEventListener("click",r,!0),document.addEventListener("keydown",r,!0),e}},_obtainHtml5Audio:function(){var e=this||i;if(e._html5AudioPool.length)return e._html5AudioPool.pop();var r=new Audio().play();return r&&typeof Promise<"u"&&(r instanceof Promise||typeof r.then=="function")&&r.catch(function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")}),new Audio},_releaseHtml5Audio:function(e){var r=this||i;return e._unlocked&&r._html5AudioPool.push(e),r},_autoSuspend:function(){var e=this;if(!(!e.autoSuspend||!e.ctx||typeof e.ctx.suspend>"u"||!i.usingWebAudio)){for(var r=0;r<e._howls.length;r++)if(e._howls[r]._webAudio){for(var n=0;n<e._howls[r]._sounds.length;n++)if(!e._howls[r]._sounds[n]._paused)return e}return e._suspendTimer&&clearTimeout(e._suspendTimer),e._suspendTimer=setTimeout(function(){if(!!e.autoSuspend){e._suspendTimer=null,e.state="suspending";var s=function(){e.state="suspended",e._resumeAfterSuspend&&(delete e._resumeAfterSuspend,e._autoResume())};e.ctx.suspend().then(s,s)}},3e4),e}},_autoResume:function(){var e=this;if(!(!e.ctx||typeof e.ctx.resume>"u"||!i.usingWebAudio))return e.state==="running"&&e.ctx.state!=="interrupted"&&e._suspendTimer?(clearTimeout(e._suspendTimer),e._suspendTimer=null):e.state==="suspended"||e.state==="running"&&e.ctx.state==="interrupted"?(e.ctx.resume().then(function(){e.state="running";for(var r=0;r<e._howls.length;r++)e._howls[r]._emit("resume")}),e._suspendTimer&&(clearTimeout(e._suspendTimer),e._suspendTimer=null)):e.state==="suspending"&&(e._resumeAfterSuspend=!0),e}};var i=new y,p=function(e){var r=this;if(!e.src||e.src.length===0){console.error("An array of source files must be passed with any new Howl.");return}r.init(e)};p.prototype={init:function(e){var r=this;return i.ctx||q(),r._autoplay=e.autoplay||!1,r._format=typeof e.format!="string"?e.format:[e.format],r._html5=e.html5||!1,r._muted=e.mute||!1,r._loop=e.loop||!1,r._pool=e.pool||5,r._preload=typeof e.preload=="boolean"||e.preload==="metadata"?e.preload:!0,r._rate=e.rate||1,r._sprite=e.sprite||{},r._src=typeof e.src!="string"?e.src:[e.src],r._volume=e.volume!==void 0?e.volume:1,r._xhr={method:e.xhr&&e.xhr.method?e.xhr.method:"GET",headers:e.xhr&&e.xhr.headers?e.xhr.headers:null,withCredentials:e.xhr&&e.xhr.withCredentials?e.xhr.withCredentials:!1},r._duration=0,r._state="unloaded",r._sounds=[],r._endTimers={},r._queue=[],r._playLock=!1,r._onend=e.onend?[{fn:e.onend}]:[],r._onfade=e.onfade?[{fn:e.onfade}]:[],r._onload=e.onload?[{fn:e.onload}]:[],r._onloaderror=e.onloaderror?[{fn:e.onloaderror}]:[],r._onplayerror=e.onplayerror?[{fn:e.onplayerror}]:[],r._onpause=e.onpause?[{fn:e.onpause}]:[],r._onplay=e.onplay?[{fn:e.onplay}]:[],r._onstop=e.onstop?[{fn:e.onstop}]:[],r._onmute=e.onmute?[{fn:e.onmute}]:[],r._onvolume=e.onvolume?[{fn:e.onvolume}]:[],r._onrate=e.onrate?[{fn:e.onrate}]:[],r._onseek=e.onseek?[{fn:e.onseek}]:[],r._onunlock=e.onunlock?[{fn:e.onunlock}]:[],r._onresume=[],r._webAudio=i.usingWebAudio&&!r._html5,typeof i.ctx<"u"&&i.ctx&&i.autoUnlock&&i._unlockAudio(),i._howls.push(r),r._autoplay&&r._queue.push({event:"play",action:function(){r.play()}}),r._preload&&r._preload!=="none"&&r.load(),r},load:function(){var e=this,r=null;if(i.noAudio){e._emit("loaderror",null,"No audio support.");return}typeof e._src=="string"&&(e._src=[e._src]);for(var n=0;n<e._src.length;n++){var s,h;if(e._format&&e._format[n])s=e._format[n];else{if(h=e._src[n],typeof h!="string"){e._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}s=/^data:audio\/([^;,]+);/i.exec(h),s||(s=/\.([^.]+)$/.exec(h.split("?",1)[0])),s&&(s=s[1].toLowerCase())}if(s||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),s&&i.codecs(s)){r=e._src[n];break}}if(!r){e._emit("loaderror",null,"No codec support for selected audio sources.");return}return e._src=r,e._state="loading",window.location.protocol==="https:"&&r.slice(0,5)==="http:"&&(e._html5=!0,e._webAudio=!1),new c(e),e._webAudio&&B(e),e},play:function(e,r){var n=this,s=null;if(typeof e=="number")s=e,e=null;else{if(typeof e=="string"&&n._state==="loaded"&&!n._sprite[e])return null;if(typeof e>"u"&&(e="__default",!n._playLock)){for(var h=0,v=0;v<n._sounds.length;v++)n._sounds[v]._paused&&!n._sounds[v]._ended&&(h++,s=n._sounds[v]._id);h===1?e=null:s=null}}var f=s?n._soundById(s):n._inactiveSound();if(!f)return null;if(s&&!e&&(e=f._sprite||"__default"),n._state!=="loaded"){f._sprite=e,f._ended=!1;var F=f._id;return n._queue.push({event:"play",action:function(){n.play(F)}}),F}if(s&&!f._paused)return r||n._loadQueue("play"),f._id;n._webAudio&&i._autoResume();var $=Math.max(0,f._seek>0?f._seek:n._sprite[e][0]/1e3),V=Math.max(0,(n._sprite[e][0]+n._sprite[e][1])/1e3-$),fe=V*1e3/Math.abs(f._rate),ge=n._sprite[e][0]/1e3,ce=(n._sprite[e][0]+n._sprite[e][1])/1e3;f._sprite=e,f._ended=!1;var pe=function(){f._paused=!1,f._seek=$,f._start=ge,f._stop=ce,f._loop=!!(f._loop||n._sprite[e][2])};if($>=ce){n._ended(f);return}var W=f._node;if(n._webAudio){var Ae=function(){n._playLock=!1,pe(),n._refreshBuffer(f);var Z=f._muted||n._muted?0:f._volume;W.gain.setValueAtTime(Z,i.ctx.currentTime),f._playStart=i.ctx.currentTime,typeof W.bufferSource.start>"u"?f._loop?W.bufferSource.noteGrainOn(0,$,86400):W.bufferSource.noteGrainOn(0,$,V):f._loop?W.bufferSource.start(0,$,86400):W.bufferSource.start(0,$,V),fe!==1/0&&(n._endTimers[f._id]=setTimeout(n._ended.bind(n,f),fe)),r||setTimeout(function(){n._emit("play",f._id),n._loadQueue()},0)};i.state==="running"&&i.ctx.state!=="interrupted"?Ae():(n._playLock=!0,n.once("resume",Ae),n._clearTimer(f._id))}else{var E=function(){W.currentTime=$,W.muted=f._muted||n._muted||i._muted||W.muted,W.volume=f._volume*i.volume(),W.playbackRate=f._rate;try{var Z=W.play();if(Z&&typeof Promise<"u"&&(Z instanceof Promise||typeof Z.then=="function")?(n._playLock=!0,pe(),Z.then(function(){n._playLock=!1,W._unlocked=!0,r?n._loadQueue():n._emit("play",f._id)}).catch(function(){n._playLock=!1,n._emit("playerror",f._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),f._ended=!0,f._paused=!0})):r||(n._playLock=!1,pe(),n._emit("play",f._id)),W.playbackRate=f._rate,W.paused){n._emit("playerror",f._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");return}e!=="__default"||f._loop?n._endTimers[f._id]=setTimeout(n._ended.bind(n,f),fe):(n._endTimers[f._id]=function(){n._ended(f),W.removeEventListener("ended",n._endTimers[f._id],!1)},W.addEventListener("ended",n._endTimers[f._id],!1))}catch(ae){n._emit("playerror",f._id,ae)}};W.src==="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"&&(W.src=n._src,W.load());var G=window&&window.ejecta||!W.readyState&&i._navigator.isCocoonJS;if(W.readyState>=3||G)E();else{n._playLock=!0,n._state="loading";var X=function(){n._state="loaded",E(),W.removeEventListener(i._canPlayEvent,X,!1)};W.addEventListener(i._canPlayEvent,X,!1),n._clearTimer(f._id)}}return f._id},pause:function(e){var r=this;if(r._state!=="loaded"||r._playLock)return r._queue.push({event:"pause",action:function(){r.pause(e)}}),r;for(var n=r._getSoundIds(e),s=0;s<n.length;s++){r._clearTimer(n[s]);var h=r._soundById(n[s]);if(h&&!h._paused&&(h._seek=r.seek(n[s]),h._rateSeek=0,h._paused=!0,r._stopFade(n[s]),h._node))if(r._webAudio){if(!h._node.bufferSource)continue;typeof h._node.bufferSource.stop>"u"?h._node.bufferSource.noteOff(0):h._node.bufferSource.stop(0),r._cleanBuffer(h._node)}else(!isNaN(h._node.duration)||h._node.duration===1/0)&&h._node.pause();arguments[1]||r._emit("pause",h?h._id:null)}return r},stop:function(e,r){var n=this;if(n._state!=="loaded"||n._playLock)return n._queue.push({event:"stop",action:function(){n.stop(e)}}),n;for(var s=n._getSoundIds(e),h=0;h<s.length;h++){n._clearTimer(s[h]);var v=n._soundById(s[h]);v&&(v._seek=v._start||0,v._rateSeek=0,v._paused=!0,v._ended=!0,n._stopFade(s[h]),v._node&&(n._webAudio?v._node.bufferSource&&(typeof v._node.bufferSource.stop>"u"?v._node.bufferSource.noteOff(0):v._node.bufferSource.stop(0),n._cleanBuffer(v._node)):(!isNaN(v._node.duration)||v._node.duration===1/0)&&(v._node.currentTime=v._start||0,v._node.pause(),v._node.duration===1/0&&n._clearSound(v._node))),r||n._emit("stop",v._id))}return n},mute:function(e,r){var n=this;if(n._state!=="loaded"||n._playLock)return n._queue.push({event:"mute",action:function(){n.mute(e,r)}}),n;if(typeof r>"u")if(typeof e=="boolean")n._muted=e;else return n._muted;for(var s=n._getSoundIds(r),h=0;h<s.length;h++){var v=n._soundById(s[h]);v&&(v._muted=e,v._interval&&n._stopFade(v._id),n._webAudio&&v._node?v._node.gain.setValueAtTime(e?0:v._volume,i.ctx.currentTime):v._node&&(v._node.muted=i._muted?!0:e),n._emit("mute",v._id))}return n},volume:function(){var e=this,r=arguments,n,s;if(r.length===0)return e._volume;if(r.length===1||r.length===2&&typeof r[1]>"u"){var h=e._getSoundIds(),v=h.indexOf(r[0]);v>=0?s=parseInt(r[0],10):n=parseFloat(r[0])}else r.length>=2&&(n=parseFloat(r[0]),s=parseInt(r[1],10));var f;if(typeof n<"u"&&n>=0&&n<=1){if(e._state!=="loaded"||e._playLock)return e._queue.push({event:"volume",action:function(){e.volume.apply(e,r)}}),e;typeof s>"u"&&(e._volume=n),s=e._getSoundIds(s);for(var F=0;F<s.length;F++)f=e._soundById(s[F]),f&&(f._volume=n,r[2]||e._stopFade(s[F]),e._webAudio&&f._node&&!f._muted?f._node.gain.setValueAtTime(n,i.ctx.currentTime):f._node&&!f._muted&&(f._node.volume=n*i.volume()),e._emit("volume",f._id))}else return f=s?e._soundById(s):e._sounds[0],f?f._volume:0;return e},fade:function(e,r,n,s){var h=this;if(h._state!=="loaded"||h._playLock)return h._queue.push({event:"fade",action:function(){h.fade(e,r,n,s)}}),h;e=Math.min(Math.max(0,parseFloat(e)),1),r=Math.min(Math.max(0,parseFloat(r)),1),n=parseFloat(n),h.volume(e,s);for(var v=h._getSoundIds(s),f=0;f<v.length;f++){var F=h._soundById(v[f]);if(F){if(s||h._stopFade(v[f]),h._webAudio&&!F._muted){var $=i.ctx.currentTime,V=$+n/1e3;F._volume=e,F._node.gain.setValueAtTime(e,$),F._node.gain.linearRampToValueAtTime(r,V)}h._startFadeInterval(F,e,r,n,v[f],typeof s>"u")}}return h},_startFadeInterval:function(e,r,n,s,h,v){var f=this,F=r,$=n-r,V=Math.abs($/.01),fe=Math.max(4,V>0?s/V:s),ge=Date.now();e._fadeTo=n,e._interval=setInterval(function(){var ce=(Date.now()-ge)/s;ge=Date.now(),F+=$*ce,F=Math.round(F*100)/100,$<0?F=Math.max(n,F):F=Math.min(n,F),f._webAudio?e._volume=F:f.volume(F,e._id,!0),v&&(f._volume=F),(n<r&&F<=n||n>r&&F>=n)&&(clearInterval(e._interval),e._interval=null,e._fadeTo=null,f.volume(n,e._id),f._emit("fade",e._id))},fe)},_stopFade:function(e){var r=this,n=r._soundById(e);return n&&n._interval&&(r._webAudio&&n._node.gain.cancelScheduledValues(i.ctx.currentTime),clearInterval(n._interval),n._interval=null,r.volume(n._fadeTo,e),n._fadeTo=null,r._emit("fade",e)),r},loop:function(){var e=this,r=arguments,n,s,h;if(r.length===0)return e._loop;if(r.length===1)if(typeof r[0]=="boolean")n=r[0],e._loop=n;else return h=e._soundById(parseInt(r[0],10)),h?h._loop:!1;else r.length===2&&(n=r[0],s=parseInt(r[1],10));for(var v=e._getSoundIds(s),f=0;f<v.length;f++)h=e._soundById(v[f]),h&&(h._loop=n,e._webAudio&&h._node&&h._node.bufferSource&&(h._node.bufferSource.loop=n,n&&(h._node.bufferSource.loopStart=h._start||0,h._node.bufferSource.loopEnd=h._stop,e.playing(v[f])&&(e.pause(v[f],!0),e.play(v[f],!0)))));return e},rate:function(){var e=this,r=arguments,n,s;if(r.length===0)s=e._sounds[0]._id;else if(r.length===1){var h=e._getSoundIds(),v=h.indexOf(r[0]);v>=0?s=parseInt(r[0],10):n=parseFloat(r[0])}else r.length===2&&(n=parseFloat(r[0]),s=parseInt(r[1],10));var f;if(typeof n=="number"){if(e._state!=="loaded"||e._playLock)return e._queue.push({event:"rate",action:function(){e.rate.apply(e,r)}}),e;typeof s>"u"&&(e._rate=n),s=e._getSoundIds(s);for(var F=0;F<s.length;F++)if(f=e._soundById(s[F]),f){e.playing(s[F])&&(f._rateSeek=e.seek(s[F]),f._playStart=e._webAudio?i.ctx.currentTime:f._playStart),f._rate=n,e._webAudio&&f._node&&f._node.bufferSource?f._node.bufferSource.playbackRate.setValueAtTime(n,i.ctx.currentTime):f._node&&(f._node.playbackRate=n);var $=e.seek(s[F]),V=(e._sprite[f._sprite][0]+e._sprite[f._sprite][1])/1e3-$,fe=V*1e3/Math.abs(f._rate);(e._endTimers[s[F]]||!f._paused)&&(e._clearTimer(s[F]),e._endTimers[s[F]]=setTimeout(e._ended.bind(e,f),fe)),e._emit("rate",f._id)}}else return f=e._soundById(s),f?f._rate:e._rate;return e},seek:function(){var e=this,r=arguments,n,s;if(r.length===0)e._sounds.length&&(s=e._sounds[0]._id);else if(r.length===1){var h=e._getSoundIds(),v=h.indexOf(r[0]);v>=0?s=parseInt(r[0],10):e._sounds.length&&(s=e._sounds[0]._id,n=parseFloat(r[0]))}else r.length===2&&(n=parseFloat(r[0]),s=parseInt(r[1],10));if(typeof s>"u")return 0;if(typeof n=="number"&&(e._state!=="loaded"||e._playLock))return e._queue.push({event:"seek",action:function(){e.seek.apply(e,r)}}),e;var f=e._soundById(s);if(f)if(typeof n=="number"&&n>=0){var F=e.playing(s);F&&e.pause(s,!0),f._seek=n,f._ended=!1,e._clearTimer(s),!e._webAudio&&f._node&&!isNaN(f._node.duration)&&(f._node.currentTime=n);var $=function(){F&&e.play(s,!0),e._emit("seek",s)};if(F&&!e._webAudio){var V=function(){e._playLock?setTimeout(V,0):$()};setTimeout(V,0)}else $()}else if(e._webAudio){var fe=e.playing(s)?i.ctx.currentTime-f._playStart:0,ge=f._rateSeek?f._rateSeek-f._seek:0;return f._seek+(ge+fe*Math.abs(f._rate))}else return f._node.currentTime;return e},playing:function(e){var r=this;if(typeof e=="number"){var n=r._soundById(e);return n?!n._paused:!1}for(var s=0;s<r._sounds.length;s++)if(!r._sounds[s]._paused)return!0;return!1},duration:function(e){var r=this,n=r._duration,s=r._soundById(e);return s&&(n=r._sprite[s._sprite][1]/1e3),n},state:function(){return this._state},unload:function(){for(var e=this,r=e._sounds,n=0;n<r.length;n++)r[n]._paused||e.stop(r[n]._id),e._webAudio||(e._clearSound(r[n]._node),r[n]._node.removeEventListener("error",r[n]._errorFn,!1),r[n]._node.removeEventListener(i._canPlayEvent,r[n]._loadFn,!1),r[n]._node.removeEventListener("ended",r[n]._endFn,!1),i._releaseHtml5Audio(r[n]._node)),delete r[n]._node,e._clearTimer(r[n]._id);var s=i._howls.indexOf(e);s>=0&&i._howls.splice(s,1);var h=!0;for(n=0;n<i._howls.length;n++)if(i._howls[n]._src===e._src||e._src.indexOf(i._howls[n]._src)>=0){h=!1;break}return C&&h&&delete C[e._src],i.noAudio=!1,e._state="unloaded",e._sounds=[],e=null,null},on:function(e,r,n,s){var h=this,v=h["_on"+e];return typeof r=="function"&&v.push(s?{id:n,fn:r,once:s}:{id:n,fn:r}),h},off:function(e,r,n){var s=this,h=s["_on"+e],v=0;if(typeof r=="number"&&(n=r,r=null),r||n)for(v=0;v<h.length;v++){var f=n===h[v].id;if(r===h[v].fn&&f||!r&&f){h.splice(v,1);break}}else if(e)s["_on"+e]=[];else{var F=Object.keys(s);for(v=0;v<F.length;v++)F[v].indexOf("_on")===0&&Array.isArray(s[F[v]])&&(s[F[v]]=[])}return s},once:function(e,r,n){var s=this;return s.on(e,r,n,1),s},_emit:function(e,r,n){for(var s=this,h=s["_on"+e],v=h.length-1;v>=0;v--)(!h[v].id||h[v].id===r||e==="load")&&(setTimeout(function(f){f.call(this,r,n)}.bind(s,h[v].fn),0),h[v].once&&s.off(e,h[v].fn,h[v].id));return s._loadQueue(e),s},_loadQueue:function(e){var r=this;if(r._queue.length>0){var n=r._queue[0];n.event===e&&(r._queue.shift(),r._loadQueue()),e||n.action()}return r},_ended:function(e){var r=this,n=e._sprite;if(!r._webAudio&&e._node&&!e._node.paused&&!e._node.ended&&e._node.currentTime<e._stop)return setTimeout(r._ended.bind(r,e),100),r;var s=!!(e._loop||r._sprite[n][2]);if(r._emit("end",e._id),!r._webAudio&&s&&r.stop(e._id,!0).play(e._id),r._webAudio&&s){r._emit("play",e._id),e._seek=e._start||0,e._rateSeek=0,e._playStart=i.ctx.currentTime;var h=(e._stop-e._start)*1e3/Math.abs(e._rate);r._endTimers[e._id]=setTimeout(r._ended.bind(r,e),h)}return r._webAudio&&!s&&(e._paused=!0,e._ended=!0,e._seek=e._start||0,e._rateSeek=0,r._clearTimer(e._id),r._cleanBuffer(e._node),i._autoSuspend()),!r._webAudio&&!s&&r.stop(e._id,!0),r},_clearTimer:function(e){var r=this;if(r._endTimers[e]){if(typeof r._endTimers[e]!="function")clearTimeout(r._endTimers[e]);else{var n=r._soundById(e);n&&n._node&&n._node.removeEventListener("ended",r._endTimers[e],!1)}delete r._endTimers[e]}return r},_soundById:function(e){for(var r=this,n=0;n<r._sounds.length;n++)if(e===r._sounds[n]._id)return r._sounds[n];return null},_inactiveSound:function(){var e=this;e._drain();for(var r=0;r<e._sounds.length;r++)if(e._sounds[r]._ended)return e._sounds[r].reset();return new c(e)},_drain:function(){var e=this,r=e._pool,n=0,s=0;if(!(e._sounds.length<r)){for(s=0;s<e._sounds.length;s++)e._sounds[s]._ended&&n++;for(s=e._sounds.length-1;s>=0;s--){if(n<=r)return;e._sounds[s]._ended&&(e._webAudio&&e._sounds[s]._node&&e._sounds[s]._node.disconnect(0),e._sounds.splice(s,1),n--)}}},_getSoundIds:function(e){var r=this;if(typeof e>"u"){for(var n=[],s=0;s<r._sounds.length;s++)n.push(r._sounds[s]._id);return n}else return[e]},_refreshBuffer:function(e){var r=this;return e._node.bufferSource=i.ctx.createBufferSource(),e._node.bufferSource.buffer=C[r._src],e._panner?e._node.bufferSource.connect(e._panner):e._node.bufferSource.connect(e._node),e._node.bufferSource.loop=e._loop,e._loop&&(e._node.bufferSource.loopStart=e._start||0,e._node.bufferSource.loopEnd=e._stop||0),e._node.bufferSource.playbackRate.setValueAtTime(e._rate,i.ctx.currentTime),r},_cleanBuffer:function(e){var r=this,n=i._navigator&&i._navigator.vendor.indexOf("Apple")>=0;if(i._scratchBuffer&&e.bufferSource&&(e.bufferSource.onended=null,e.bufferSource.disconnect(0),n))try{e.bufferSource.buffer=i._scratchBuffer}catch{}return e.bufferSource=null,r},_clearSound:function(e){var r=/MSIE |Trident\//.test(i._navigator&&i._navigator.userAgent);r||(e.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var c=function(e){this._parent=e,this.init()};c.prototype={init:function(){var e=this,r=e._parent;return e._muted=r._muted,e._loop=r._loop,e._volume=r._volume,e._rate=r._rate,e._seek=0,e._paused=!0,e._ended=!0,e._sprite="__default",e._id=++i._counter,r._sounds.push(e),e.create(),e},create:function(){var e=this,r=e._parent,n=i._muted||e._muted||e._parent._muted?0:e._volume;return r._webAudio?(e._node=typeof i.ctx.createGain>"u"?i.ctx.createGainNode():i.ctx.createGain(),e._node.gain.setValueAtTime(n,i.ctx.currentTime),e._node.paused=!0,e._node.connect(i.masterGain)):i.noAudio||(e._node=i._obtainHtml5Audio(),e._errorFn=e._errorListener.bind(e),e._node.addEventListener("error",e._errorFn,!1),e._loadFn=e._loadListener.bind(e),e._node.addEventListener(i._canPlayEvent,e._loadFn,!1),e._endFn=e._endListener.bind(e),e._node.addEventListener("ended",e._endFn,!1),e._node.src=r._src,e._node.preload=r._preload===!0?"auto":r._preload,e._node.volume=n*i.volume(),e._node.load()),e},reset:function(){var e=this,r=e._parent;return e._muted=r._muted,e._loop=r._loop,e._volume=r._volume,e._rate=r._rate,e._seek=0,e._rateSeek=0,e._paused=!0,e._ended=!0,e._sprite="__default",e._id=++i._counter,e},_errorListener:function(){var e=this;e._parent._emit("loaderror",e._id,e._node.error?e._node.error.code:0),e._node.removeEventListener("error",e._errorFn,!1)},_loadListener:function(){var e=this,r=e._parent;r._duration=Math.ceil(e._node.duration*10)/10,Object.keys(r._sprite).length===0&&(r._sprite={__default:[0,r._duration*1e3]}),r._state!=="loaded"&&(r._state="loaded",r._emit("load"),r._loadQueue()),e._node.removeEventListener(i._canPlayEvent,e._loadFn,!1)},_endListener:function(){var e=this,r=e._parent;r._duration===1/0&&(r._duration=Math.ceil(e._node.duration*10)/10,r._sprite.__default[1]===1/0&&(r._sprite.__default[1]=r._duration*1e3),r._ended(e)),e._node.removeEventListener("ended",e._endFn,!1)}};var C={},B=function(e){var r=e._src;if(C[r]){e._duration=C[r].duration,L(e);return}if(/^data:[^;]+;base64,/.test(r)){for(var n=atob(r.split(",")[1]),s=new Uint8Array(n.length),h=0;h<n.length;++h)s[h]=n.charCodeAt(h);I(s.buffer,e)}else{var v=new XMLHttpRequest;v.open(e._xhr.method,r,!0),v.withCredentials=e._xhr.withCredentials,v.responseType="arraybuffer",e._xhr.headers&&Object.keys(e._xhr.headers).forEach(function(f){v.setRequestHeader(f,e._xhr.headers[f])}),v.onload=function(){var f=(v.status+"")[0];if(f!=="0"&&f!=="2"&&f!=="3"){e._emit("loaderror",null,"Failed loading audio file with status: "+v.status+".");return}I(v.response,e)},v.onerror=function(){e._webAudio&&(e._html5=!0,e._webAudio=!1,e._sounds=[],delete C[r],e.load())},N(v)}},N=function(e){try{e.send()}catch{e.onerror()}},I=function(e,r){var n=function(){r._emit("loaderror",null,"Decoding audio data failed.")},s=function(h){h&&r._sounds.length>0?(C[r._src]=h,L(r,h)):n()};typeof Promise<"u"&&i.ctx.decodeAudioData.length===1?i.ctx.decodeAudioData(e).then(s).catch(n):i.ctx.decodeAudioData(e,s,n)},L=function(e,r){r&&!e._duration&&(e._duration=r.duration),Object.keys(e._sprite).length===0&&(e._sprite={__default:[0,e._duration*1e3]}),e._state!=="loaded"&&(e._state="loaded",e._emit("load"),e._loadQueue())},q=function(){if(!!i.usingWebAudio){try{typeof AudioContext<"u"?i.ctx=new AudioContext:typeof webkitAudioContext<"u"?i.ctx=new webkitAudioContext:i.usingWebAudio=!1}catch{i.usingWebAudio=!1}i.ctx||(i.usingWebAudio=!1);var e=/iP(hone|od|ad)/.test(i._navigator&&i._navigator.platform),r=i._navigator&&i._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),n=r?parseInt(r[1],10):null;if(e&&n&&n<9){var s=/safari/.test(i._navigator&&i._navigator.userAgent.toLowerCase());i._navigator&&!s&&(i.usingWebAudio=!1)}i.usingWebAudio&&(i.masterGain=typeof i.ctx.createGain>"u"?i.ctx.createGainNode():i.ctx.createGain(),i.masterGain.gain.setValueAtTime(i._muted?0:i._volume,i.ctx.currentTime),i.masterGain.connect(i.ctx.destination)),i._setup()}};ee.Howler=i,ee.Howl=p,typeof J<"u"?(J.HowlerGlobal=y,J.Howler=i,J.Howl=p,J.Sound=c):typeof window<"u"&&(window.HowlerGlobal=y,window.Howler=i,window.Howl=p,window.Sound=c)})();/*!
 *  Spatial Plugin - Adds support for stereo and 3D audio where Web Audio is supported.
 *  
 *  howler.js v2.2.3
 *  howlerjs.com
 *
 *  (c) 2013-2020, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */(function(){HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(i){var p=this;if(!p.ctx||!p.ctx.listener)return p;for(var c=p._howls.length-1;c>=0;c--)p._howls[c].stereo(i);return p},HowlerGlobal.prototype.pos=function(i,p,c){var C=this;if(!C.ctx||!C.ctx.listener)return C;if(p=typeof p!="number"?C._pos[1]:p,c=typeof c!="number"?C._pos[2]:c,typeof i=="number")C._pos=[i,p,c],typeof C.ctx.listener.positionX<"u"?(C.ctx.listener.positionX.setTargetAtTime(C._pos[0],Howler.ctx.currentTime,.1),C.ctx.listener.positionY.setTargetAtTime(C._pos[1],Howler.ctx.currentTime,.1),C.ctx.listener.positionZ.setTargetAtTime(C._pos[2],Howler.ctx.currentTime,.1)):C.ctx.listener.setPosition(C._pos[0],C._pos[1],C._pos[2]);else return C._pos;return C},HowlerGlobal.prototype.orientation=function(i,p,c,C,B,N){var I=this;if(!I.ctx||!I.ctx.listener)return I;var L=I._orientation;if(p=typeof p!="number"?L[1]:p,c=typeof c!="number"?L[2]:c,C=typeof C!="number"?L[3]:C,B=typeof B!="number"?L[4]:B,N=typeof N!="number"?L[5]:N,typeof i=="number")I._orientation=[i,p,c,C,B,N],typeof I.ctx.listener.forwardX<"u"?(I.ctx.listener.forwardX.setTargetAtTime(i,Howler.ctx.currentTime,.1),I.ctx.listener.forwardY.setTargetAtTime(p,Howler.ctx.currentTime,.1),I.ctx.listener.forwardZ.setTargetAtTime(c,Howler.ctx.currentTime,.1),I.ctx.listener.upX.setTargetAtTime(C,Howler.ctx.currentTime,.1),I.ctx.listener.upY.setTargetAtTime(B,Howler.ctx.currentTime,.1),I.ctx.listener.upZ.setTargetAtTime(N,Howler.ctx.currentTime,.1)):I.ctx.listener.setOrientation(i,p,c,C,B,N);else return L;return I},Howl.prototype.init=function(i){return function(p){var c=this;return c._orientation=p.orientation||[1,0,0],c._stereo=p.stereo||null,c._pos=p.pos||null,c._pannerAttr={coneInnerAngle:typeof p.coneInnerAngle<"u"?p.coneInnerAngle:360,coneOuterAngle:typeof p.coneOuterAngle<"u"?p.coneOuterAngle:360,coneOuterGain:typeof p.coneOuterGain<"u"?p.coneOuterGain:0,distanceModel:typeof p.distanceModel<"u"?p.distanceModel:"inverse",maxDistance:typeof p.maxDistance<"u"?p.maxDistance:1e4,panningModel:typeof p.panningModel<"u"?p.panningModel:"HRTF",refDistance:typeof p.refDistance<"u"?p.refDistance:1,rolloffFactor:typeof p.rolloffFactor<"u"?p.rolloffFactor:1},c._onstereo=p.onstereo?[{fn:p.onstereo}]:[],c._onpos=p.onpos?[{fn:p.onpos}]:[],c._onorientation=p.onorientation?[{fn:p.onorientation}]:[],i.call(this,p)}}(Howl.prototype.init),Howl.prototype.stereo=function(i,p){var c=this;if(!c._webAudio)return c;if(c._state!=="loaded")return c._queue.push({event:"stereo",action:function(){c.stereo(i,p)}}),c;var C=typeof Howler.ctx.createStereoPanner>"u"?"spatial":"stereo";if(typeof p>"u")if(typeof i=="number")c._stereo=i,c._pos=[i,0,0];else return c._stereo;for(var B=c._getSoundIds(p),N=0;N<B.length;N++){var I=c._soundById(B[N]);if(I)if(typeof i=="number")I._stereo=i,I._pos=[i,0,0],I._node&&(I._pannerAttr.panningModel="equalpower",(!I._panner||!I._panner.pan)&&y(I,C),C==="spatial"?typeof I._panner.positionX<"u"?(I._panner.positionX.setValueAtTime(i,Howler.ctx.currentTime),I._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),I._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):I._panner.setPosition(i,0,0):I._panner.pan.setValueAtTime(i,Howler.ctx.currentTime)),c._emit("stereo",I._id);else return I._stereo}return c},Howl.prototype.pos=function(i,p,c,C){var B=this;if(!B._webAudio)return B;if(B._state!=="loaded")return B._queue.push({event:"pos",action:function(){B.pos(i,p,c,C)}}),B;if(p=typeof p!="number"?0:p,c=typeof c!="number"?-.5:c,typeof C>"u")if(typeof i=="number")B._pos=[i,p,c];else return B._pos;for(var N=B._getSoundIds(C),I=0;I<N.length;I++){var L=B._soundById(N[I]);if(L)if(typeof i=="number")L._pos=[i,p,c],L._node&&((!L._panner||L._panner.pan)&&y(L,"spatial"),typeof L._panner.positionX<"u"?(L._panner.positionX.setValueAtTime(i,Howler.ctx.currentTime),L._panner.positionY.setValueAtTime(p,Howler.ctx.currentTime),L._panner.positionZ.setValueAtTime(c,Howler.ctx.currentTime)):L._panner.setPosition(i,p,c)),B._emit("pos",L._id);else return L._pos}return B},Howl.prototype.orientation=function(i,p,c,C){var B=this;if(!B._webAudio)return B;if(B._state!=="loaded")return B._queue.push({event:"orientation",action:function(){B.orientation(i,p,c,C)}}),B;if(p=typeof p!="number"?B._orientation[1]:p,c=typeof c!="number"?B._orientation[2]:c,typeof C>"u")if(typeof i=="number")B._orientation=[i,p,c];else return B._orientation;for(var N=B._getSoundIds(C),I=0;I<N.length;I++){var L=B._soundById(N[I]);if(L)if(typeof i=="number")L._orientation=[i,p,c],L._node&&(L._panner||(L._pos||(L._pos=B._pos||[0,0,-.5]),y(L,"spatial")),typeof L._panner.orientationX<"u"?(L._panner.orientationX.setValueAtTime(i,Howler.ctx.currentTime),L._panner.orientationY.setValueAtTime(p,Howler.ctx.currentTime),L._panner.orientationZ.setValueAtTime(c,Howler.ctx.currentTime)):L._panner.setOrientation(i,p,c)),B._emit("orientation",L._id);else return L._orientation}return B},Howl.prototype.pannerAttr=function(){var i=this,p=arguments,c,C,B;if(!i._webAudio)return i;if(p.length===0)return i._pannerAttr;if(p.length===1)if(typeof p[0]=="object")c=p[0],typeof C>"u"&&(c.pannerAttr||(c.pannerAttr={coneInnerAngle:c.coneInnerAngle,coneOuterAngle:c.coneOuterAngle,coneOuterGain:c.coneOuterGain,distanceModel:c.distanceModel,maxDistance:c.maxDistance,refDistance:c.refDistance,rolloffFactor:c.rolloffFactor,panningModel:c.panningModel}),i._pannerAttr={coneInnerAngle:typeof c.pannerAttr.coneInnerAngle<"u"?c.pannerAttr.coneInnerAngle:i._coneInnerAngle,coneOuterAngle:typeof c.pannerAttr.coneOuterAngle<"u"?c.pannerAttr.coneOuterAngle:i._coneOuterAngle,coneOuterGain:typeof c.pannerAttr.coneOuterGain<"u"?c.pannerAttr.coneOuterGain:i._coneOuterGain,distanceModel:typeof c.pannerAttr.distanceModel<"u"?c.pannerAttr.distanceModel:i._distanceModel,maxDistance:typeof c.pannerAttr.maxDistance<"u"?c.pannerAttr.maxDistance:i._maxDistance,refDistance:typeof c.pannerAttr.refDistance<"u"?c.pannerAttr.refDistance:i._refDistance,rolloffFactor:typeof c.pannerAttr.rolloffFactor<"u"?c.pannerAttr.rolloffFactor:i._rolloffFactor,panningModel:typeof c.pannerAttr.panningModel<"u"?c.pannerAttr.panningModel:i._panningModel});else return B=i._soundById(parseInt(p[0],10)),B?B._pannerAttr:i._pannerAttr;else p.length===2&&(c=p[0],C=parseInt(p[1],10));for(var N=i._getSoundIds(C),I=0;I<N.length;I++)if(B=i._soundById(N[I]),B){var L=B._pannerAttr;L={coneInnerAngle:typeof c.coneInnerAngle<"u"?c.coneInnerAngle:L.coneInnerAngle,coneOuterAngle:typeof c.coneOuterAngle<"u"?c.coneOuterAngle:L.coneOuterAngle,coneOuterGain:typeof c.coneOuterGain<"u"?c.coneOuterGain:L.coneOuterGain,distanceModel:typeof c.distanceModel<"u"?c.distanceModel:L.distanceModel,maxDistance:typeof c.maxDistance<"u"?c.maxDistance:L.maxDistance,refDistance:typeof c.refDistance<"u"?c.refDistance:L.refDistance,rolloffFactor:typeof c.rolloffFactor<"u"?c.rolloffFactor:L.rolloffFactor,panningModel:typeof c.panningModel<"u"?c.panningModel:L.panningModel};var q=B._panner;q?(q.coneInnerAngle=L.coneInnerAngle,q.coneOuterAngle=L.coneOuterAngle,q.coneOuterGain=L.coneOuterGain,q.distanceModel=L.distanceModel,q.maxDistance=L.maxDistance,q.refDistance=L.refDistance,q.rolloffFactor=L.rolloffFactor,q.panningModel=L.panningModel):(B._pos||(B._pos=i._pos||[0,0,-.5]),y(B,"spatial"))}return i},Sound.prototype.init=function(i){return function(){var p=this,c=p._parent;p._orientation=c._orientation,p._stereo=c._stereo,p._pos=c._pos,p._pannerAttr=c._pannerAttr,i.call(this),p._stereo?c.stereo(p._stereo):p._pos&&c.pos(p._pos[0],p._pos[1],p._pos[2],p._id)}}(Sound.prototype.init),Sound.prototype.reset=function(i){return function(){var p=this,c=p._parent;return p._orientation=c._orientation,p._stereo=c._stereo,p._pos=c._pos,p._pannerAttr=c._pannerAttr,p._stereo?c.stereo(p._stereo):p._pos?c.pos(p._pos[0],p._pos[1],p._pos[2],p._id):p._panner&&(p._panner.disconnect(0),p._panner=void 0,c._refreshBuffer(p)),i.call(this)}}(Sound.prototype.reset);var y=function(i,p){p=p||"spatial",p==="spatial"?(i._panner=Howler.ctx.createPanner(),i._panner.coneInnerAngle=i._pannerAttr.coneInnerAngle,i._panner.coneOuterAngle=i._pannerAttr.coneOuterAngle,i._panner.coneOuterGain=i._pannerAttr.coneOuterGain,i._panner.distanceModel=i._pannerAttr.distanceModel,i._panner.maxDistance=i._pannerAttr.maxDistance,i._panner.refDistance=i._pannerAttr.refDistance,i._panner.rolloffFactor=i._pannerAttr.rolloffFactor,i._panner.panningModel=i._pannerAttr.panningModel,typeof i._panner.positionX<"u"?(i._panner.positionX.setValueAtTime(i._pos[0],Howler.ctx.currentTime),i._panner.positionY.setValueAtTime(i._pos[1],Howler.ctx.currentTime),i._panner.positionZ.setValueAtTime(i._pos[2],Howler.ctx.currentTime)):i._panner.setPosition(i._pos[0],i._pos[1],i._pos[2]),typeof i._panner.orientationX<"u"?(i._panner.orientationX.setValueAtTime(i._orientation[0],Howler.ctx.currentTime),i._panner.orientationY.setValueAtTime(i._orientation[1],Howler.ctx.currentTime),i._panner.orientationZ.setValueAtTime(i._orientation[2],Howler.ctx.currentTime)):i._panner.setOrientation(i._orientation[0],i._orientation[1],i._orientation[2])):(i._panner=Howler.ctx.createStereoPanner(),i._panner.pan.setValueAtTime(i._stereo,Howler.ctx.currentTime)),i._panner.connect(i._node),i._paused||i._parent.pause(i._id,!0).play(i._id,!0)}})()})(ut);const Dt=ee=>nt({url:"/group/get_user_list_by_id",method:"POST",data:ee}),Qe=ee=>nt({url:"/upload/file",method:"POST",data:ee});var Pe=(ee=>(ee[ee.text=0]="text",ee[ee.image=1]="image",ee[ee.audio=2]="audio",ee[ee.file=3]="file",ee))(Pe||{});const Bt=(ee,y)=>{const i=document.createElement("a");return i.style.display="none",i.setAttribute("href",ee),i.setAttribute("download",y),document.body.appendChild(i),setTimeout(function(){i.click(),document.body.removeChild(i)},66),!0},It="/web/assets/camera_fill.e869dfbd.svg",Ft="/web/assets/photo_fill.f7d7b398.svg",Ot="/web/assets/video_dial_fill.2e920b0f.svg",ft="/web/assets/file_fill.fa998c17.svg",Pt="/web/assets/yuyin_fill.fd28a397.svg",Et=[{key:"photo",text:"\u7167\u7247",icon:Ft},{key:"camera",text:"\u62CD\u6444",icon:It},{key:"friend_call",text:"\u8BED\u97F3",icon:Pt},{key:"video_call",text:"\u89C6\u9891",icon:Ot},{key:"file",text:"\u6587\u4EF6",icon:ft}],Ut={class:"container"},Ht={class:"header"},Gt=["src"],Vt={class:"content",id:"msg_content"},Nt=["id"],jt={class:"avatar"},Wt=["src"],qt={class:"time"},$t=["onClick"],zt=["src"],Xt=["src"],Yt={class:"footer"},Qt={class:"toolbar"},Zt={class:"card"},Kt={key:0},Jt={class:"gird-box"},er=["src"],tr={key:1},rr={class:"gird-box"},nr=["src"],ir=["onClick"],or={class:"gird-box"},ar=["src"],sr={class:"form"},dr=["placeholder"],ur=it({__name:"index",props:["rid","is_group","nickname","avatar"],setup(ee){const y=ee,i=ot(),p=gt(),c=Lt(),C=Fe(""),B=Fe([]),N=Fe(!1),I=Fe(!1),L=Fe(null),q=Ze(()=>{var E,G;return{cmd:y.is_group?tt.group_chat:tt.private_chat,rid:Number(y.rid),is_group:Boolean(y.is_group),to_nickname:y.nickname,to_avatar:y.avatar,from_nickname:(E=p.userInfo)==null?void 0:E.nickname,from_avatar:(G=p.userInfo)==null?void 0:G.avatar}}),e=()=>{i.send({...q.value,content:C.value||"Hello",type:Pe.text})},r=E=>{var G;return E===((G=p.userInfo)==null?void 0:G.id)},n=(E,G)=>{var Z;if(r(E))return(Z=p.userInfo)==null?void 0:Z.avatar;const X=B.value.find(ae=>ae.id===E);return X?X.avatar:""},s=(E,G)=>{var Z;if(r(E))return(Z=p.userInfo)==null?void 0:Z.nickname;const X=B.value.find(ae=>ae.id===E);return X?X.nickname:""},h=Ze(()=>i.list.filter(G=>{const X=G.suid===Number(y.rid),Z=G.rid===Number(y.rid);return(X||Z)&&Number(G.is_group)===y.is_group}).map(G=>({...G,is_me:r(G.suid),avatar:n(G.suid),nickname:s(G.suid)}))),v=async()=>{if(I.value)return;const G=document.querySelectorAll(".msg-item")[0].getAttribute("id");I.value=!0,i.list.filter(X=>{const Z=X.suid===y.rid,ae=X.rid===y.rid;return(Z||ae)&&Number(X.is_group)===y.is_group});try{await St(500),await i.queryHistory({rid:y.rid,seq:h.value.length?h.value[0].time:0,is_group:Boolean(y.is_group)}),I.value=!1,setTimeout(()=>{const X=document.querySelector(`#${G}`);i.scrollTo(X.offsetTop)},100)}catch(X){I.value=!1,N.value=X.message}},f=()=>{y.is_group?Dt({id:y.rid}).then(E=>{B.value=E.data.list}):c.queryProfile([y.rid]).then(E=>{B.value=E}),i.markHasRead({pid:y.rid})},F=Fe(!1),$=E=>{const G=E.target;!G||G.id!=="chat-input"||((E.code==="ShiftLeft"||E.code==="ShiftRight")&&(F.value=!0),E.code==="Enter"&&(E.preventDefault(),F.value?C.value=C.value+`
`:C.value.length&&(e(),C.value="")))},V=E=>{const G=E.target;!G||G.id!=="chat-input"||(E.code==="ShiftLeft"||E.code==="ShiftRight")&&(F.value=!1)};yt(()=>{f(),document.addEventListener("keydown",$),document.addEventListener("keyup",V)}),bt(()=>{document.removeEventListener("keydown",$),document.removeEventListener("keyup",V)}),wt(()=>{var E;(E=L.value)==null||E.addEventListener("scroll",G=>{G.target.scrollTop===0&&v()})});const fe=E=>at(E).format("hh:mm:ss"),ge=E=>{const G=new FormData;G.append("file",E.file),Qe(G).then(X=>{X.data&&i.send({...q.value,content:X.data.url,type:Pe.image,title:E.file.name})})},ce=E=>{const G=new FormData;G.append("file",E.file),Qe(G).then(X=>{X.data&&i.send({...q.value,content:X.data.url,title:E.file.name,type:Pe.file})})},pe=async E=>{if(E.key==="video_call"){y.is_group||i.setDialUser({id:y.rid,nickname:y.nickname,avatar:y.avatar});return}if(E.key==="friend_call"){let G=await navigator.mediaDevices.getUserMedia({video:!0,audio:!0}),X=new dt.exports.RecordRTCPromisesHandler(G,{type:"audio"});X.startRecording();const Z=Y=>new Promise(Be=>setTimeout(Be,Y));kt("\u5F55\u52363S"),await Z(3e3),await X.stopRecording();let ae=await X.getBlob();const xe=new FormData;xe.append("file",ae),Qe(xe).then(Y=>{Y.data&&i.send({...q.value,content:Y.data.url,type:Pe.audio})})}},W=E=>{var G=new ut.Howl({src:[E]});console.log(G),G.play()},Ae=(E,G)=>{Bt(E,G)};return(E,G)=>{const X=Ne("VanLoading"),Z=Ne("van-icon"),ae=Ne("van-loading"),xe=Ne("van-uploader");return te(),re("div",Ut,[K("div",Ht,[K("img",{src:y.avatar,alt:""},null,8,Gt),K("span",null,ke(y.nickname),1)]),K("div",{class:"list",id:"msg_list",ref_key:"scrollRef",ref:L},[K("div",Vt,[I.value?(te(),Ee(X,{key:0,class:"list-loading",size:"small"})):Se("",!0),(te(!0),re(Ue,null,Ke(ve(h),Y=>(te(),re("div",{class:je(["item msg-item",{"is-me":Y.is_me}]),id:"msg-item-"+Y.time},[K("div",jt,[K("img",{src:Y.avatar,alt:""},null,8,Wt)]),K("div",{class:je(["main",{"is-me":Y.is_me}])},[K("span",qt,ke(fe(Y.create_time)),1),K("div",{class:je(["content","msg-content-type-"+Y.type])},[Y.type===0?(te(),re(Ue,{key:0},[Tt(ke(Y.content),1)],64)):Se("",!0),Y.type===3?(te(),re("div",{key:1,onClick:Be=>Ae(Y.content,Y.title)},[K("span",null,ke(Y.title||"\u6587\u4EF6"),1),K("img",{class:"msg-icon",src:ve(ft),alt:""},null,8,zt)],8,$t)):Se("",!0),Y.type===1?(te(),re("img",{key:2,style:{"max-width":"80%"},src:Y.content,alt:""},null,8,Xt)):Se("",!0),Y.type===2?(te(),Ee(Z,{key:3,onClick:Be=>W(Y.content),size:20,name:"volume-o"},null,8,["onClick"])):Se("",!0),Y.loading?(te(),Ee(ae,{key:4,class:"loading",size:"20px",type:"spinner"})):Se("",!0)],2)],2)],10,Nt))),256))])],512),K("div",Yt,[K("div",Qt,[K("div",Zt,[(te(!0),re(Ue,null,Ke(ve(Et),Y=>(te(),re("div",{class:"grid-item",key:Y.key},[Y.key==="photo"?(te(),re("div",Kt,[rt(xe,{"after-read":ge},{default:We(()=>[K("div",Jt,[K("img",{class:"grid-icon",src:Y.icon,alt:""},null,8,er)])]),_:2},1024)])):Y.key==="file"?(te(),re("div",tr,[rt(xe,{"after-read":ce,accept:"image/*,.pdj,.zip,.doc,.docx,.xml,.pptx"},{default:We(()=>[K("div",rr,[K("img",{class:"grid-icon",src:Y.icon,alt:""},null,8,nr)])]),_:2},1024)])):(te(),re("div",{key:2,onClick:Be=>pe(Y)},[K("div",or,[K("img",{class:"grid-icon",src:Y.icon,alt:""},null,8,ar)])],8,ir))]))),128))])]),K("div",sr,[At(K("textarea",{id:"chat-input",class:"input","onUpdate:modelValue":G[0]||(G[0]=Y=>C.value=Y),name:"content",placeholder:"\u6B63\u5728\u548C"+y.nickname+"\u5BF9\u8BDD"},null,8,dr),[[Rt,C.value]])])])])}}});const fr=st(ur,[["__scopeId","data-v-2aae90b6"]]),lt=ee=>(xt("data-v-7c47d11a"),ee=ee(),Ct(),ee),lr=["onClick"],cr={class:"avatar"},pr={key:0,class:"badge"},hr=["src"],mr={class:"main"},_r={class:"head"},vr={class:"name"},gr={key:0,class:"date"},yr={class:"content"},br={key:0},wr={key:1},Ar={key:2},Rr={key:1,class:"m-box"},Tr=lt(()=>K("div",{class:"morning"},null,-1)),Sr=lt(()=>K("span",{class:"tip"},"\u7F8E\u597D\u7684\u4E00\u5929\u53C8\u5F00\u59CB\u4E86\uFF5E",-1)),kr=[Tr,Sr],xr=it({__name:"index",setup(ee){const y=ot(),i=C=>{y.setCurrentChat({rid:`${C.partner_id}`,nickname:C.nickname,avatar:C.avatar,is_group:Number(C.is_group)})},p=C=>at(C).format("MM/DD hh:mm"),c=Ze(()=>y.sessionList.map(C=>({...C})));return(C,B)=>(te(),Ee(Mt,null,{nav:We(()=>[(te(!0),re(Ue,null,Ke(ve(c),N=>{var I,L;return te(),re("div",{class:je(["item",{active:ve(y).currentChat&&+ve(y).currentChat.rid===N.partner_id}]),onClick:q=>i(N)},[K("div",cr,[N.unread?(te(),re("span",pr,ke(N.unread),1)):Se("",!0),K("img",{src:N.avatar,alt:""},null,8,hr)]),K("div",mr,[K("div",_r,[K("div",vr,ke(N.nickname)+"("+ke(N.partner_id)+")",1),(I=N.last_message)!=null&&I.create_time?(te(),re("div",gr,ke(p((L=N.last_message)==null?void 0:L.create_time)),1)):Se("",!0)]),K("div",yr,[N.last_message?(te(),re(Ue,{key:0},[N.last_message.type===1?(te(),re("div",br,"[\u56FE\u7247]")):N.last_message.type===3?(te(),re("div",wr,"[\u6587\u4EF6]")):(te(),re("div",Ar,ke(N.last_message.content||""),1))],64)):Se("",!0)])])],10,lr)}),256))]),main:We(()=>[ve(y).currentChat?(te(),Ee(fr,{key:0,rid:Number(ve(y).currentChat.rid),is_group:Number(ve(y).currentChat.is_group||0),nickname:ve(y).currentChat.nickname,avatar:ve(y).currentChat.avatar},null,8,["rid","is_group","nickname","avatar"])):(te(),re("div",Rr,kr))]),_:1}))}});const Mr=st(xr,[["__scopeId","data-v-7c47d11a"]]);export{Mr as default};
