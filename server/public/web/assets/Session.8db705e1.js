import{c as Y,r as it,d as ot,u as at,a as gt,b as Fe,e as Ke,o as yt,w as bt,f as re,g as Z,h as je,i as Re,F as Ee,j as Je,k as ge,l as Pe,m as We,C as rt,n as De,p as J,q as qe,t as Ce,s as nt,v as st,T as wt,x as At,_ as dt}from"./index.656158b6.js";import{u as Rt}from"./friend.6c300736.js";var ut={exports:{}};(function(K){/**
 * {@link https://github.com/muaz-khan/RecordRTC|RecordRTC} is a WebRTC JavaScript library for audio/video as well as screen activity recording. It supports Chrome, Firefox, Opera, Android, and Microsoft Edge. Platforms: Linux, Mac and Windows. 
 * @summary Record audio, video or screen inside the browser.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef RecordRTC
 * @class
 * @example
 * var recorder = RecordRTC(mediaStream or [arrayOfMediaStream], {
 *     type: 'video', // audio or video or gif or canvas
 *     recorderType: MediaStreamRecorder || CanvasRecorder || StereoAudioRecorder || Etc
 * });
 * recorder.startRecording();
 * @see For further information:
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - Single media-stream object, array of media-streams, html-canvas-element, etc.
 * @param {object} config - {type:"video", recorderType: MediaStreamRecorder, disableLogs: true, numberOfAudioChannels: 1, bufferSize: 0, sampleRate: 0, desiredSampRate: 16000, video: HTMLVideoElement, etc.}
 */function y(a,t){if(!a)throw"First parameter is required.";t=t||{type:"video"},t=new i(a,t);var o=this;function m(l){return t.disableLogs||console.log("RecordRTC version: ",o.version),l&&(t=new i(a,l)),t.disableLogs||console.log("started recording "+t.type+" stream."),A?(A.clearRecordedData(),A.record(),D("recording"),o.recordingDuration&&R(),o):(g(function(){o.recordingDuration&&R()}),o)}function g(l){l&&(t.initCallback=function(){l(),l=t.initCallback=null});var C=new p(a,t);A=new C(a,t),A.record(),D("recording"),t.disableLogs||console.log("Initialized recorderType:",A.constructor.name,"for output-type:",t.type)}function _(l){if(l=l||function(){},!A){L();return}if(o.state==="paused"){o.resumeRecording(),setTimeout(function(){_(l)},1);return}o.state!=="recording"&&!t.disableLogs&&console.warn('Recording state should be: "recording", however current state is: ',o.state),t.disableLogs||console.log("Stopped recording "+t.type+" stream."),t.type!=="gif"?A.stop(C):(A.stop(),C()),D("stopped");function C(H){if(!A){typeof l.call=="function"?l.call(o,""):l("");return}Object.keys(A).forEach(function(P){typeof A[P]!="function"&&(o[P]=A[P])});var u=A.blob;if(!u)if(H)A.blob=u=H;else throw"Recording failed.";if(u&&!t.disableLogs&&console.log(u.type,"->",f(u.size)),l){var b;try{b=N.createObjectURL(u)}catch{}typeof l.call=="function"?l.call(o,b):l(b)}!t.autoWriteToDisk||B(function(P){var U={};U[t.type+"Blob"]=P,ee.Store(U)})}}function w(){if(!A){L();return}if(o.state!=="recording"){t.disableLogs||console.warn("Unable to pause the recording. Recording state: ",o.state);return}D("paused"),A.pause(),t.disableLogs||console.log("Paused recording.")}function d(){if(!A){L();return}if(o.state!=="paused"){t.disableLogs||console.warn("Unable to resume the recording. Recording state: ",o.state);return}D("recording"),A.resume(),t.disableLogs||console.log("Resumed recording.")}function T(l){postMessage(new FileReaderSync().readAsDataURL(l))}function B(l,C){if(!l)throw"Pass a callback function over getDataURL.";var H=C?C.blob:(A||{}).blob;if(!H){t.disableLogs||console.warn("Blob encoder did not finish its job yet."),setTimeout(function(){B(l,C)},1e3);return}if(typeof Worker<"u"&&!navigator.mozGetUserMedia){var u=P(T);u.onmessage=function(U){l(U.data)},u.postMessage(H)}else{var b=new FileReader;b.readAsDataURL(H),b.onload=function(U){l(U.target.result)}}function P(U){try{var z=N.createObjectURL(new Blob([U.toString(),"this.onmessage =  function (eee) {"+U.name+"(eee.data);}"],{type:"application/javascript"})),W=new Worker(z);return N.revokeObjectURL(z),W}catch{}}}function R(l){if(l=l||0,o.state==="paused"){setTimeout(function(){R(l)},1e3);return}if(o.state!=="stopped"){if(l>=o.recordingDuration){_(o.onRecordingStopped);return}l+=1e3,setTimeout(function(){R(l)},1e3)}}function D(l){!o||(o.state=l,typeof o.onStateChanged.call=="function"?o.onStateChanged.call(o,l):o.onStateChanged(l))}var S='It seems that recorder is destroyed or "startRecording" is not invoked for '+t.type+" recorder.";function L(){t.disableLogs!==!0&&console.warn(S)}var A,E={startRecording:m,stopRecording:_,pauseRecording:w,resumeRecording:d,initRecorder:g,setRecordingDuration:function(l,C){if(typeof l>"u")throw"recordingDuration is required.";if(typeof l!="number")throw"recordingDuration must be a number.";return o.recordingDuration=l,o.onRecordingStopped=C||function(){},{onRecordingStopped:function(H){o.onRecordingStopped=H}}},clearRecordedData:function(){if(!A){L();return}A.clearRecordedData(),t.disableLogs||console.log("Cleared old recorded data.")},getBlob:function(){if(!A){L();return}return A.blob},getDataURL:B,toURL:function(){if(!A){L();return}return N.createObjectURL(A.blob)},getInternalRecorder:function(){return A},save:function(l){if(!A){L();return}O(A.blob,l)},getFromDisk:function(l){if(!A){L();return}y.getFromDisk(t.type,l)},setAdvertisementArray:function(l){t.advertisement=[];for(var C=l.length,H=0;H<C;H++)t.advertisement.push({duration:H,image:l[H]})},blob:null,bufferSize:0,sampleRate:0,buffer:null,reset:function(){o.state==="recording"&&!t.disableLogs&&console.warn("Stop an active recorder."),A&&typeof A.clearRecordedData=="function"&&A.clearRecordedData(),A=null,D("inactive"),o.blob=null},onStateChanged:function(l){t.disableLogs||console.log("Recorder state changed:",l)},state:"inactive",getState:function(){return o.state},destroy:function(){var l=t.disableLogs;t={disableLogs:!0},o.reset(),D("destroyed"),E=o=null,ce.AudioContextConstructor&&(ce.AudioContextConstructor.close(),ce.AudioContextConstructor=null),t.disableLogs=l,t.disableLogs||console.log("RecordRTC is destroyed.")},version:"5.6.2"};if(!this)return o=E,E;for(var j in E)this[j]=E[j];return o=this,E}y.version="5.6.2",K.exports=y,y.getFromDisk=function(a,t){if(!t)throw"callback is mandatory.";console.log("Getting recorded "+(a==="all"?"blobs":a+" blob ")+" from disk!"),ee.Fetch(function(o,m){a!=="all"&&m===a+"Blob"&&t&&t(o),a==="all"&&t&&t(o,m.replace("Blob",""))})},y.writeToDisk=function(a){console.log("Writing recorded blob(s) to disk!"),a=a||{},a.audio&&a.video&&a.gif?a.audio.getDataURL(function(t){a.video.getDataURL(function(o){a.gif.getDataURL(function(m){ee.Store({audioBlob:t,videoBlob:o,gifBlob:m})})})}):a.audio&&a.video?a.audio.getDataURL(function(t){a.video.getDataURL(function(o){ee.Store({audioBlob:t,videoBlob:o})})}):a.audio&&a.gif?a.audio.getDataURL(function(t){a.gif.getDataURL(function(o){ee.Store({audioBlob:t,gifBlob:o})})}):a.video&&a.gif?a.video.getDataURL(function(t){a.gif.getDataURL(function(o){ee.Store({videoBlob:t,gifBlob:o})})}):a.audio?a.audio.getDataURL(function(t){ee.Store({audioBlob:t})}):a.video?a.video.getDataURL(function(t){ee.Store({videoBlob:t})}):a.gif&&a.gif.getDataURL(function(t){ee.Store({gifBlob:t})})};/**
 * {@link RecordRTCConfiguration} is an inner/private helper for {@link RecordRTC}.
 * @summary It configures the 2nd parameter passed over {@link RecordRTC} and returns a valid "config" object.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef RecordRTCConfiguration
 * @class
 * @example
 * var options = RecordRTCConfiguration(mediaStream, options);
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @param {object} config - {type:"video", disableLogs: true, numberOfAudioChannels: 1, bufferSize: 0, sampleRate: 0, video: HTMLVideoElement, getNativeBlob:true, etc.}
 */function i(a,t){return!t.recorderType&&!t.type&&(!!t.audio&&!!t.video?t.type="video":!!t.audio&&!t.video&&(t.type="audio")),t.recorderType&&!t.type&&(t.recorderType===te||t.recorderType===$||typeof Oe<"u"&&t.recorderType===Oe?t.type="video":t.recorderType===he?t.type="gif":t.recorderType===G?t.type="audio":t.recorderType===k&&(V(a,"audio").length&&V(a,"video").length||!V(a,"audio").length&&V(a,"video").length?t.type="video":V(a,"audio").length&&!V(a,"video").length&&(t.type="audio"))),typeof k<"u"&&typeof MediaRecorder<"u"&&"requestData"in MediaRecorder.prototype&&(t.mimeType||(t.mimeType="video/webm"),t.type||(t.type=t.mimeType.split("/")[0]),t.bitsPerSecond),t.type||(t.mimeType&&(t.type=t.mimeType.split("/")[0]),t.type||(t.type="audio")),t}/**
 * {@link GetRecorderType} is an inner/private helper for {@link RecordRTC}.
 * @summary It returns best recorder-type available for your browser.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef GetRecorderType
 * @class
 * @example
 * var RecorderType = GetRecorderType(options);
 * var recorder = new RecorderType(options);
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @param {object} config - {type:"video", disableLogs: true, numberOfAudioChannels: 1, bufferSize: 0, sampleRate: 0, video: HTMLVideoElement, etc.}
 */function p(a,t){var o;return(s||e||r)&&(o=G),typeof MediaRecorder<"u"&&"requestData"in MediaRecorder.prototype&&!s&&(o=k),t.type==="video"&&(s||r)&&(o=te,typeof Oe<"u"&&typeof ReadableStream<"u"&&(o=Oe)),t.type==="gif"&&(o=he),t.type==="canvas"&&(o=$),pe()&&o!==$&&o!==he&&typeof MediaRecorder<"u"&&"requestData"in MediaRecorder.prototype&&(V(a,"video").length||V(a,"audio").length)&&(t.type==="audio"?typeof MediaRecorder.isTypeSupported=="function"&&MediaRecorder.isTypeSupported("audio/webm")&&(o=k):typeof MediaRecorder.isTypeSupported=="function"&&MediaRecorder.isTypeSupported("video/webm")&&(o=k)),a instanceof Array&&a.length&&(o=X),t.recorderType&&(o=t.recorderType),!t.disableLogs&&!!o&&!!o.name&&console.log("Using recorderType:",o.name||o.constructor.name),!o&&h&&(o=k),o}/**
 * MRecordRTC runs on top of {@link RecordRTC} to bring multiple recordings in a single place, by providing simple API.
 * @summary MRecordRTC stands for "Multiple-RecordRTC".
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef MRecordRTC
 * @class
 * @example
 * var recorder = new MRecordRTC();
 * recorder.addStream(MediaStream);
 * recorder.mediaType = {
 *     audio: true, // or StereoAudioRecorder or MediaStreamRecorder
 *     video: true, // or WhammyRecorder or MediaStreamRecorder or WebAssemblyRecorder or CanvasRecorder
 *     gif: true    // or GifRecorder
 * };
 * // mimeType is optional and should be set only in advance cases.
 * recorder.mimeType = {
 *     audio: 'audio/wav',
 *     video: 'video/webm',
 *     gif:   'image/gif'
 * };
 * recorder.startRecording();
 * @see For further information:
 * @see {@link https://github.com/muaz-khan/RecordRTC/tree/master/MRecordRTC|MRecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @requires {@link RecordRTC}
 */function c(a){this.addStream=function(t){t&&(a=t)},this.mediaType={audio:!0,video:!0},this.startRecording=function(){var t=this.mediaType,o,m=this.mimeType||{audio:null,video:null,gif:null};if(typeof t.audio!="function"&&pe()&&!V(a,"audio").length&&(t.audio=!1),typeof t.video!="function"&&pe()&&!V(a,"video").length&&(t.video=!1),typeof t.gif!="function"&&pe()&&!V(a,"video").length&&(t.gif=!1),!t.audio&&!t.video&&!t.gif)throw"MediaStream must have either audio or video tracks.";if(t.audio&&(o=null,typeof t.audio=="function"&&(o=t.audio),this.audioRecorder=new y(a,{type:"audio",bufferSize:this.bufferSize,sampleRate:this.sampleRate,numberOfAudioChannels:this.numberOfAudioChannels||2,disableLogs:this.disableLogs,recorderType:o,mimeType:m.audio,timeSlice:this.timeSlice,onTimeStamp:this.onTimeStamp}),t.video||this.audioRecorder.startRecording()),t.video){o=null,typeof t.video=="function"&&(o=t.video);var g=a;if(pe()&&!!t.audio&&typeof t.audio=="function"){var _=V(a,"video")[0];n?(g=new v,g.addTrack(_),o&&o===te&&(o=k)):(g=new v,g.addTrack(_))}this.videoRecorder=new y(g,{type:"video",video:this.video,canvas:this.canvas,frameInterval:this.frameInterval||10,disableLogs:this.disableLogs,recorderType:o,mimeType:m.video,timeSlice:this.timeSlice,onTimeStamp:this.onTimeStamp,workerPath:this.workerPath,webAssemblyPath:this.webAssemblyPath,frameRate:this.frameRate,bitrate:this.bitrate}),t.audio||this.videoRecorder.startRecording()}if(!!t.audio&&!!t.video){var w=this,d=pe()===!0;(t.audio instanceof G&&!!t.video||t.audio!==!0&&t.video!==!0&&t.audio!==t.video)&&(d=!1),d===!0?(w.audioRecorder=null,w.videoRecorder.startRecording()):w.videoRecorder.initRecorder(function(){w.audioRecorder.initRecorder(function(){w.videoRecorder.startRecording(),w.audioRecorder.startRecording()})})}t.gif&&(o=null,typeof t.gif=="function"&&(o=t.gif),this.gifRecorder=new y(a,{type:"gif",frameRate:this.frameRate||200,quality:this.quality||10,disableLogs:this.disableLogs,recorderType:o,mimeType:m.gif}),this.gifRecorder.startRecording())},this.stopRecording=function(t){t=t||function(){},this.audioRecorder&&this.audioRecorder.stopRecording(function(o){t(o,"audio")}),this.videoRecorder&&this.videoRecorder.stopRecording(function(o){t(o,"video")}),this.gifRecorder&&this.gifRecorder.stopRecording(function(o){t(o,"gif")})},this.pauseRecording=function(){this.audioRecorder&&this.audioRecorder.pauseRecording(),this.videoRecorder&&this.videoRecorder.pauseRecording(),this.gifRecorder&&this.gifRecorder.pauseRecording()},this.resumeRecording=function(){this.audioRecorder&&this.audioRecorder.resumeRecording(),this.videoRecorder&&this.videoRecorder.resumeRecording(),this.gifRecorder&&this.gifRecorder.resumeRecording()},this.getBlob=function(t){var o={};return this.audioRecorder&&(o.audio=this.audioRecorder.getBlob()),this.videoRecorder&&(o.video=this.videoRecorder.getBlob()),this.gifRecorder&&(o.gif=this.gifRecorder.getBlob()),t&&t(o),o},this.destroy=function(){this.audioRecorder&&(this.audioRecorder.destroy(),this.audioRecorder=null),this.videoRecorder&&(this.videoRecorder.destroy(),this.videoRecorder=null),this.gifRecorder&&(this.gifRecorder.destroy(),this.gifRecorder=null)},this.getDataURL=function(t){this.getBlob(function(g){g.audio&&g.video?o(g.audio,function(_){o(g.video,function(w){t({audio:_,video:w})})}):g.audio?o(g.audio,function(_){t({audio:_})}):g.video&&o(g.video,function(_){t({video:_})})});function o(g,_){if(typeof Worker<"u"){var w=m(function(B){postMessage(new FileReaderSync().readAsDataURL(B))});w.onmessage=function(T){_(T.data)},w.postMessage(g)}else{var d=new FileReader;d.readAsDataURL(g),d.onload=function(T){_(T.target.result)}}}function m(g){var _=N.createObjectURL(new Blob([g.toString(),"this.onmessage =  function (eee) {"+g.name+"(eee.data);}"],{type:"application/javascript"})),w=new Worker(_),d;if(typeof N<"u")d=N;else if(typeof webkitURL<"u")d=webkitURL;else throw"Neither URL nor webkitURL detected.";return d.revokeObjectURL(_),w}},this.writeToDisk=function(){y.writeToDisk({audio:this.audioRecorder,video:this.videoRecorder,gif:this.gifRecorder})},this.save=function(t){t=t||{audio:!0,video:!0,gif:!0},!!t.audio&&this.audioRecorder&&this.audioRecorder.save(typeof t.audio=="string"?t.audio:""),!!t.video&&this.videoRecorder&&this.videoRecorder.save(typeof t.video=="string"?t.video:""),!!t.gif&&this.gifRecorder&&this.gifRecorder.save(typeof t.gif=="string"?t.gif:"")}}c.getFromDisk=y.getFromDisk,c.writeToDisk=y.writeToDisk,typeof y<"u"&&(y.MRecordRTC=c);var F="Fake/5.0 (FakeOS) AppleWebKit/123 (KHTML, like Gecko) Fake/12.3.4567.89 Fake/123.45";(function(a){!a||typeof window<"u"||typeof Y>"u"||(Y.navigator={userAgent:F,getUserMedia:function(){}},Y.console||(Y.console={}),(typeof Y.console.log>"u"||typeof Y.console.error>"u")&&(Y.console.error=Y.console.log=Y.console.log||function(){console.log(arguments)}),typeof document>"u"&&(a.document={documentElement:{appendChild:function(){return""}}},document.createElement=document.captureStream=document.mozCaptureStream=function(){var t={getContext:function(){return t},play:function(){},pause:function(){},drawImage:function(){},toDataURL:function(){return""},style:{}};return t},a.HTMLVideoElement=function(){}),typeof location>"u"&&(a.location={protocol:"file:",href:"",hash:""}),typeof screen>"u"&&(a.screen={width:0,height:0}),typeof N>"u"&&(a.URL={createObjectURL:function(){return""},revokeObjectURL:function(){return""}}),a.window=Y)})(typeof Y<"u"?Y:null);var I=window.requestAnimationFrame;if(typeof I>"u"){if(typeof webkitRequestAnimationFrame<"u")I=webkitRequestAnimationFrame;else if(typeof mozRequestAnimationFrame<"u")I=mozRequestAnimationFrame;else if(typeof msRequestAnimationFrame<"u")I=msRequestAnimationFrame;else if(typeof I>"u"){var Q=0;I=function(a,t){var o=new Date().getTime(),m=Math.max(0,16-(o-Q)),g=setTimeout(function(){a(o+m)},m);return Q=o+m,g}}}var x=window.cancelAnimationFrame;typeof x>"u"&&(typeof webkitCancelAnimationFrame<"u"?x=webkitCancelAnimationFrame:typeof mozCancelAnimationFrame<"u"?x=mozCancelAnimationFrame:typeof msCancelAnimationFrame<"u"?x=msCancelAnimationFrame:typeof x>"u"&&(x=function(a){clearTimeout(a)}));var M=window.AudioContext;typeof M>"u"&&(typeof webkitAudioContext<"u"&&(M=webkitAudioContext),typeof mozAudioContext<"u"&&(M=mozAudioContext));var N=window.URL;typeof N>"u"&&typeof webkitURL<"u"&&(N=webkitURL),typeof navigator<"u"&&typeof navigator.getUserMedia>"u"&&(typeof navigator.webkitGetUserMedia<"u"&&(navigator.getUserMedia=navigator.webkitGetUserMedia),typeof navigator.mozGetUserMedia<"u"&&(navigator.getUserMedia=navigator.mozGetUserMedia));var e=navigator.userAgent.indexOf("Edge")!==-1&&(!!navigator.msSaveBlob||!!navigator.msSaveOrOpenBlob),r=!!window.opera||navigator.userAgent.indexOf("OPR/")!==-1,n=navigator.userAgent.toLowerCase().indexOf("firefox")>-1&&"netscape"in window&&/ rv:/.test(navigator.userAgent),s=!r&&!e&&!!navigator.webkitGetUserMedia||q()||navigator.userAgent.toLowerCase().indexOf("chrome/")!==-1,h=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);h&&!s&&navigator.userAgent.indexOf("CriOS")!==-1&&(h=!1,s=!0);var v=window.MediaStream;typeof v>"u"&&typeof webkitMediaStream<"u"&&(v=webkitMediaStream),typeof v<"u"&&typeof v.prototype.stop>"u"&&(v.prototype.stop=function(){this.getTracks().forEach(function(a){a.stop()})});function f(a){var t=1e3,o=["Bytes","KB","MB","GB","TB"];if(a===0)return"0 Bytes";var m=parseInt(Math.floor(Math.log(a)/Math.log(t)),10);return(a/Math.pow(t,m)).toPrecision(3)+" "+o[m]}function O(a,t){if(!a)throw"Blob object is required.";if(!a.type)try{a.type="video/webm"}catch{}var o=(a.type||"video/webm").split("/")[1];if(o.indexOf(";")!==-1&&(o=o.split(";")[0]),t&&t.indexOf(".")!==-1){var m=t.split(".");t=m[0],o=m[1]}var g=(t||Math.round(Math.random()*9999999999)+888888888)+"."+o;if(typeof navigator.msSaveOrOpenBlob<"u")return navigator.msSaveOrOpenBlob(a,g);if(typeof navigator.msSaveBlob<"u")return navigator.msSaveBlob(a,g);var _=document.createElement("a");_.href=N.createObjectURL(a),_.download=g,_.style="display:none;opacity:0;color:transparent;",(document.body||document.documentElement).appendChild(_),typeof _.click=="function"?_.click():(_.target="_blank",_.dispatchEvent(new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0}))),N.revokeObjectURL(_.href)}function q(){return typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&!!process.versions.electron||typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent.indexOf("Electron")>=0}function V(a,t){return!a||!a.getTracks?[]:a.getTracks().filter(function(o){return o.kind===(t||"audio")})}function fe(a,t){"srcObject"in t?t.srcObject=a:"mozSrcObject"in t?t.mozSrcObject=a:t.srcObject=a}function ye(a,t){if(typeof EBML>"u")throw new Error("Please link: https://www.webrtc-experiment.com/EBML.js");var o=new EBML.Reader,m=new EBML.Decoder,g=EBML.tools,_=new FileReader;_.onload=function(w){var d=m.decode(this.result);d.forEach(function(D){o.read(D)}),o.stop();var T=g.makeMetadataSeekable(o.metadatas,o.duration,o.cues),B=this.result.slice(o.metadataSize),R=new Blob([T,B],{type:"video/webm"});t(R)},_.readAsArrayBuffer(a)}typeof y<"u"&&(y.invokeSaveAsDialog=O,y.getTracks=V,y.getSeekableBlob=ye,y.bytesToSize=f,y.isElectron=q);/**
 * Storage is a standalone object used by {@link RecordRTC} to store reusable objects e.g. "new AudioContext".
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @example
 * Storage.AudioContext === webkitAudioContext
 * @property {webkitAudioContext} AudioContext - Keeps a reference to AudioContext object.
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 */var ce={};typeof M<"u"?ce.AudioContext=M:typeof webkitAudioContext<"u"&&(ce.AudioContext=webkitAudioContext),typeof y<"u"&&(y.Storage=ce);function pe(){if(n||h||e)return!0;var a=navigator.userAgent,t=""+parseFloat(navigator.appVersion),o=parseInt(navigator.appVersion,10),m,g;return(s||r)&&(m=a.indexOf("Chrome"),t=a.substring(m+7)),(g=t.indexOf(";"))!==-1&&(t=t.substring(0,g)),(g=t.indexOf(" "))!==-1&&(t=t.substring(0,g)),o=parseInt(""+t,10),isNaN(o)&&(t=""+parseFloat(navigator.appVersion),o=parseInt(navigator.appVersion,10)),o>=49}/**
 * MediaStreamRecorder is an abstraction layer for {@link https://w3c.github.io/mediacapture-record/MediaRecorder.html|MediaRecorder API}. It is used by {@link RecordRTC} to record MediaStream(s) in both Chrome and Firefox.
 * @summary Runs top over {@link https://w3c.github.io/mediacapture-record/MediaRecorder.html|MediaRecorder API}.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://github.com/muaz-khan|Muaz Khan}
 * @typedef MediaStreamRecorder
 * @class
 * @example
 * var config = {
 *     mimeType: 'video/webm', // vp8, vp9, h264, mkv, opus/vorbis
 *     audioBitsPerSecond : 256 * 8 * 1024,
 *     videoBitsPerSecond : 256 * 8 * 1024,
 *     bitsPerSecond: 256 * 8 * 1024,  // if this is provided, skip above two
 *     checkForInactiveTracks: true,
 *     timeSlice: 1000, // concatenate intervals based blobs
 *     ondataavailable: function() {} // get intervals based blobs
 * }
 * var recorder = new MediaStreamRecorder(mediaStream, config);
 * recorder.record();
 * recorder.stop(function(blob) {
 *     video.src = URL.createObjectURL(blob);
 *
 *     // or
 *     var blob = recorder.blob;
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @param {object} config - {disableLogs:true, initCallback: function, mimeType: "video/webm", timeSlice: 1000}
 * @throws Will throw an error if first argument "MediaStream" is missing. Also throws error if "MediaRecorder API" are not supported by the browser.
 */function k(a,t){var R=this;if(typeof a>"u")throw'First argument "MediaStream" is required.';if(typeof MediaRecorder>"u")throw"Your browser does not support the Media Recorder API. Please try other modules e.g. WhammyRecorder or StereoAudioRecorder.";if(t=t||{mimeType:"video/webm"},t.type==="audio"){if(V(a,"video").length&&V(a,"audio").length){var o;navigator.mozGetUserMedia?(o=new v,o.addTrack(V(a,"audio")[0])):o=new v(V(a,"audio")),a=o}(!t.mimeType||t.mimeType.toString().toLowerCase().indexOf("audio")===-1)&&(t.mimeType=s?"audio/webm":"audio/ogg"),t.mimeType&&t.mimeType.toString().toLowerCase()!=="audio/ogg"&&!!navigator.mozGetUserMedia&&(t.mimeType="audio/ogg")}var m=[];this.getArrayOfBlobs=function(){return m},this.record=function(){R.blob=null,R.clearRecordedData(),R.timestamps=[],B=[],m=[];var D=t;t.disableLogs||console.log("Passing following config over MediaRecorder API.",D),d&&(d=null),s&&!pe()&&(D="video/vp8"),typeof MediaRecorder.isTypeSupported=="function"&&D.mimeType&&(MediaRecorder.isTypeSupported(D.mimeType)||(t.disableLogs||console.warn("MediaRecorder API seems unable to record mimeType:",D.mimeType),D.mimeType=t.type==="audio"?"audio/webm":"video/webm"));try{d=new MediaRecorder(a,D),t.mimeType=D.mimeType}catch{d=new MediaRecorder(a)}D.mimeType&&!MediaRecorder.isTypeSupported&&"canRecordMimeType"in d&&d.canRecordMimeType(D.mimeType)===!1&&(t.disableLogs||console.warn("MediaRecorder API seems unable to record mimeType:",D.mimeType)),d.ondataavailable=function(S){if(S.data&&B.push("ondataavailable: "+f(S.data.size)),typeof t.timeSlice=="number"){if(S.data&&S.data.size&&(m.push(S.data),g(),typeof t.ondataavailable=="function")){var L=t.getNativeBlob?S.data:new Blob([S.data],{type:_(D)});t.ondataavailable(L)}return}if(!S.data||!S.data.size||S.data.size<100||R.blob){R.recordingCallback&&(R.recordingCallback(new Blob([],{type:_(D)})),R.recordingCallback=null);return}R.blob=t.getNativeBlob?S.data:new Blob([S.data],{type:_(D)}),R.recordingCallback&&(R.recordingCallback(R.blob),R.recordingCallback=null)},d.onstart=function(){B.push("started")},d.onpause=function(){B.push("paused")},d.onresume=function(){B.push("resumed")},d.onstop=function(){B.push("stopped")},d.onerror=function(S){!S||(S.name||(S.name="UnknownError"),B.push("error: "+S),t.disableLogs||(S.name.toString().toLowerCase().indexOf("invalidstate")!==-1?console.error("The MediaRecorder is not in a state in which the proposed operation is allowed to be executed.",S):S.name.toString().toLowerCase().indexOf("notsupported")!==-1?console.error("MIME type (",D.mimeType,") is not supported.",S):S.name.toString().toLowerCase().indexOf("security")!==-1?console.error("MediaRecorder security error",S):S.name==="OutOfMemory"?console.error("The UA has exhaused the available memory. User agents SHOULD provide as much additional information as possible in the message attribute.",S):S.name==="IllegalStreamModification"?console.error("A modification to the stream has occurred that makes it impossible to continue recording. An example would be the addition of a Track while recording is occurring. User agents SHOULD provide as much additional information as possible in the message attribute.",S):S.name==="OtherRecordingError"?console.error("Used for an fatal error other than those listed above. User agents SHOULD provide as much additional information as possible in the message attribute.",S):S.name==="GenericError"?console.error("The UA cannot provide the codec or recording option that has been requested.",S):console.error("MediaRecorder Error",S)),function(L){if(!R.manuallyStopped&&d&&d.state==="inactive"){delete t.timeslice,d.start(10*60*1e3);return}setTimeout(L,1e3)}(),d.state!=="inactive"&&d.state!=="stopped"&&d.stop())},typeof t.timeSlice=="number"?(g(),d.start(t.timeSlice)):d.start(36e5),t.initCallback&&t.initCallback()},this.timestamps=[];function g(){R.timestamps.push(new Date().getTime()),typeof t.onTimeStamp=="function"&&t.onTimeStamp(R.timestamps[R.timestamps.length-1],R.timestamps)}function _(D){return d&&d.mimeType?d.mimeType:D.mimeType||"video/webm"}this.stop=function(D){D=D||function(){},R.manuallyStopped=!0,d&&(this.recordingCallback=D,d.state==="recording"&&d.stop(),typeof t.timeSlice=="number"&&setTimeout(function(){R.blob=new Blob(m,{type:_(t)}),R.recordingCallback(R.blob)},100))},this.pause=function(){!d||d.state==="recording"&&d.pause()},this.resume=function(){!d||d.state==="paused"&&d.resume()},this.clearRecordedData=function(){d&&d.state==="recording"&&R.stop(w),w()};function w(){m=[],d=null,R.timestamps=[]}var d;this.getInternalRecorder=function(){return d};function T(){if("active"in a){if(!a.active)return!1}else if("ended"in a&&a.ended)return!1;return!0}this.blob=null,this.getState=function(){return d&&d.state||"inactive"};var B=[];this.getAllStates=function(){return B},typeof t.checkForInactiveTracks>"u"&&(t.checkForInactiveTracks=!1);var R=this;(function D(){if(!(!d||t.checkForInactiveTracks===!1)){if(T()===!1){t.disableLogs||console.log("MediaStream seems stopped."),R.stop();return}setTimeout(D,1e3)}})(),this.name="MediaStreamRecorder",this.toString=function(){return this.name}}typeof y<"u"&&(y.MediaStreamRecorder=k);/**
 * StereoAudioRecorder is a standalone class used by {@link RecordRTC} to bring "stereo" audio-recording in chrome.
 * @summary JavaScript standalone object for stereo audio recording.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef StereoAudioRecorder
 * @class
 * @example
 * var recorder = new StereoAudioRecorder(MediaStream, {
 *     sampleRate: 44100,
 *     bufferSize: 4096
 * });
 * recorder.record();
 * recorder.stop(function(blob) {
 *     video.src = URL.createObjectURL(blob);
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @param {object} config - {sampleRate: 44100, bufferSize: 4096, numberOfAudioChannels: 1, etc.}
 */function G(a,t){if(!V(a,"audio").length)throw"Your stream has no audio tracks.";t=t||{};var o=this,m=[],g=[],_=!1,w=0,d,T=2,B=t.desiredSampRate;t.leftChannel===!0&&(T=1),t.numberOfAudioChannels===1&&(T=1),(!T||T<1)&&(T=2),t.disableLogs||console.log("StereoAudioRecorder is set to record number of channels: "+T),typeof t.checkForInactiveTracks>"u"&&(t.checkForInactiveTracks=!0);function R(){if(t.checkForInactiveTracks===!1)return!0;if("active"in a){if(!a.active)return!1}else if("ended"in a&&a.ended)return!1;return!0}this.record=function(){if(R()===!1)throw"Please make sure MediaStream is active.";H(),b=C=!1,_=!0,typeof t.timeSlice<"u"&&z()};function D(W,de){function ne(ie,Ie){var be=ie.numberOfAudioChannels,le=ie.leftBuffers.slice(0),xe=ie.rightBuffers.slice(0),we=ie.sampleRate,Te=ie.internalInterleavedLength,me=ie.desiredSampRate;be===2&&(le=ze(le,Te),xe=ze(xe,Te),me&&(le=Le(le,me,we),xe=Le(xe,me,we))),be===1&&(le=ze(le,Te),me&&(le=Le(le,me,we))),me&&(we=me);function Le(oe,Ae,_e){var ve=Math.round(oe.length*(Ae/_e)),ue=[],Se=Number((oe.length-1)/(ve-1));ue[0]=oe[0];for(var Me=1;Me<ve-1;Me++){var Qe=Me*Se,tt=Number(Math.floor(Qe)).toFixed(),_t=Number(Math.ceil(Qe)).toFixed(),vt=Qe-tt;ue[Me]=$e(oe[tt],oe[_t],vt)}return ue[ve-1]=oe[oe.length-1],ue}function $e(oe,Ae,_e){return oe+(Ae-oe)*_e}function ze(oe,Ae){for(var _e=new Float64Array(Ae),ve=0,ue=oe.length,Se=0;Se<ue;Se++){var Me=oe[Se];_e.set(Me,ve),ve+=Me.length}return _e}function ct(oe,Ae){for(var _e=oe.length+Ae.length,ve=new Float64Array(_e),ue=0,Se=0;Se<_e;)ve[Se++]=oe[ue],ve[Se++]=Ae[ue],ue++;return ve}function Ge(oe,Ae,_e){for(var ve=_e.length,ue=0;ue<ve;ue++)oe.setUint8(Ae+ue,_e.charCodeAt(ue))}var Ve;be===2&&(Ve=ct(le,xe)),be===1&&(Ve=le);var Ne=Ve.length,pt=44+Ne*2,Xe=new ArrayBuffer(pt),se=new DataView(Xe);Ge(se,0,"RIFF"),se.setUint32(4,36+Ne*2,!0),Ge(se,8,"WAVE"),Ge(se,12,"fmt "),se.setUint32(16,16,!0),se.setUint16(20,1,!0),se.setUint16(22,be,!0),se.setUint32(24,we,!0),se.setUint32(28,we*be*2,!0),se.setUint16(32,be*2,!0),se.setUint16(34,16,!0),Ge(se,36,"data"),se.setUint32(40,Ne*2,!0);for(var ht=Ne,et=44,mt=1,Ye=0;Ye<ht;Ye++)se.setInt16(et,Ve[Ye]*(32767*mt),!0),et+=2;if(Ie)return Ie({buffer:Xe,view:se});postMessage({buffer:Xe,view:se})}if(W.noWorker){ne(W,function(ie){de(ie.buffer,ie.view)});return}var ke=S(ne);ke.onmessage=function(ie){de(ie.data.buffer,ie.data.view),N.revokeObjectURL(ke.workerURL),ke.terminate()},ke.postMessage(W)}function S(W){var de=N.createObjectURL(new Blob([W.toString(),";this.onmessage =  function (eee) {"+W.name+"(eee.data);}"],{type:"application/javascript"})),ne=new Worker(de);return ne.workerURL=de,ne}this.stop=function(W){W=W||function(){},_=!1,D({desiredSampRate:B,sampleRate:l,numberOfAudioChannels:T,internalInterleavedLength:w,leftBuffers:m,rightBuffers:T===1?[]:g,noWorker:t.noWorker},function(de,ne){o.blob=new Blob([ne],{type:"audio/wav"}),o.buffer=new ArrayBuffer(ne.buffer.byteLength),o.view=ne,o.sampleRate=B||l,o.bufferSize=j,o.length=w,b=!1,W&&W(o.blob)})},typeof y.Storage>"u"&&(y.Storage={AudioContextConstructor:null,AudioContext:window.AudioContext||window.webkitAudioContext}),(!y.Storage.AudioContextConstructor||y.Storage.AudioContextConstructor.state==="closed")&&(y.Storage.AudioContextConstructor=new y.Storage.AudioContext);var L=y.Storage.AudioContextConstructor,A=L.createMediaStreamSource(a),E=[0,256,512,1024,2048,4096,8192,16384],j=typeof t.bufferSize>"u"?4096:t.bufferSize;if(E.indexOf(j)===-1&&(t.disableLogs||console.log("Legal values for buffer-size are "+JSON.stringify(E,null,"	"))),L.createJavaScriptNode)d=L.createJavaScriptNode(j,T,T);else if(L.createScriptProcessor)d=L.createScriptProcessor(j,T,T);else throw"WebAudio API has no support on this browser.";A.connect(d),t.bufferSize||(j=d.bufferSize);var l=typeof t.sampleRate<"u"?t.sampleRate:L.sampleRate||44100;(l<22050||l>96e3)&&(t.disableLogs||console.log("sample-rate must be under range 22050 and 96000.")),t.disableLogs||t.desiredSampRate&&console.log("Desired sample-rate: "+t.desiredSampRate);var C=!1;this.pause=function(){C=!0},this.resume=function(){if(R()===!1)throw"Please make sure MediaStream is active.";if(!_){t.disableLogs||console.log("Seems recording has been restarted."),this.record();return}C=!1},this.clearRecordedData=function(){t.checkForInactiveTracks=!1,_&&this.stop(u),u()};function H(){m=[],g=[],w=0,b=!1,_=!1,C=!1,L=null,o.leftchannel=m,o.rightchannel=g,o.numberOfAudioChannels=T,o.desiredSampRate=B,o.sampleRate=l,o.recordingLength=w,U={left:[],right:[],recordingLength:0}}function u(){d&&(d.onaudioprocess=null,d.disconnect(),d=null),A&&(A.disconnect(),A=null),H()}this.name="StereoAudioRecorder",this.toString=function(){return this.name};var b=!1;function P(W){if(!C){if(R()===!1&&(t.disableLogs||console.log("MediaStream seems stopped."),d.disconnect(),_=!1),!_){A&&(A.disconnect(),A=null);return}b||(b=!0,t.onAudioProcessStarted&&t.onAudioProcessStarted(),t.initCallback&&t.initCallback());var de=W.inputBuffer.getChannelData(0),ne=new Float32Array(de);if(m.push(ne),T===2){var ke=W.inputBuffer.getChannelData(1),ie=new Float32Array(ke);g.push(ie)}w+=j,o.recordingLength=w,typeof t.timeSlice<"u"&&(U.recordingLength+=j,U.left.push(ne),T===2&&U.right.push(ie))}}d.onaudioprocess=P,L.createMediaStreamDestination?d.connect(L.createMediaStreamDestination()):d.connect(L.destination),this.leftchannel=m,this.rightchannel=g,this.numberOfAudioChannels=T,this.desiredSampRate=B,this.sampleRate=l,o.recordingLength=w;var U={left:[],right:[],recordingLength:0};function z(){!_||typeof t.ondataavailable!="function"||typeof t.timeSlice>"u"||(U.left.length?(D({desiredSampRate:B,sampleRate:l,numberOfAudioChannels:T,internalInterleavedLength:U.recordingLength,leftBuffers:U.left,rightBuffers:T===1?[]:U.right},function(W,de){var ne=new Blob([de],{type:"audio/wav"});t.ondataavailable(ne),setTimeout(z,t.timeSlice)}),U={left:[],right:[],recordingLength:0}):setTimeout(z,t.timeSlice))}}typeof y<"u"&&(y.StereoAudioRecorder=G);/**
 * CanvasRecorder is a standalone class used by {@link RecordRTC} to bring HTML5-Canvas recording into video WebM. It uses HTML2Canvas library and runs top over {@link Whammy}.
 * @summary HTML2Canvas recording into video WebM.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef CanvasRecorder
 * @class
 * @example
 * var recorder = new CanvasRecorder(htmlElement, { disableLogs: true, useWhammyRecorder: true });
 * recorder.record();
 * recorder.stop(function(blob) {
 *     video.src = URL.createObjectURL(blob);
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {HTMLElement} htmlElement - querySelector/getElementById/getElementsByTagName[0]/etc.
 * @param {object} config - {disableLogs:true, initCallback: function}
 */function $(a,t){if(typeof html2canvas>"u")throw"Please link: https://www.webrtc-experiment.com/screenshot.js";t=t||{},t.frameInterval||(t.frameInterval=10);var o=!1;["captureStream","mozCaptureStream","webkitCaptureStream"].forEach(function(E){E in document.createElement("canvas")&&(o=!0)});var m=(!!window.webkitRTCPeerConnection||!!window.webkitGetUserMedia)&&!!window.chrome,g=50,_=navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./);m&&_&&_[2]&&(g=parseInt(_[2],10)),m&&g<52&&(o=!1),t.useWhammyRecorder&&(o=!1);var w,d;if(o)if(t.disableLogs||console.log("Your browser supports both MediRecorder API and canvas.captureStream!"),a instanceof HTMLCanvasElement)w=a;else if(a instanceof CanvasRenderingContext2D)w=a.canvas;else throw"Please pass either HTMLCanvasElement or CanvasRenderingContext2D.";else navigator.mozGetUserMedia&&(t.disableLogs||console.error("Canvas recording is NOT supported in Firefox."));var T;this.record=function(){if(T=!0,o&&!t.useWhammyRecorder){var E;"captureStream"in w?E=w.captureStream(25):"mozCaptureStream"in w?E=w.mozCaptureStream(25):"webkitCaptureStream"in w&&(E=w.webkitCaptureStream(25));try{var j=new v;j.addTrack(V(E,"video")[0]),E=j}catch{}if(!E)throw"captureStream API are NOT available.";d=new k(E,{mimeType:t.mimeType||"video/webm"}),d.record()}else A.frames=[],L=new Date().getTime(),S();t.initCallback&&t.initCallback()},this.getWebPImages=function(E){if(a.nodeName.toLowerCase()!=="canvas"){E();return}var j=A.frames.length;A.frames.forEach(function(l,C){var H=j-C;t.disableLogs||console.log(H+"/"+j+" frames remaining"),t.onEncodingCallback&&t.onEncodingCallback(H,j);var u=l.image.toDataURL("image/webp",1);A.frames[C].image=u}),t.disableLogs||console.log("Generating WebM"),E()},this.stop=function(E){T=!1;var j=this;if(o&&d){d.stop(E);return}this.getWebPImages(function(){A.compile(function(l){t.disableLogs||console.log("Recording finished!"),j.blob=l,j.blob.forEach&&(j.blob=new Blob([],{type:"video/webm"})),E&&E(j.blob),A.frames=[]})})};var B=!1;this.pause=function(){if(B=!0,d instanceof k){d.pause();return}},this.resume=function(){if(B=!1,d instanceof k){d.resume();return}T||this.record()},this.clearRecordedData=function(){T&&this.stop(R),R()};function R(){A.frames=[],T=!1,B=!1}this.name="CanvasRecorder",this.toString=function(){return this.name};function D(){var E=document.createElement("canvas"),j=E.getContext("2d");return E.width=a.width,E.height=a.height,j.drawImage(a,0,0),E}function S(){if(B)return L=new Date().getTime(),setTimeout(S,500);if(a.nodeName.toLowerCase()==="canvas"){var E=new Date().getTime()-L;L=new Date().getTime(),A.frames.push({image:D(),duration:E}),T&&setTimeout(S,t.frameInterval);return}html2canvas(a,{grabMouse:typeof t.showMousePointer>"u"||t.showMousePointer,onrendered:function(j){var l=new Date().getTime()-L;if(!l)return setTimeout(S,t.frameInterval);L=new Date().getTime(),A.frames.push({image:j.toDataURL("image/webp",1),duration:l}),T&&setTimeout(S,t.frameInterval)}})}var L=new Date().getTime(),A=new ae.Video(100)}typeof y<"u"&&(y.CanvasRecorder=$);/**
 * WhammyRecorder is a standalone class used by {@link RecordRTC} to bring video recording in Chrome. It runs top over {@link Whammy}.
 * @summary Video recording feature in Chrome.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef WhammyRecorder
 * @class
 * @example
 * var recorder = new WhammyRecorder(mediaStream);
 * recorder.record();
 * recorder.stop(function(blob) {
 *     video.src = URL.createObjectURL(blob);
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @param {object} config - {disableLogs: true, initCallback: function, video: HTMLVideoElement, etc.}
 */function te(a,t){t=t||{},t.frameInterval||(t.frameInterval=10),t.disableLogs||console.log("Using frames-interval:",t.frameInterval),this.record=function(){t.width||(t.width=320),t.height||(t.height=240),t.video||(t.video={width:t.width,height:t.height}),t.canvas||(t.canvas={width:t.width,height:t.height}),T.width=t.canvas.width||320,T.height=t.canvas.height||240,B=T.getContext("2d"),t.video&&t.video instanceof HTMLVideoElement?(R=t.video.cloneNode(),t.initCallback&&t.initCallback()):(R=document.createElement("video"),fe(a,R),R.onloadedmetadata=function(){t.initCallback&&t.initCallback()},R.width=t.video.width,R.height=t.video.height),R.muted=!0,R.play(),D=new Date().getTime(),S=new ae.Video,t.disableLogs||(console.log("canvas resolutions",T.width,"*",T.height),console.log("video width/height",R.width||T.width,"*",R.height||T.height)),o(t.frameInterval)};function o(L){L=typeof L<"u"?L:10;var A=new Date().getTime()-D;if(!A)return setTimeout(o,L,L);if(w)return D=new Date().getTime(),setTimeout(o,100);D=new Date().getTime(),R.paused&&R.play(),B.drawImage(R,0,0,T.width,T.height),S.frames.push({duration:A,image:T.toDataURL("image/webp")}),_||setTimeout(o,L,L)}function m(L){var A=-1,E=L.length;(function j(){if(A++,A===E){L.callback();return}setTimeout(function(){L.functionToLoop(j,A)},1)})()}function g(L,A,E,j,l){var C=document.createElement("canvas");C.width=T.width,C.height=T.height;var H=C.getContext("2d"),u=[],b=A===-1,P=A&&A>0&&A<=L.length?A:L.length,U={r:0,g:0,b:0},z=Math.sqrt(Math.pow(255,2)+Math.pow(255,2)+Math.pow(255,2)),W=E&&E>=0&&E<=1?E:0,de=j&&j>=0&&j<=1?j:0,ne=!1;m({length:P,functionToLoop:function(ke,ie){var Ie,be,le,xe=function(){!ne&&le-Ie<=le*de||(b&&(ne=!0),u.push(L[ie])),ke()};if(ne)xe();else{var we=new Image;we.onload=function(){H.drawImage(we,0,0,T.width,T.height);var Te=H.getImageData(0,0,T.width,T.height);Ie=0,be=Te.data.length,le=Te.data.length/4;for(var me=0;me<be;me+=4){var Le={r:Te.data[me],g:Te.data[me+1],b:Te.data[me+2]},$e=Math.sqrt(Math.pow(Le.r-U.r,2)+Math.pow(Le.g-U.g,2)+Math.pow(Le.b-U.b,2));$e<=z*W&&Ie++}xe()},we.src=L[ie].image}},callback:function(){u=u.concat(L.slice(P)),u.length<=0&&u.push(L[L.length-1]),l(u)}})}var _=!1;this.stop=function(L){L=L||function(){},_=!0;var A=this;setTimeout(function(){g(S.frames,-1,null,null,function(E){S.frames=E,t.advertisement&&t.advertisement.length&&(S.frames=t.advertisement.concat(S.frames)),S.compile(function(j){A.blob=j,A.blob.forEach&&(A.blob=new Blob([],{type:"video/webm"})),L&&L(A.blob)})})},10)};var w=!1;this.pause=function(){w=!0},this.resume=function(){w=!1,_&&this.record()},this.clearRecordedData=function(){_||this.stop(d),d()};function d(){S.frames=[],_=!0,w=!1}this.name="WhammyRecorder",this.toString=function(){return this.name};var T=document.createElement("canvas"),B=T.getContext("2d"),R,D,S}typeof y<"u"&&(y.WhammyRecorder=te);/**
 * Whammy is a standalone class used by {@link RecordRTC} to bring video recording in Chrome. It is written by {@link https://github.com/antimatter15|antimatter15}
 * @summary A real time javascript webm encoder based on a canvas hack.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef Whammy
 * @class
 * @example
 * var recorder = new Whammy().Video(15);
 * recorder.add(context || canvas || dataURL);
 * var output = recorder.compile();
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 */var ae=function(){function a(m){this.frames=[],this.duration=m||1,this.quality=.8}a.prototype.add=function(m,g){if("canvas"in m&&(m=m.canvas),"toDataURL"in m&&(m=m.toDataURL("image/webp",this.quality)),!/^data:image\/webp;base64,/ig.test(m))throw"Input must be formatted properly as a base64 encoded DataURI of type image/webp";this.frames.push({image:m,duration:g||this.duration})};function t(m){var g=N.createObjectURL(new Blob([m.toString(),"this.onmessage =  function (eee) {"+m.name+"(eee.data);}"],{type:"application/javascript"})),_=new Worker(g);return N.revokeObjectURL(g),_}function o(m){function g(l){var C=w(l);if(!C)return[];for(var H=3e4,u=[{id:440786851,data:[{data:1,id:17030},{data:1,id:17143},{data:4,id:17138},{data:8,id:17139},{data:"webm",id:17026},{data:2,id:17031},{data:2,id:17029}]},{id:408125543,data:[{id:357149030,data:[{data:1e6,id:2807729},{data:"whammy",id:19840},{data:"whammy",id:22337},{data:E(C.duration),id:17545}]},{id:374648427,data:[{id:174,data:[{data:1,id:215},{data:1,id:29637},{data:0,id:156},{data:"und",id:2274716},{data:"V_VP8",id:134},{data:"VP8",id:2459272},{data:1,id:131},{id:224,data:[{data:C.width,id:176},{data:C.height,id:186}]}]}]}]}],b=0,P=0;b<l.length;){var U=[],z=0;do U.push(l[b]),z+=l[b].duration,b++;while(b<l.length&&z<H);var W=0,de={id:524531317,data:_(P,W,U)};u[1].data.push(de),P+=z}return R(u)}function _(l,C,H){return[{data:l,id:231}].concat(H.map(function(u){var b=D({discardable:0,frame:u.data.slice(4),invisible:0,keyframe:1,lacing:0,trackNum:1,timecode:Math.round(C)});return C+=u.duration,{data:b,id:163}}))}function w(l){if(!l[0]){postMessage({error:"Something went wrong. Maybe WebP format is not supported in the current browser."});return}for(var C=l[0].width,H=l[0].height,u=l[0].duration,b=1;b<l.length;b++)u+=l[b].duration;return{duration:u,width:C,height:H}}function d(l){for(var C=[];l>0;)C.push(l&255),l=l>>8;return new Uint8Array(C.reverse())}function T(l){return new Uint8Array(l.split("").map(function(C){return C.charCodeAt(0)}))}function B(l){var C=[],H=l.length%8?new Array(9-l.length%8).join("0"):"";l=H+l;for(var u=0;u<l.length;u+=8)C.push(parseInt(l.substr(u,8),2));return new Uint8Array(C)}function R(l){for(var C=[],H=0;H<l.length;H++){var u=l[H].data;typeof u=="object"&&(u=R(u)),typeof u=="number"&&(u=B(u.toString(2))),typeof u=="string"&&(u=T(u));var b=u.size||u.byteLength||u.length,P=Math.ceil(Math.ceil(Math.log(b)/Math.log(2))/8),U=b.toString(2),z=new Array(P*7+7+1-U.length).join("0")+U,W=new Array(P).join("0")+"1"+z;C.push(d(l[H].id)),C.push(B(W)),C.push(u)}return new Blob(C,{type:"video/webm"})}function D(l){var C=0;if(l.keyframe&&(C|=128),l.invisible&&(C|=8),l.lacing&&(C|=l.lacing<<1),l.discardable&&(C|=1),l.trackNum>127)throw"TrackNumber > 127 not supported";var H=[l.trackNum|128,l.timecode>>8,l.timecode&255,C].map(function(u){return String.fromCharCode(u)}).join("")+l.frame;return H}function S(l){for(var C=l.RIFF[0].WEBP[0],H=C.indexOf("\x9D*"),u=0,b=[];u<4;u++)b[u]=C.charCodeAt(H+3+u);var P,U,z;return z=b[1]<<8|b[0],P=z&16383,z=b[3]<<8|b[2],U=z&16383,{width:P,height:U,data:C,riff:l}}function L(l,C){return parseInt(l.substr(C+4,4).split("").map(function(H){var u=H.charCodeAt(0).toString(2);return new Array(8-u.length+1).join("0")+u}).join(""),2)}function A(l){for(var C=0,H={};C<l.length;){var u=l.substr(C,4),b=L(l,C),P=l.substr(C+4+4,b);C+=4+4+b,H[u]=H[u]||[],u==="RIFF"||u==="LIST"?H[u].push(A(P)):H[u].push(P)}return H}function E(l){return[].slice.call(new Uint8Array(new Float64Array([l]).buffer),0).map(function(C){return String.fromCharCode(C)}).reverse().join("")}var j=new g(m.map(function(l){var C=S(A(atob(l.image.slice(23))));return C.duration=l.duration,C}));postMessage(j)}return a.prototype.compile=function(m){var g=t(o);g.onmessage=function(_){if(_.data.error){console.error(_.data.error);return}m(_.data)},g.postMessage(this.frames)},{Video:a}}();typeof y<"u"&&(y.Whammy=ae);/**
 * DiskStorage is a standalone object used by {@link RecordRTC} to store recorded blobs in IndexedDB storage.
 * @summary Writing blobs into IndexedDB.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @example
 * DiskStorage.Store({
 *     audioBlob: yourAudioBlob,
 *     videoBlob: yourVideoBlob,
 *     gifBlob  : yourGifBlob
 * });
 * DiskStorage.Fetch(function(dataURL, type) {
 *     if(type === 'audioBlob') { }
 *     if(type === 'videoBlob') { }
 *     if(type === 'gifBlob')   { }
 * });
 * // DiskStorage.dataStoreName = 'recordRTC';
 * // DiskStorage.onError = function(error) { };
 * @property {function} init - This method must be called once to initialize IndexedDB ObjectStore. Though, it is auto-used internally.
 * @property {function} Fetch - This method fetches stored blobs from IndexedDB.
 * @property {function} Store - This method stores blobs in IndexedDB.
 * @property {function} onError - This function is invoked for any known/unknown error.
 * @property {string} dataStoreName - Name of the ObjectStore created in IndexedDB storage.
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 */var ee={init:function(){var a=this;if(typeof indexedDB>"u"||typeof indexedDB.open>"u"){console.error("IndexedDB API are not available in this browser.");return}var t=1,o=this.dbName||location.href.replace(/\/|:|#|%|\.|\[|\]/g,""),m,g=indexedDB.open(o,t);function _(d){d.createObjectStore(a.dataStoreName)}function w(){var d=m.transaction([a.dataStoreName],"readwrite");a.videoBlob&&d.objectStore(a.dataStoreName).put(a.videoBlob,"videoBlob"),a.gifBlob&&d.objectStore(a.dataStoreName).put(a.gifBlob,"gifBlob"),a.audioBlob&&d.objectStore(a.dataStoreName).put(a.audioBlob,"audioBlob");function T(B){d.objectStore(a.dataStoreName).get(B).onsuccess=function(R){a.callback&&a.callback(R.target.result,B)}}T("audioBlob"),T("videoBlob"),T("gifBlob")}g.onerror=a.onError,g.onsuccess=function(){if(m=g.result,m.onerror=a.onError,m.setVersion)if(m.version!==t){var d=m.setVersion(t);d.onsuccess=function(){_(m),w()}}else w();else w()},g.onupgradeneeded=function(d){_(d.target.result)}},Fetch:function(a){return this.callback=a,this.init(),this},Store:function(a){return this.audioBlob=a.audioBlob,this.videoBlob=a.videoBlob,this.gifBlob=a.gifBlob,this.init(),this},onError:function(a){console.error(JSON.stringify(a,null,"	"))},dataStoreName:"recordRTC",dbName:null};typeof y<"u"&&(y.DiskStorage=ee);/**
 * GifRecorder is standalone calss used by {@link RecordRTC} to record video or canvas into animated gif.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef GifRecorder
 * @class
 * @example
 * var recorder = new GifRecorder(mediaStream || canvas || context, { onGifPreview: function, onGifRecordingStarted: function, width: 1280, height: 720, frameRate: 200, quality: 10 });
 * recorder.record();
 * recorder.stop(function(blob) {
 *     img.src = URL.createObjectURL(blob);
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object or HTMLCanvasElement or CanvasRenderingContext2D.
 * @param {object} config - {disableLogs:true, initCallback: function, width: 320, height: 240, frameRate: 200, quality: 10}
 */function he(a,t){if(typeof GIFEncoder>"u"){var o=document.createElement("script");o.src="https://www.webrtc-experiment.com/gif-recorder.js",(document.body||document.documentElement).appendChild(o)}t=t||{};var m=a instanceof CanvasRenderingContext2D||a instanceof HTMLCanvasElement;this.record=function(){if(typeof GIFEncoder>"u"){setTimeout(L.record,1e3);return}if(!T){setTimeout(L.record,1e3);return}m||(t.width||(t.width=B.offsetWidth||320),t.height||(t.height=B.offsetHeight||240),t.video||(t.video={width:t.width,height:t.height}),t.canvas||(t.canvas={width:t.width,height:t.height}),w.width=t.canvas.width||320,w.height=t.canvas.height||240,B.width=t.video.width||320,B.height=t.video.height||240),S=new GIFEncoder,S.setRepeat(0),S.setDelay(t.frameRate||200),S.setQuality(t.quality||10),S.start(),typeof t.onGifRecordingStarted=="function"&&t.onGifRecordingStarted();function A(E){if(L.clearedRecordedData!==!0){if(g)return setTimeout(function(){A(E)},100);R=I(A),typeof D===void 0&&(D=E),!(E-D<90)&&(!m&&B.paused&&B.play(),m||d.drawImage(B,0,0,w.width,w.height),t.onGifPreview&&t.onGifPreview(w.toDataURL("image/png")),S.addFrame(d),D=E)}}R=I(A),t.initCallback&&t.initCallback()},this.stop=function(A){A=A||function(){},R&&x(R),this.blob=new Blob([new Uint8Array(S.stream().bin)],{type:"image/gif"}),A(this.blob),S.stream().bin=[]};var g=!1;this.pause=function(){g=!0},this.resume=function(){g=!1},this.clearRecordedData=function(){L.clearedRecordedData=!0,_()};function _(){S&&(S.stream().bin=[])}this.name="GifRecorder",this.toString=function(){return this.name};var w=document.createElement("canvas"),d=w.getContext("2d");m&&(a instanceof CanvasRenderingContext2D?(d=a,w=d.canvas):a instanceof HTMLCanvasElement&&(d=a.getContext("2d"),w=a));var T=!0;if(!m){var B=document.createElement("video");B.muted=!0,B.autoplay=!0,B.playsInline=!0,T=!1,B.onloadedmetadata=function(){T=!0},fe(a,B),B.play()}var R=null,D,S,L=this}typeof y<"u"&&(y.GifRecorder=he);function Be(a,t){var o="Fake/5.0 (FakeOS) AppleWebKit/123 (KHTML, like Gecko) Fake/12.3.4567.89 Fake/123.45";(function(u){typeof y<"u"||!u||typeof window<"u"||typeof Y>"u"||(Y.navigator={userAgent:o,getUserMedia:function(){}},Y.console||(Y.console={}),(typeof Y.console.log>"u"||typeof Y.console.error>"u")&&(Y.console.error=Y.console.log=Y.console.log||function(){console.log(arguments)}),typeof document>"u"&&(u.document={documentElement:{appendChild:function(){return""}}},document.createElement=document.captureStream=document.mozCaptureStream=function(){var b={getContext:function(){return b},play:function(){},pause:function(){},drawImage:function(){},toDataURL:function(){return""},style:{}};return b},u.HTMLVideoElement=function(){}),typeof location>"u"&&(u.location={protocol:"file:",href:"",hash:""}),typeof screen>"u"&&(u.screen={width:0,height:0}),typeof B>"u"&&(u.URL={createObjectURL:function(){return""},revokeObjectURL:function(){return""}}),u.window=Y)})(typeof Y<"u"?Y:null),t=t||"multi-streams-mixer";var m=[],g=!1,_=document.createElement("canvas"),w=_.getContext("2d");_.style.opacity=0,_.style.position="absolute",_.style.zIndex=-1,_.style.top="-1000em",_.style.left="-1000em",_.className=t,(document.body||document.documentElement).appendChild(_),this.disableLogs=!1,this.frameInterval=10,this.width=360,this.height=240,this.useGainNode=!0;var d=this,T=window.AudioContext;typeof T>"u"&&(typeof webkitAudioContext<"u"&&(T=webkitAudioContext),typeof mozAudioContext<"u"&&(T=mozAudioContext));var B=window.URL;typeof B>"u"&&typeof webkitURL<"u"&&(B=webkitURL),typeof navigator<"u"&&typeof navigator.getUserMedia>"u"&&(typeof navigator.webkitGetUserMedia<"u"&&(navigator.getUserMedia=navigator.webkitGetUserMedia),typeof navigator.mozGetUserMedia<"u"&&(navigator.getUserMedia=navigator.mozGetUserMedia));var R=window.MediaStream;typeof R>"u"&&typeof webkitMediaStream<"u"&&(R=webkitMediaStream),typeof R<"u"&&typeof R.prototype.stop>"u"&&(R.prototype.stop=function(){this.getTracks().forEach(function(u){u.stop()})});var D={};typeof T<"u"?D.AudioContext=T:typeof webkitAudioContext<"u"&&(D.AudioContext=webkitAudioContext);function S(u,b){"srcObject"in b?b.srcObject=u:"mozSrcObject"in b?b.mozSrcObject=u:b.srcObject=u}this.startDrawingFrames=function(){L()};function L(){if(!g){var u=m.length,b=!1,P=[];if(m.forEach(function(z){z.stream||(z.stream={}),z.stream.fullcanvas?b=z:P.push(z)}),b)_.width=b.stream.width,_.height=b.stream.height;else if(P.length){_.width=u>1?P[0].width*2:P[0].width;var U=1;(u===3||u===4)&&(U=2),(u===5||u===6)&&(U=3),(u===7||u===8)&&(U=4),(u===9||u===10)&&(U=5),_.height=P[0].height*U}else _.width=d.width||360,_.height=d.height||240;b&&b instanceof HTMLVideoElement&&A(b),P.forEach(function(z,W){A(z,W)}),setTimeout(L,d.frameInterval)}}function A(u,b){if(!g){var P=0,U=0,z=u.width,W=u.height;b===1&&(P=u.width),b===2&&(U=u.height),b===3&&(P=u.width,U=u.height),b===4&&(U=u.height*2),b===5&&(P=u.width,U=u.height*2),b===6&&(U=u.height*3),b===7&&(P=u.width,U=u.height*3),typeof u.stream.left<"u"&&(P=u.stream.left),typeof u.stream.top<"u"&&(U=u.stream.top),typeof u.stream.width<"u"&&(z=u.stream.width),typeof u.stream.height<"u"&&(W=u.stream.height),w.drawImage(u,P,U,z,W),typeof u.stream.onRender=="function"&&u.stream.onRender(w,P,U,z,W,b)}}function E(){g=!1;var u=j(),b=l();return b&&b.getTracks().filter(function(P){return P.kind==="audio"}).forEach(function(P){u.addTrack(P)}),a.forEach(function(P){P.fullcanvas}),u}function j(){H();var u;"captureStream"in _?u=_.captureStream():"mozCaptureStream"in _?u=_.mozCaptureStream():d.disableLogs||console.error("Upgrade to latest Chrome or otherwise enable this flag: chrome://flags/#enable-experimental-web-platform-features");var b=new R;return u.getTracks().filter(function(P){return P.kind==="video"}).forEach(function(P){b.addTrack(P)}),_.stream=b,b}function l(){D.AudioContextConstructor||(D.AudioContextConstructor=new D.AudioContext),d.audioContext=D.AudioContextConstructor,d.audioSources=[],d.useGainNode===!0&&(d.gainNode=d.audioContext.createGain(),d.gainNode.connect(d.audioContext.destination),d.gainNode.gain.value=0);var u=0;if(a.forEach(function(b){if(!!b.getTracks().filter(function(U){return U.kind==="audio"}).length){u++;var P=d.audioContext.createMediaStreamSource(b);d.useGainNode===!0&&P.connect(d.gainNode),d.audioSources.push(P)}}),!!u)return d.audioDestination=d.audioContext.createMediaStreamDestination(),d.audioSources.forEach(function(b){b.connect(d.audioDestination)}),d.audioDestination.stream}function C(u){var b=document.createElement("video");return S(u,b),b.className=t,b.muted=!0,b.volume=0,b.width=u.width||d.width||360,b.height=u.height||d.height||240,b.play(),b}this.appendStreams=function(u){if(!u)throw"First parameter is required.";u instanceof Array||(u=[u]),u.forEach(function(b){var P=new R;if(b.getTracks().filter(function(W){return W.kind==="video"}).length){var U=C(b);U.stream=b,m.push(U),P.addTrack(b.getTracks().filter(function(W){return W.kind==="video"})[0])}if(b.getTracks().filter(function(W){return W.kind==="audio"}).length){var z=d.audioContext.createMediaStreamSource(b);d.audioDestination=d.audioContext.createMediaStreamDestination(),z.connect(d.audioDestination),P.addTrack(d.audioDestination.stream.getTracks().filter(function(W){return W.kind==="audio"})[0])}a.push(P)})},this.releaseStreams=function(){m=[],g=!0,d.gainNode&&(d.gainNode.disconnect(),d.gainNode=null),d.audioSources.length&&(d.audioSources.forEach(function(u){u.disconnect()}),d.audioSources=[]),d.audioDestination&&(d.audioDestination.disconnect(),d.audioDestination=null),d.audioContext&&d.audioContext.close(),d.audioContext=null,w.clearRect(0,0,_.width,_.height),_.stream&&(_.stream.stop(),_.stream=null)},this.resetVideoStreams=function(u){u&&!(u instanceof Array)&&(u=[u]),H(u)};function H(u){m=[],u=u||a,u.forEach(function(b){if(!!b.getTracks().filter(function(U){return U.kind==="video"}).length){var P=C(b);P.stream=b,m.push(P)}})}this.name="MultiStreamsMixer",this.toString=function(){return this.name},this.getMixedStream=E}typeof y>"u"&&(K.exports=Be);/**
 * MultiStreamRecorder can record multiple videos in single container.
 * @summary Multi-videos recorder.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef MultiStreamRecorder
 * @class
 * @example
 * var options = {
 *     mimeType: 'video/webm'
 * }
 * var recorder = new MultiStreamRecorder(ArrayOfMediaStreams, options);
 * recorder.record();
 * recorder.stop(function(blob) {
 *     video.src = URL.createObjectURL(blob);
 *
 *     // or
 *     var blob = recorder.blob;
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStreams} mediaStreams - Array of MediaStreams.
 * @param {object} config - {disableLogs:true, frameInterval: 1, mimeType: "video/webm"}
 */function X(a,t){a=a||[];var o=this,m,g;t=t||{elementClass:"multi-streams-mixer",mimeType:"video/webm",video:{width:360,height:240}},t.frameInterval||(t.frameInterval=10),t.video||(t.video={}),t.video.width||(t.video.width=360),t.video.height||(t.video.height=240),this.record=function(){m=new Be(a,t.elementClass||"multi-streams-mixer"),_().length&&(m.frameInterval=t.frameInterval||10,m.width=t.video.width||360,m.height=t.video.height||240,m.startDrawingFrames()),t.previewStream&&typeof t.previewStream=="function"&&t.previewStream(m.getMixedStream()),g=new k(m.getMixedStream(),t),g.record()};function _(){var w=[];return a.forEach(function(d){V(d,"video").forEach(function(T){w.push(T)})}),w}this.stop=function(w){!g||g.stop(function(d){o.blob=d,w(d),o.clearRecordedData()})},this.pause=function(){g&&g.pause()},this.resume=function(){g&&g.resume()},this.clearRecordedData=function(){g&&(g.clearRecordedData(),g=null),m&&(m.releaseStreams(),m=null)},this.addStreams=function(w){if(!w)throw"First parameter is required.";w instanceof Array||(w=[w]),a.concat(w),!(!g||!m)&&(m.appendStreams(w),t.previewStream&&typeof t.previewStream=="function"&&t.previewStream(m.getMixedStream()))},this.resetVideoStreams=function(w){!m||(w&&!(w instanceof Array)&&(w=[w]),m.resetVideoStreams(w))},this.getMixer=function(){return m},this.name="MultiStreamRecorder",this.toString=function(){return this.name}}typeof y<"u"&&(y.MultiStreamRecorder=X);/**
 * RecordRTCPromisesHandler adds promises support in {@link RecordRTC}. Try a {@link https://github.com/muaz-khan/RecordRTC/blob/master/simple-demos/RecordRTCPromisesHandler.html|demo here}
 * @summary Promises for {@link RecordRTC}
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef RecordRTCPromisesHandler
 * @class
 * @example
 * var recorder = new RecordRTCPromisesHandler(mediaStream, options);
 * recorder.startRecording()
 *         .then(successCB)
 *         .catch(errorCB);
 * // Note: You can access all RecordRTC API using "recorder.recordRTC" e.g. 
 * recorder.recordRTC.onStateChanged = function(state) {};
 * recorder.recordRTC.setRecordingDuration(5000);
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - Single media-stream object, array of media-streams, html-canvas-element, etc.
 * @param {object} config - {type:"video", recorderType: MediaStreamRecorder, disableLogs: true, numberOfAudioChannels: 1, bufferSize: 0, sampleRate: 0, video: HTMLVideoElement, etc.}
 * @throws Will throw an error if "new" keyword is not used to initiate "RecordRTCPromisesHandler". Also throws error if first argument "MediaStream" is missing.
 * @requires {@link RecordRTC}
 */function He(a,t){if(!this)throw'Use "new RecordRTCPromisesHandler()"';if(typeof a>"u")throw'First argument "MediaStream" is required.';var o=this;o.recordRTC=new y(a,t),this.startRecording=function(){return new Promise(function(m,g){try{o.recordRTC.startRecording(),m()}catch(_){g(_)}})},this.stopRecording=function(){return new Promise(function(m,g){try{o.recordRTC.stopRecording(function(_){if(o.blob=o.recordRTC.getBlob(),!o.blob||!o.blob.size){g("Empty blob.",o.blob);return}m(_)})}catch(_){g(_)}})},this.pauseRecording=function(){return new Promise(function(m,g){try{o.recordRTC.pauseRecording(),m()}catch(_){g(_)}})},this.resumeRecording=function(){return new Promise(function(m,g){try{o.recordRTC.resumeRecording(),m()}catch(_){g(_)}})},this.getDataURL=function(m){return new Promise(function(g,_){try{o.recordRTC.getDataURL(function(w){g(w)})}catch(w){_(w)}})},this.getBlob=function(){return new Promise(function(m,g){try{m(o.recordRTC.getBlob())}catch(_){g(_)}})},this.getInternalRecorder=function(){return new Promise(function(m,g){try{m(o.recordRTC.getInternalRecorder())}catch(_){g(_)}})},this.reset=function(){return new Promise(function(m,g){try{m(o.recordRTC.reset())}catch(_){g(_)}})},this.destroy=function(){return new Promise(function(m,g){try{m(o.recordRTC.destroy())}catch(_){g(_)}})},this.getState=function(){return new Promise(function(m,g){try{m(o.recordRTC.getState())}catch(_){g(_)}})},this.blob=null,this.version="5.6.2"}typeof y<"u"&&(y.RecordRTCPromisesHandler=He);/**
 * WebAssemblyRecorder lets you create webm videos in JavaScript via WebAssembly. The library consumes raw RGBA32 buffers (4 bytes per pixel) and turns them into a webm video with the given framerate and quality. This makes it compatible out-of-the-box with ImageData from a CANVAS. With realtime mode you can also use webm-wasm for streaming webm videos.
 * @summary Video recording feature in Chrome, Firefox and maybe Edge.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef WebAssemblyRecorder
 * @class
 * @example
 * var recorder = new WebAssemblyRecorder(mediaStream);
 * recorder.record();
 * recorder.stop(function(blob) {
 *     video.src = URL.createObjectURL(blob);
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @param {object} config - {webAssemblyPath:'webm-wasm.wasm',workerPath: 'webm-worker.js', frameRate: 30, width: 1920, height: 1080, bitrate: 1024, realtime: true}
 */function Oe(a,t){(typeof ReadableStream>"u"||typeof WritableStream>"u")&&console.error("Following polyfill is strongly recommended: https://unpkg.com/@mattiasbuelens/web-streams-polyfill/dist/polyfill.min.js"),t=t||{},t.width=t.width||640,t.height=t.height||480,t.frameRate=t.frameRate||30,t.bitrate=t.bitrate||1200,t.realtime=t.realtime||!0;var o;function m(){return new ReadableStream({start:function(B){var R=document.createElement("canvas"),D=document.createElement("video"),S=!0;D.srcObject=a,D.muted=!0,D.height=t.height,D.width=t.width,D.volume=0,D.onplaying=function(){R.width=t.width,R.height=t.height;var L=R.getContext("2d"),A=1e3/t.frameRate,E=setInterval(function(){if(o&&(clearInterval(E),B.close()),S&&(S=!1,t.onVideoProcessStarted&&t.onVideoProcessStarted()),L.drawImage(D,0,0),B._controlledReadableStream.state!=="closed")try{B.enqueue(L.getImageData(0,0,t.width,t.height))}catch{}},A)},D.play()}})}var g;function _(B,R){if(!t.workerPath&&!R){o=!1,fetch("https://unpkg.com/webm-wasm@latest/dist/webm-worker.js").then(function(S){S.arrayBuffer().then(function(L){_(B,L)})});return}if(!t.workerPath&&R instanceof ArrayBuffer){var D=new Blob([R],{type:"text/javascript"});t.workerPath=N.createObjectURL(D)}t.workerPath||console.error("workerPath parameter is missing."),g=new Worker(t.workerPath),g.postMessage(t.webAssemblyPath||"https://unpkg.com/webm-wasm@latest/dist/webm-wasm.wasm"),g.addEventListener("message",function(S){S.data==="READY"?(g.postMessage({width:t.width,height:t.height,bitrate:t.bitrate||1200,timebaseDen:t.frameRate||30,realtime:t.realtime}),m().pipeTo(new WritableStream({write:function(L){if(o){console.error("Got image, but recorder is finished!");return}g.postMessage(L.data.buffer,[L.data.buffer])}}))):S.data&&(w||T.push(S.data))})}this.record=function(){T=[],w=!1,this.blob=null,_(a),typeof t.initCallback=="function"&&t.initCallback()};var w;this.pause=function(){w=!0},this.resume=function(){w=!1};function d(B){if(!g){B&&B();return}g.addEventListener("message",function(R){R.data===null&&(g.terminate(),g=null,B&&B())}),g.postMessage(null)}var T=[];this.stop=function(B){o=!0;var R=this;d(function(){R.blob=new Blob(T,{type:"video/webm"}),B(R.blob)})},this.name="WebAssemblyRecorder",this.toString=function(){return this.name},this.clearRecordedData=function(){T=[],w=!1,this.blob=null},this.blob=null}typeof y<"u"&&(y.WebAssemblyRecorder=Oe)})(ut);var ft={};/*!
 *  howler.js v2.2.3
 *  howlerjs.com
 *
 *  (c) 2013-2020, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */(function(K){(function(){var y=function(){this.init()};y.prototype={init:function(){var e=this||i;return e._counter=1e3,e._html5AudioPool=[],e.html5PoolSize=10,e._codecs={},e._howls=[],e._muted=!1,e._volume=1,e._canPlayEvent="canplaythrough",e._navigator=typeof window<"u"&&window.navigator?window.navigator:null,e.masterGain=null,e.noAudio=!1,e.usingWebAudio=!0,e.autoSuspend=!0,e.ctx=null,e.autoUnlock=!0,e._setup(),e},volume:function(e){var r=this||i;if(e=parseFloat(e),r.ctx||N(),typeof e<"u"&&e>=0&&e<=1){if(r._volume=e,r._muted)return r;r.usingWebAudio&&r.masterGain.gain.setValueAtTime(e,i.ctx.currentTime);for(var n=0;n<r._howls.length;n++)if(!r._howls[n]._webAudio)for(var s=r._howls[n]._getSoundIds(),h=0;h<s.length;h++){var v=r._howls[n]._soundById(s[h]);v&&v._node&&(v._node.volume=v._volume*e)}return r}return r._volume},mute:function(e){var r=this||i;r.ctx||N(),r._muted=e,r.usingWebAudio&&r.masterGain.gain.setValueAtTime(e?0:r._volume,i.ctx.currentTime);for(var n=0;n<r._howls.length;n++)if(!r._howls[n]._webAudio)for(var s=r._howls[n]._getSoundIds(),h=0;h<s.length;h++){var v=r._howls[n]._soundById(s[h]);v&&v._node&&(v._node.muted=e?!0:v._muted)}return r},stop:function(){for(var e=this||i,r=0;r<e._howls.length;r++)e._howls[r].stop();return e},unload:function(){for(var e=this||i,r=e._howls.length-1;r>=0;r--)e._howls[r].unload();return e.usingWebAudio&&e.ctx&&typeof e.ctx.close<"u"&&(e.ctx.close(),e.ctx=null,N()),e},codecs:function(e){return(this||i)._codecs[e.replace(/^x-/,"")]},_setup:function(){var e=this||i;if(e.state=e.ctx&&e.ctx.state||"suspended",e._autoSuspend(),!e.usingWebAudio)if(typeof Audio<"u")try{var r=new Audio;typeof r.oncanplaythrough>"u"&&(e._canPlayEvent="canplay")}catch{e.noAudio=!0}else e.noAudio=!0;try{var r=new Audio;r.muted&&(e.noAudio=!0)}catch{}return e.noAudio||e._setupCodecs(),e},_setupCodecs:function(){var e=this||i,r=null;try{r=typeof Audio<"u"?new Audio:null}catch{return e}if(!r||typeof r.canPlayType!="function")return e;var n=r.canPlayType("audio/mpeg;").replace(/^no$/,""),s=e._navigator?e._navigator.userAgent:"",h=s.match(/OPR\/([0-6].)/g),v=h&&parseInt(h[0].split("/")[1],10)<33,f=s.indexOf("Safari")!==-1&&s.indexOf("Chrome")===-1,O=s.match(/Version\/(.*?) /),q=f&&O&&parseInt(O[1],10)<15;return e._codecs={mp3:!!(!v&&(n||r.canPlayType("audio/mp3;").replace(/^no$/,""))),mpeg:!!n,opus:!!r.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!r.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!r.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(r.canPlayType('audio/wav; codecs="1"')||r.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!r.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!r.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(r.canPlayType("audio/x-m4a;")||r.canPlayType("audio/m4a;")||r.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(r.canPlayType("audio/x-m4b;")||r.canPlayType("audio/m4b;")||r.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(r.canPlayType("audio/x-mp4;")||r.canPlayType("audio/mp4;")||r.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!(!q&&r.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:!!(!q&&r.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:!!r.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(r.canPlayType("audio/x-flac;")||r.canPlayType("audio/flac;")).replace(/^no$/,"")},e},_unlockAudio:function(){var e=this||i;if(!(e._audioUnlocked||!e.ctx)){e._audioUnlocked=!1,e.autoUnlock=!1,!e._mobileUnloaded&&e.ctx.sampleRate!==44100&&(e._mobileUnloaded=!0,e.unload()),e._scratchBuffer=e.ctx.createBuffer(1,1,22050);var r=function(n){for(;e._html5AudioPool.length<e.html5PoolSize;)try{var s=new Audio;s._unlocked=!0,e._releaseHtml5Audio(s)}catch{e.noAudio=!0;break}for(var h=0;h<e._howls.length;h++)if(!e._howls[h]._webAudio)for(var v=e._howls[h]._getSoundIds(),f=0;f<v.length;f++){var O=e._howls[h]._soundById(v[f]);O&&O._node&&!O._node._unlocked&&(O._node._unlocked=!0,O._node.load())}e._autoResume();var q=e.ctx.createBufferSource();q.buffer=e._scratchBuffer,q.connect(e.ctx.destination),typeof q.start>"u"?q.noteOn(0):q.start(0),typeof e.ctx.resume=="function"&&e.ctx.resume(),q.onended=function(){q.disconnect(0),e._audioUnlocked=!0,document.removeEventListener("touchstart",r,!0),document.removeEventListener("touchend",r,!0),document.removeEventListener("click",r,!0),document.removeEventListener("keydown",r,!0);for(var V=0;V<e._howls.length;V++)e._howls[V]._emit("unlock")}};return document.addEventListener("touchstart",r,!0),document.addEventListener("touchend",r,!0),document.addEventListener("click",r,!0),document.addEventListener("keydown",r,!0),e}},_obtainHtml5Audio:function(){var e=this||i;if(e._html5AudioPool.length)return e._html5AudioPool.pop();var r=new Audio().play();return r&&typeof Promise<"u"&&(r instanceof Promise||typeof r.then=="function")&&r.catch(function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")}),new Audio},_releaseHtml5Audio:function(e){var r=this||i;return e._unlocked&&r._html5AudioPool.push(e),r},_autoSuspend:function(){var e=this;if(!(!e.autoSuspend||!e.ctx||typeof e.ctx.suspend>"u"||!i.usingWebAudio)){for(var r=0;r<e._howls.length;r++)if(e._howls[r]._webAudio){for(var n=0;n<e._howls[r]._sounds.length;n++)if(!e._howls[r]._sounds[n]._paused)return e}return e._suspendTimer&&clearTimeout(e._suspendTimer),e._suspendTimer=setTimeout(function(){if(!!e.autoSuspend){e._suspendTimer=null,e.state="suspending";var s=function(){e.state="suspended",e._resumeAfterSuspend&&(delete e._resumeAfterSuspend,e._autoResume())};e.ctx.suspend().then(s,s)}},3e4),e}},_autoResume:function(){var e=this;if(!(!e.ctx||typeof e.ctx.resume>"u"||!i.usingWebAudio))return e.state==="running"&&e.ctx.state!=="interrupted"&&e._suspendTimer?(clearTimeout(e._suspendTimer),e._suspendTimer=null):e.state==="suspended"||e.state==="running"&&e.ctx.state==="interrupted"?(e.ctx.resume().then(function(){e.state="running";for(var r=0;r<e._howls.length;r++)e._howls[r]._emit("resume")}),e._suspendTimer&&(clearTimeout(e._suspendTimer),e._suspendTimer=null)):e.state==="suspending"&&(e._resumeAfterSuspend=!0),e}};var i=new y,p=function(e){var r=this;if(!e.src||e.src.length===0){console.error("An array of source files must be passed with any new Howl.");return}r.init(e)};p.prototype={init:function(e){var r=this;return i.ctx||N(),r._autoplay=e.autoplay||!1,r._format=typeof e.format!="string"?e.format:[e.format],r._html5=e.html5||!1,r._muted=e.mute||!1,r._loop=e.loop||!1,r._pool=e.pool||5,r._preload=typeof e.preload=="boolean"||e.preload==="metadata"?e.preload:!0,r._rate=e.rate||1,r._sprite=e.sprite||{},r._src=typeof e.src!="string"?e.src:[e.src],r._volume=e.volume!==void 0?e.volume:1,r._xhr={method:e.xhr&&e.xhr.method?e.xhr.method:"GET",headers:e.xhr&&e.xhr.headers?e.xhr.headers:null,withCredentials:e.xhr&&e.xhr.withCredentials?e.xhr.withCredentials:!1},r._duration=0,r._state="unloaded",r._sounds=[],r._endTimers={},r._queue=[],r._playLock=!1,r._onend=e.onend?[{fn:e.onend}]:[],r._onfade=e.onfade?[{fn:e.onfade}]:[],r._onload=e.onload?[{fn:e.onload}]:[],r._onloaderror=e.onloaderror?[{fn:e.onloaderror}]:[],r._onplayerror=e.onplayerror?[{fn:e.onplayerror}]:[],r._onpause=e.onpause?[{fn:e.onpause}]:[],r._onplay=e.onplay?[{fn:e.onplay}]:[],r._onstop=e.onstop?[{fn:e.onstop}]:[],r._onmute=e.onmute?[{fn:e.onmute}]:[],r._onvolume=e.onvolume?[{fn:e.onvolume}]:[],r._onrate=e.onrate?[{fn:e.onrate}]:[],r._onseek=e.onseek?[{fn:e.onseek}]:[],r._onunlock=e.onunlock?[{fn:e.onunlock}]:[],r._onresume=[],r._webAudio=i.usingWebAudio&&!r._html5,typeof i.ctx<"u"&&i.ctx&&i.autoUnlock&&i._unlockAudio(),i._howls.push(r),r._autoplay&&r._queue.push({event:"play",action:function(){r.play()}}),r._preload&&r._preload!=="none"&&r.load(),r},load:function(){var e=this,r=null;if(i.noAudio){e._emit("loaderror",null,"No audio support.");return}typeof e._src=="string"&&(e._src=[e._src]);for(var n=0;n<e._src.length;n++){var s,h;if(e._format&&e._format[n])s=e._format[n];else{if(h=e._src[n],typeof h!="string"){e._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}s=/^data:audio\/([^;,]+);/i.exec(h),s||(s=/\.([^.]+)$/.exec(h.split("?",1)[0])),s&&(s=s[1].toLowerCase())}if(s||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),s&&i.codecs(s)){r=e._src[n];break}}if(!r){e._emit("loaderror",null,"No codec support for selected audio sources.");return}return e._src=r,e._state="loading",window.location.protocol==="https:"&&r.slice(0,5)==="http:"&&(e._html5=!0,e._webAudio=!1),new c(e),e._webAudio&&I(e),e},play:function(e,r){var n=this,s=null;if(typeof e=="number")s=e,e=null;else{if(typeof e=="string"&&n._state==="loaded"&&!n._sprite[e])return null;if(typeof e>"u"&&(e="__default",!n._playLock)){for(var h=0,v=0;v<n._sounds.length;v++)n._sounds[v]._paused&&!n._sounds[v]._ended&&(h++,s=n._sounds[v]._id);h===1?e=null:s=null}}var f=s?n._soundById(s):n._inactiveSound();if(!f)return null;if(s&&!e&&(e=f._sprite||"__default"),n._state!=="loaded"){f._sprite=e,f._ended=!1;var O=f._id;return n._queue.push({event:"play",action:function(){n.play(O)}}),O}if(s&&!f._paused)return r||n._loadQueue("play"),f._id;n._webAudio&&i._autoResume();var q=Math.max(0,f._seek>0?f._seek:n._sprite[e][0]/1e3),V=Math.max(0,(n._sprite[e][0]+n._sprite[e][1])/1e3-q),fe=V*1e3/Math.abs(f._rate),ye=n._sprite[e][0]/1e3,ce=(n._sprite[e][0]+n._sprite[e][1])/1e3;f._sprite=e,f._ended=!1;var pe=function(){f._paused=!1,f._seek=q,f._start=ye,f._stop=ce,f._loop=!!(f._loop||n._sprite[e][2])};if(q>=ce){n._ended(f);return}var k=f._node;if(n._webAudio){var G=function(){n._playLock=!1,pe(),n._refreshBuffer(f);var ee=f._muted||n._muted?0:f._volume;k.gain.setValueAtTime(ee,i.ctx.currentTime),f._playStart=i.ctx.currentTime,typeof k.bufferSource.start>"u"?f._loop?k.bufferSource.noteGrainOn(0,q,86400):k.bufferSource.noteGrainOn(0,q,V):f._loop?k.bufferSource.start(0,q,86400):k.bufferSource.start(0,q,V),fe!==1/0&&(n._endTimers[f._id]=setTimeout(n._ended.bind(n,f),fe)),r||setTimeout(function(){n._emit("play",f._id),n._loadQueue()},0)};i.state==="running"&&i.ctx.state!=="interrupted"?G():(n._playLock=!0,n.once("resume",G),n._clearTimer(f._id))}else{var $=function(){k.currentTime=q,k.muted=f._muted||n._muted||i._muted||k.muted,k.volume=f._volume*i.volume(),k.playbackRate=f._rate;try{var ee=k.play();if(ee&&typeof Promise<"u"&&(ee instanceof Promise||typeof ee.then=="function")?(n._playLock=!0,pe(),ee.then(function(){n._playLock=!1,k._unlocked=!0,r?n._loadQueue():n._emit("play",f._id)}).catch(function(){n._playLock=!1,n._emit("playerror",f._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),f._ended=!0,f._paused=!0})):r||(n._playLock=!1,pe(),n._emit("play",f._id)),k.playbackRate=f._rate,k.paused){n._emit("playerror",f._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");return}e!=="__default"||f._loop?n._endTimers[f._id]=setTimeout(n._ended.bind(n,f),fe):(n._endTimers[f._id]=function(){n._ended(f),k.removeEventListener("ended",n._endTimers[f._id],!1)},k.addEventListener("ended",n._endTimers[f._id],!1))}catch(he){n._emit("playerror",f._id,he)}};k.src==="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"&&(k.src=n._src,k.load());var te=window&&window.ejecta||!k.readyState&&i._navigator.isCocoonJS;if(k.readyState>=3||te)$();else{n._playLock=!0,n._state="loading";var ae=function(){n._state="loaded",$(),k.removeEventListener(i._canPlayEvent,ae,!1)};k.addEventListener(i._canPlayEvent,ae,!1),n._clearTimer(f._id)}}return f._id},pause:function(e){var r=this;if(r._state!=="loaded"||r._playLock)return r._queue.push({event:"pause",action:function(){r.pause(e)}}),r;for(var n=r._getSoundIds(e),s=0;s<n.length;s++){r._clearTimer(n[s]);var h=r._soundById(n[s]);if(h&&!h._paused&&(h._seek=r.seek(n[s]),h._rateSeek=0,h._paused=!0,r._stopFade(n[s]),h._node))if(r._webAudio){if(!h._node.bufferSource)continue;typeof h._node.bufferSource.stop>"u"?h._node.bufferSource.noteOff(0):h._node.bufferSource.stop(0),r._cleanBuffer(h._node)}else(!isNaN(h._node.duration)||h._node.duration===1/0)&&h._node.pause();arguments[1]||r._emit("pause",h?h._id:null)}return r},stop:function(e,r){var n=this;if(n._state!=="loaded"||n._playLock)return n._queue.push({event:"stop",action:function(){n.stop(e)}}),n;for(var s=n._getSoundIds(e),h=0;h<s.length;h++){n._clearTimer(s[h]);var v=n._soundById(s[h]);v&&(v._seek=v._start||0,v._rateSeek=0,v._paused=!0,v._ended=!0,n._stopFade(s[h]),v._node&&(n._webAudio?v._node.bufferSource&&(typeof v._node.bufferSource.stop>"u"?v._node.bufferSource.noteOff(0):v._node.bufferSource.stop(0),n._cleanBuffer(v._node)):(!isNaN(v._node.duration)||v._node.duration===1/0)&&(v._node.currentTime=v._start||0,v._node.pause(),v._node.duration===1/0&&n._clearSound(v._node))),r||n._emit("stop",v._id))}return n},mute:function(e,r){var n=this;if(n._state!=="loaded"||n._playLock)return n._queue.push({event:"mute",action:function(){n.mute(e,r)}}),n;if(typeof r>"u")if(typeof e=="boolean")n._muted=e;else return n._muted;for(var s=n._getSoundIds(r),h=0;h<s.length;h++){var v=n._soundById(s[h]);v&&(v._muted=e,v._interval&&n._stopFade(v._id),n._webAudio&&v._node?v._node.gain.setValueAtTime(e?0:v._volume,i.ctx.currentTime):v._node&&(v._node.muted=i._muted?!0:e),n._emit("mute",v._id))}return n},volume:function(){var e=this,r=arguments,n,s;if(r.length===0)return e._volume;if(r.length===1||r.length===2&&typeof r[1]>"u"){var h=e._getSoundIds(),v=h.indexOf(r[0]);v>=0?s=parseInt(r[0],10):n=parseFloat(r[0])}else r.length>=2&&(n=parseFloat(r[0]),s=parseInt(r[1],10));var f;if(typeof n<"u"&&n>=0&&n<=1){if(e._state!=="loaded"||e._playLock)return e._queue.push({event:"volume",action:function(){e.volume.apply(e,r)}}),e;typeof s>"u"&&(e._volume=n),s=e._getSoundIds(s);for(var O=0;O<s.length;O++)f=e._soundById(s[O]),f&&(f._volume=n,r[2]||e._stopFade(s[O]),e._webAudio&&f._node&&!f._muted?f._node.gain.setValueAtTime(n,i.ctx.currentTime):f._node&&!f._muted&&(f._node.volume=n*i.volume()),e._emit("volume",f._id))}else return f=s?e._soundById(s):e._sounds[0],f?f._volume:0;return e},fade:function(e,r,n,s){var h=this;if(h._state!=="loaded"||h._playLock)return h._queue.push({event:"fade",action:function(){h.fade(e,r,n,s)}}),h;e=Math.min(Math.max(0,parseFloat(e)),1),r=Math.min(Math.max(0,parseFloat(r)),1),n=parseFloat(n),h.volume(e,s);for(var v=h._getSoundIds(s),f=0;f<v.length;f++){var O=h._soundById(v[f]);if(O){if(s||h._stopFade(v[f]),h._webAudio&&!O._muted){var q=i.ctx.currentTime,V=q+n/1e3;O._volume=e,O._node.gain.setValueAtTime(e,q),O._node.gain.linearRampToValueAtTime(r,V)}h._startFadeInterval(O,e,r,n,v[f],typeof s>"u")}}return h},_startFadeInterval:function(e,r,n,s,h,v){var f=this,O=r,q=n-r,V=Math.abs(q/.01),fe=Math.max(4,V>0?s/V:s),ye=Date.now();e._fadeTo=n,e._interval=setInterval(function(){var ce=(Date.now()-ye)/s;ye=Date.now(),O+=q*ce,O=Math.round(O*100)/100,q<0?O=Math.max(n,O):O=Math.min(n,O),f._webAudio?e._volume=O:f.volume(O,e._id,!0),v&&(f._volume=O),(n<r&&O<=n||n>r&&O>=n)&&(clearInterval(e._interval),e._interval=null,e._fadeTo=null,f.volume(n,e._id),f._emit("fade",e._id))},fe)},_stopFade:function(e){var r=this,n=r._soundById(e);return n&&n._interval&&(r._webAudio&&n._node.gain.cancelScheduledValues(i.ctx.currentTime),clearInterval(n._interval),n._interval=null,r.volume(n._fadeTo,e),n._fadeTo=null,r._emit("fade",e)),r},loop:function(){var e=this,r=arguments,n,s,h;if(r.length===0)return e._loop;if(r.length===1)if(typeof r[0]=="boolean")n=r[0],e._loop=n;else return h=e._soundById(parseInt(r[0],10)),h?h._loop:!1;else r.length===2&&(n=r[0],s=parseInt(r[1],10));for(var v=e._getSoundIds(s),f=0;f<v.length;f++)h=e._soundById(v[f]),h&&(h._loop=n,e._webAudio&&h._node&&h._node.bufferSource&&(h._node.bufferSource.loop=n,n&&(h._node.bufferSource.loopStart=h._start||0,h._node.bufferSource.loopEnd=h._stop,e.playing(v[f])&&(e.pause(v[f],!0),e.play(v[f],!0)))));return e},rate:function(){var e=this,r=arguments,n,s;if(r.length===0)s=e._sounds[0]._id;else if(r.length===1){var h=e._getSoundIds(),v=h.indexOf(r[0]);v>=0?s=parseInt(r[0],10):n=parseFloat(r[0])}else r.length===2&&(n=parseFloat(r[0]),s=parseInt(r[1],10));var f;if(typeof n=="number"){if(e._state!=="loaded"||e._playLock)return e._queue.push({event:"rate",action:function(){e.rate.apply(e,r)}}),e;typeof s>"u"&&(e._rate=n),s=e._getSoundIds(s);for(var O=0;O<s.length;O++)if(f=e._soundById(s[O]),f){e.playing(s[O])&&(f._rateSeek=e.seek(s[O]),f._playStart=e._webAudio?i.ctx.currentTime:f._playStart),f._rate=n,e._webAudio&&f._node&&f._node.bufferSource?f._node.bufferSource.playbackRate.setValueAtTime(n,i.ctx.currentTime):f._node&&(f._node.playbackRate=n);var q=e.seek(s[O]),V=(e._sprite[f._sprite][0]+e._sprite[f._sprite][1])/1e3-q,fe=V*1e3/Math.abs(f._rate);(e._endTimers[s[O]]||!f._paused)&&(e._clearTimer(s[O]),e._endTimers[s[O]]=setTimeout(e._ended.bind(e,f),fe)),e._emit("rate",f._id)}}else return f=e._soundById(s),f?f._rate:e._rate;return e},seek:function(){var e=this,r=arguments,n,s;if(r.length===0)e._sounds.length&&(s=e._sounds[0]._id);else if(r.length===1){var h=e._getSoundIds(),v=h.indexOf(r[0]);v>=0?s=parseInt(r[0],10):e._sounds.length&&(s=e._sounds[0]._id,n=parseFloat(r[0]))}else r.length===2&&(n=parseFloat(r[0]),s=parseInt(r[1],10));if(typeof s>"u")return 0;if(typeof n=="number"&&(e._state!=="loaded"||e._playLock))return e._queue.push({event:"seek",action:function(){e.seek.apply(e,r)}}),e;var f=e._soundById(s);if(f)if(typeof n=="number"&&n>=0){var O=e.playing(s);O&&e.pause(s,!0),f._seek=n,f._ended=!1,e._clearTimer(s),!e._webAudio&&f._node&&!isNaN(f._node.duration)&&(f._node.currentTime=n);var q=function(){O&&e.play(s,!0),e._emit("seek",s)};if(O&&!e._webAudio){var V=function(){e._playLock?setTimeout(V,0):q()};setTimeout(V,0)}else q()}else if(e._webAudio){var fe=e.playing(s)?i.ctx.currentTime-f._playStart:0,ye=f._rateSeek?f._rateSeek-f._seek:0;return f._seek+(ye+fe*Math.abs(f._rate))}else return f._node.currentTime;return e},playing:function(e){var r=this;if(typeof e=="number"){var n=r._soundById(e);return n?!n._paused:!1}for(var s=0;s<r._sounds.length;s++)if(!r._sounds[s]._paused)return!0;return!1},duration:function(e){var r=this,n=r._duration,s=r._soundById(e);return s&&(n=r._sprite[s._sprite][1]/1e3),n},state:function(){return this._state},unload:function(){for(var e=this,r=e._sounds,n=0;n<r.length;n++)r[n]._paused||e.stop(r[n]._id),e._webAudio||(e._clearSound(r[n]._node),r[n]._node.removeEventListener("error",r[n]._errorFn,!1),r[n]._node.removeEventListener(i._canPlayEvent,r[n]._loadFn,!1),r[n]._node.removeEventListener("ended",r[n]._endFn,!1),i._releaseHtml5Audio(r[n]._node)),delete r[n]._node,e._clearTimer(r[n]._id);var s=i._howls.indexOf(e);s>=0&&i._howls.splice(s,1);var h=!0;for(n=0;n<i._howls.length;n++)if(i._howls[n]._src===e._src||e._src.indexOf(i._howls[n]._src)>=0){h=!1;break}return F&&h&&delete F[e._src],i.noAudio=!1,e._state="unloaded",e._sounds=[],e=null,null},on:function(e,r,n,s){var h=this,v=h["_on"+e];return typeof r=="function"&&v.push(s?{id:n,fn:r,once:s}:{id:n,fn:r}),h},off:function(e,r,n){var s=this,h=s["_on"+e],v=0;if(typeof r=="number"&&(n=r,r=null),r||n)for(v=0;v<h.length;v++){var f=n===h[v].id;if(r===h[v].fn&&f||!r&&f){h.splice(v,1);break}}else if(e)s["_on"+e]=[];else{var O=Object.keys(s);for(v=0;v<O.length;v++)O[v].indexOf("_on")===0&&Array.isArray(s[O[v]])&&(s[O[v]]=[])}return s},once:function(e,r,n){var s=this;return s.on(e,r,n,1),s},_emit:function(e,r,n){for(var s=this,h=s["_on"+e],v=h.length-1;v>=0;v--)(!h[v].id||h[v].id===r||e==="load")&&(setTimeout(function(f){f.call(this,r,n)}.bind(s,h[v].fn),0),h[v].once&&s.off(e,h[v].fn,h[v].id));return s._loadQueue(e),s},_loadQueue:function(e){var r=this;if(r._queue.length>0){var n=r._queue[0];n.event===e&&(r._queue.shift(),r._loadQueue()),e||n.action()}return r},_ended:function(e){var r=this,n=e._sprite;if(!r._webAudio&&e._node&&!e._node.paused&&!e._node.ended&&e._node.currentTime<e._stop)return setTimeout(r._ended.bind(r,e),100),r;var s=!!(e._loop||r._sprite[n][2]);if(r._emit("end",e._id),!r._webAudio&&s&&r.stop(e._id,!0).play(e._id),r._webAudio&&s){r._emit("play",e._id),e._seek=e._start||0,e._rateSeek=0,e._playStart=i.ctx.currentTime;var h=(e._stop-e._start)*1e3/Math.abs(e._rate);r._endTimers[e._id]=setTimeout(r._ended.bind(r,e),h)}return r._webAudio&&!s&&(e._paused=!0,e._ended=!0,e._seek=e._start||0,e._rateSeek=0,r._clearTimer(e._id),r._cleanBuffer(e._node),i._autoSuspend()),!r._webAudio&&!s&&r.stop(e._id,!0),r},_clearTimer:function(e){var r=this;if(r._endTimers[e]){if(typeof r._endTimers[e]!="function")clearTimeout(r._endTimers[e]);else{var n=r._soundById(e);n&&n._node&&n._node.removeEventListener("ended",r._endTimers[e],!1)}delete r._endTimers[e]}return r},_soundById:function(e){for(var r=this,n=0;n<r._sounds.length;n++)if(e===r._sounds[n]._id)return r._sounds[n];return null},_inactiveSound:function(){var e=this;e._drain();for(var r=0;r<e._sounds.length;r++)if(e._sounds[r]._ended)return e._sounds[r].reset();return new c(e)},_drain:function(){var e=this,r=e._pool,n=0,s=0;if(!(e._sounds.length<r)){for(s=0;s<e._sounds.length;s++)e._sounds[s]._ended&&n++;for(s=e._sounds.length-1;s>=0;s--){if(n<=r)return;e._sounds[s]._ended&&(e._webAudio&&e._sounds[s]._node&&e._sounds[s]._node.disconnect(0),e._sounds.splice(s,1),n--)}}},_getSoundIds:function(e){var r=this;if(typeof e>"u"){for(var n=[],s=0;s<r._sounds.length;s++)n.push(r._sounds[s]._id);return n}else return[e]},_refreshBuffer:function(e){var r=this;return e._node.bufferSource=i.ctx.createBufferSource(),e._node.bufferSource.buffer=F[r._src],e._panner?e._node.bufferSource.connect(e._panner):e._node.bufferSource.connect(e._node),e._node.bufferSource.loop=e._loop,e._loop&&(e._node.bufferSource.loopStart=e._start||0,e._node.bufferSource.loopEnd=e._stop||0),e._node.bufferSource.playbackRate.setValueAtTime(e._rate,i.ctx.currentTime),r},_cleanBuffer:function(e){var r=this,n=i._navigator&&i._navigator.vendor.indexOf("Apple")>=0;if(i._scratchBuffer&&e.bufferSource&&(e.bufferSource.onended=null,e.bufferSource.disconnect(0),n))try{e.bufferSource.buffer=i._scratchBuffer}catch{}return e.bufferSource=null,r},_clearSound:function(e){var r=/MSIE |Trident\//.test(i._navigator&&i._navigator.userAgent);r||(e.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var c=function(e){this._parent=e,this.init()};c.prototype={init:function(){var e=this,r=e._parent;return e._muted=r._muted,e._loop=r._loop,e._volume=r._volume,e._rate=r._rate,e._seek=0,e._paused=!0,e._ended=!0,e._sprite="__default",e._id=++i._counter,r._sounds.push(e),e.create(),e},create:function(){var e=this,r=e._parent,n=i._muted||e._muted||e._parent._muted?0:e._volume;return r._webAudio?(e._node=typeof i.ctx.createGain>"u"?i.ctx.createGainNode():i.ctx.createGain(),e._node.gain.setValueAtTime(n,i.ctx.currentTime),e._node.paused=!0,e._node.connect(i.masterGain)):i.noAudio||(e._node=i._obtainHtml5Audio(),e._errorFn=e._errorListener.bind(e),e._node.addEventListener("error",e._errorFn,!1),e._loadFn=e._loadListener.bind(e),e._node.addEventListener(i._canPlayEvent,e._loadFn,!1),e._endFn=e._endListener.bind(e),e._node.addEventListener("ended",e._endFn,!1),e._node.src=r._src,e._node.preload=r._preload===!0?"auto":r._preload,e._node.volume=n*i.volume(),e._node.load()),e},reset:function(){var e=this,r=e._parent;return e._muted=r._muted,e._loop=r._loop,e._volume=r._volume,e._rate=r._rate,e._seek=0,e._rateSeek=0,e._paused=!0,e._ended=!0,e._sprite="__default",e._id=++i._counter,e},_errorListener:function(){var e=this;e._parent._emit("loaderror",e._id,e._node.error?e._node.error.code:0),e._node.removeEventListener("error",e._errorFn,!1)},_loadListener:function(){var e=this,r=e._parent;r._duration=Math.ceil(e._node.duration*10)/10,Object.keys(r._sprite).length===0&&(r._sprite={__default:[0,r._duration*1e3]}),r._state!=="loaded"&&(r._state="loaded",r._emit("load"),r._loadQueue()),e._node.removeEventListener(i._canPlayEvent,e._loadFn,!1)},_endListener:function(){var e=this,r=e._parent;r._duration===1/0&&(r._duration=Math.ceil(e._node.duration*10)/10,r._sprite.__default[1]===1/0&&(r._sprite.__default[1]=r._duration*1e3),r._ended(e)),e._node.removeEventListener("ended",e._endFn,!1)}};var F={},I=function(e){var r=e._src;if(F[r]){e._duration=F[r].duration,M(e);return}if(/^data:[^;]+;base64,/.test(r)){for(var n=atob(r.split(",")[1]),s=new Uint8Array(n.length),h=0;h<n.length;++h)s[h]=n.charCodeAt(h);x(s.buffer,e)}else{var v=new XMLHttpRequest;v.open(e._xhr.method,r,!0),v.withCredentials=e._xhr.withCredentials,v.responseType="arraybuffer",e._xhr.headers&&Object.keys(e._xhr.headers).forEach(function(f){v.setRequestHeader(f,e._xhr.headers[f])}),v.onload=function(){var f=(v.status+"")[0];if(f!=="0"&&f!=="2"&&f!=="3"){e._emit("loaderror",null,"Failed loading audio file with status: "+v.status+".");return}x(v.response,e)},v.onerror=function(){e._webAudio&&(e._html5=!0,e._webAudio=!1,e._sounds=[],delete F[r],e.load())},Q(v)}},Q=function(e){try{e.send()}catch{e.onerror()}},x=function(e,r){var n=function(){r._emit("loaderror",null,"Decoding audio data failed.")},s=function(h){h&&r._sounds.length>0?(F[r._src]=h,M(r,h)):n()};typeof Promise<"u"&&i.ctx.decodeAudioData.length===1?i.ctx.decodeAudioData(e).then(s).catch(n):i.ctx.decodeAudioData(e,s,n)},M=function(e,r){r&&!e._duration&&(e._duration=r.duration),Object.keys(e._sprite).length===0&&(e._sprite={__default:[0,e._duration*1e3]}),e._state!=="loaded"&&(e._state="loaded",e._emit("load"),e._loadQueue())},N=function(){if(!!i.usingWebAudio){try{typeof AudioContext<"u"?i.ctx=new AudioContext:typeof webkitAudioContext<"u"?i.ctx=new webkitAudioContext:i.usingWebAudio=!1}catch{i.usingWebAudio=!1}i.ctx||(i.usingWebAudio=!1);var e=/iP(hone|od|ad)/.test(i._navigator&&i._navigator.platform),r=i._navigator&&i._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),n=r?parseInt(r[1],10):null;if(e&&n&&n<9){var s=/safari/.test(i._navigator&&i._navigator.userAgent.toLowerCase());i._navigator&&!s&&(i.usingWebAudio=!1)}i.usingWebAudio&&(i.masterGain=typeof i.ctx.createGain>"u"?i.ctx.createGainNode():i.ctx.createGain(),i.masterGain.gain.setValueAtTime(i._muted?0:i._volume,i.ctx.currentTime),i.masterGain.connect(i.ctx.destination)),i._setup()}};K.Howler=i,K.Howl=p,typeof Y<"u"?(Y.HowlerGlobal=y,Y.Howler=i,Y.Howl=p,Y.Sound=c):typeof window<"u"&&(window.HowlerGlobal=y,window.Howler=i,window.Howl=p,window.Sound=c)})();/*!
 *  Spatial Plugin - Adds support for stereo and 3D audio where Web Audio is supported.
 *  
 *  howler.js v2.2.3
 *  howlerjs.com
 *
 *  (c) 2013-2020, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */(function(){HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(i){var p=this;if(!p.ctx||!p.ctx.listener)return p;for(var c=p._howls.length-1;c>=0;c--)p._howls[c].stereo(i);return p},HowlerGlobal.prototype.pos=function(i,p,c){var F=this;if(!F.ctx||!F.ctx.listener)return F;if(p=typeof p!="number"?F._pos[1]:p,c=typeof c!="number"?F._pos[2]:c,typeof i=="number")F._pos=[i,p,c],typeof F.ctx.listener.positionX<"u"?(F.ctx.listener.positionX.setTargetAtTime(F._pos[0],Howler.ctx.currentTime,.1),F.ctx.listener.positionY.setTargetAtTime(F._pos[1],Howler.ctx.currentTime,.1),F.ctx.listener.positionZ.setTargetAtTime(F._pos[2],Howler.ctx.currentTime,.1)):F.ctx.listener.setPosition(F._pos[0],F._pos[1],F._pos[2]);else return F._pos;return F},HowlerGlobal.prototype.orientation=function(i,p,c,F,I,Q){var x=this;if(!x.ctx||!x.ctx.listener)return x;var M=x._orientation;if(p=typeof p!="number"?M[1]:p,c=typeof c!="number"?M[2]:c,F=typeof F!="number"?M[3]:F,I=typeof I!="number"?M[4]:I,Q=typeof Q!="number"?M[5]:Q,typeof i=="number")x._orientation=[i,p,c,F,I,Q],typeof x.ctx.listener.forwardX<"u"?(x.ctx.listener.forwardX.setTargetAtTime(i,Howler.ctx.currentTime,.1),x.ctx.listener.forwardY.setTargetAtTime(p,Howler.ctx.currentTime,.1),x.ctx.listener.forwardZ.setTargetAtTime(c,Howler.ctx.currentTime,.1),x.ctx.listener.upX.setTargetAtTime(F,Howler.ctx.currentTime,.1),x.ctx.listener.upY.setTargetAtTime(I,Howler.ctx.currentTime,.1),x.ctx.listener.upZ.setTargetAtTime(Q,Howler.ctx.currentTime,.1)):x.ctx.listener.setOrientation(i,p,c,F,I,Q);else return M;return x},Howl.prototype.init=function(i){return function(p){var c=this;return c._orientation=p.orientation||[1,0,0],c._stereo=p.stereo||null,c._pos=p.pos||null,c._pannerAttr={coneInnerAngle:typeof p.coneInnerAngle<"u"?p.coneInnerAngle:360,coneOuterAngle:typeof p.coneOuterAngle<"u"?p.coneOuterAngle:360,coneOuterGain:typeof p.coneOuterGain<"u"?p.coneOuterGain:0,distanceModel:typeof p.distanceModel<"u"?p.distanceModel:"inverse",maxDistance:typeof p.maxDistance<"u"?p.maxDistance:1e4,panningModel:typeof p.panningModel<"u"?p.panningModel:"HRTF",refDistance:typeof p.refDistance<"u"?p.refDistance:1,rolloffFactor:typeof p.rolloffFactor<"u"?p.rolloffFactor:1},c._onstereo=p.onstereo?[{fn:p.onstereo}]:[],c._onpos=p.onpos?[{fn:p.onpos}]:[],c._onorientation=p.onorientation?[{fn:p.onorientation}]:[],i.call(this,p)}}(Howl.prototype.init),Howl.prototype.stereo=function(i,p){var c=this;if(!c._webAudio)return c;if(c._state!=="loaded")return c._queue.push({event:"stereo",action:function(){c.stereo(i,p)}}),c;var F=typeof Howler.ctx.createStereoPanner>"u"?"spatial":"stereo";if(typeof p>"u")if(typeof i=="number")c._stereo=i,c._pos=[i,0,0];else return c._stereo;for(var I=c._getSoundIds(p),Q=0;Q<I.length;Q++){var x=c._soundById(I[Q]);if(x)if(typeof i=="number")x._stereo=i,x._pos=[i,0,0],x._node&&(x._pannerAttr.panningModel="equalpower",(!x._panner||!x._panner.pan)&&y(x,F),F==="spatial"?typeof x._panner.positionX<"u"?(x._panner.positionX.setValueAtTime(i,Howler.ctx.currentTime),x._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),x._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):x._panner.setPosition(i,0,0):x._panner.pan.setValueAtTime(i,Howler.ctx.currentTime)),c._emit("stereo",x._id);else return x._stereo}return c},Howl.prototype.pos=function(i,p,c,F){var I=this;if(!I._webAudio)return I;if(I._state!=="loaded")return I._queue.push({event:"pos",action:function(){I.pos(i,p,c,F)}}),I;if(p=typeof p!="number"?0:p,c=typeof c!="number"?-.5:c,typeof F>"u")if(typeof i=="number")I._pos=[i,p,c];else return I._pos;for(var Q=I._getSoundIds(F),x=0;x<Q.length;x++){var M=I._soundById(Q[x]);if(M)if(typeof i=="number")M._pos=[i,p,c],M._node&&((!M._panner||M._panner.pan)&&y(M,"spatial"),typeof M._panner.positionX<"u"?(M._panner.positionX.setValueAtTime(i,Howler.ctx.currentTime),M._panner.positionY.setValueAtTime(p,Howler.ctx.currentTime),M._panner.positionZ.setValueAtTime(c,Howler.ctx.currentTime)):M._panner.setPosition(i,p,c)),I._emit("pos",M._id);else return M._pos}return I},Howl.prototype.orientation=function(i,p,c,F){var I=this;if(!I._webAudio)return I;if(I._state!=="loaded")return I._queue.push({event:"orientation",action:function(){I.orientation(i,p,c,F)}}),I;if(p=typeof p!="number"?I._orientation[1]:p,c=typeof c!="number"?I._orientation[2]:c,typeof F>"u")if(typeof i=="number")I._orientation=[i,p,c];else return I._orientation;for(var Q=I._getSoundIds(F),x=0;x<Q.length;x++){var M=I._soundById(Q[x]);if(M)if(typeof i=="number")M._orientation=[i,p,c],M._node&&(M._panner||(M._pos||(M._pos=I._pos||[0,0,-.5]),y(M,"spatial")),typeof M._panner.orientationX<"u"?(M._panner.orientationX.setValueAtTime(i,Howler.ctx.currentTime),M._panner.orientationY.setValueAtTime(p,Howler.ctx.currentTime),M._panner.orientationZ.setValueAtTime(c,Howler.ctx.currentTime)):M._panner.setOrientation(i,p,c)),I._emit("orientation",M._id);else return M._orientation}return I},Howl.prototype.pannerAttr=function(){var i=this,p=arguments,c,F,I;if(!i._webAudio)return i;if(p.length===0)return i._pannerAttr;if(p.length===1)if(typeof p[0]=="object")c=p[0],typeof F>"u"&&(c.pannerAttr||(c.pannerAttr={coneInnerAngle:c.coneInnerAngle,coneOuterAngle:c.coneOuterAngle,coneOuterGain:c.coneOuterGain,distanceModel:c.distanceModel,maxDistance:c.maxDistance,refDistance:c.refDistance,rolloffFactor:c.rolloffFactor,panningModel:c.panningModel}),i._pannerAttr={coneInnerAngle:typeof c.pannerAttr.coneInnerAngle<"u"?c.pannerAttr.coneInnerAngle:i._coneInnerAngle,coneOuterAngle:typeof c.pannerAttr.coneOuterAngle<"u"?c.pannerAttr.coneOuterAngle:i._coneOuterAngle,coneOuterGain:typeof c.pannerAttr.coneOuterGain<"u"?c.pannerAttr.coneOuterGain:i._coneOuterGain,distanceModel:typeof c.pannerAttr.distanceModel<"u"?c.pannerAttr.distanceModel:i._distanceModel,maxDistance:typeof c.pannerAttr.maxDistance<"u"?c.pannerAttr.maxDistance:i._maxDistance,refDistance:typeof c.pannerAttr.refDistance<"u"?c.pannerAttr.refDistance:i._refDistance,rolloffFactor:typeof c.pannerAttr.rolloffFactor<"u"?c.pannerAttr.rolloffFactor:i._rolloffFactor,panningModel:typeof c.pannerAttr.panningModel<"u"?c.pannerAttr.panningModel:i._panningModel});else return I=i._soundById(parseInt(p[0],10)),I?I._pannerAttr:i._pannerAttr;else p.length===2&&(c=p[0],F=parseInt(p[1],10));for(var Q=i._getSoundIds(F),x=0;x<Q.length;x++)if(I=i._soundById(Q[x]),I){var M=I._pannerAttr;M={coneInnerAngle:typeof c.coneInnerAngle<"u"?c.coneInnerAngle:M.coneInnerAngle,coneOuterAngle:typeof c.coneOuterAngle<"u"?c.coneOuterAngle:M.coneOuterAngle,coneOuterGain:typeof c.coneOuterGain<"u"?c.coneOuterGain:M.coneOuterGain,distanceModel:typeof c.distanceModel<"u"?c.distanceModel:M.distanceModel,maxDistance:typeof c.maxDistance<"u"?c.maxDistance:M.maxDistance,refDistance:typeof c.refDistance<"u"?c.refDistance:M.refDistance,rolloffFactor:typeof c.rolloffFactor<"u"?c.rolloffFactor:M.rolloffFactor,panningModel:typeof c.panningModel<"u"?c.panningModel:M.panningModel};var N=I._panner;N?(N.coneInnerAngle=M.coneInnerAngle,N.coneOuterAngle=M.coneOuterAngle,N.coneOuterGain=M.coneOuterGain,N.distanceModel=M.distanceModel,N.maxDistance=M.maxDistance,N.refDistance=M.refDistance,N.rolloffFactor=M.rolloffFactor,N.panningModel=M.panningModel):(I._pos||(I._pos=i._pos||[0,0,-.5]),y(I,"spatial"))}return i},Sound.prototype.init=function(i){return function(){var p=this,c=p._parent;p._orientation=c._orientation,p._stereo=c._stereo,p._pos=c._pos,p._pannerAttr=c._pannerAttr,i.call(this),p._stereo?c.stereo(p._stereo):p._pos&&c.pos(p._pos[0],p._pos[1],p._pos[2],p._id)}}(Sound.prototype.init),Sound.prototype.reset=function(i){return function(){var p=this,c=p._parent;return p._orientation=c._orientation,p._stereo=c._stereo,p._pos=c._pos,p._pannerAttr=c._pannerAttr,p._stereo?c.stereo(p._stereo):p._pos?c.pos(p._pos[0],p._pos[1],p._pos[2],p._id):p._panner&&(p._panner.disconnect(0),p._panner=void 0,c._refreshBuffer(p)),i.call(this)}}(Sound.prototype.reset);var y=function(i,p){p=p||"spatial",p==="spatial"?(i._panner=Howler.ctx.createPanner(),i._panner.coneInnerAngle=i._pannerAttr.coneInnerAngle,i._panner.coneOuterAngle=i._pannerAttr.coneOuterAngle,i._panner.coneOuterGain=i._pannerAttr.coneOuterGain,i._panner.distanceModel=i._pannerAttr.distanceModel,i._panner.maxDistance=i._pannerAttr.maxDistance,i._panner.refDistance=i._pannerAttr.refDistance,i._panner.rolloffFactor=i._pannerAttr.rolloffFactor,i._panner.panningModel=i._pannerAttr.panningModel,typeof i._panner.positionX<"u"?(i._panner.positionX.setValueAtTime(i._pos[0],Howler.ctx.currentTime),i._panner.positionY.setValueAtTime(i._pos[1],Howler.ctx.currentTime),i._panner.positionZ.setValueAtTime(i._pos[2],Howler.ctx.currentTime)):i._panner.setPosition(i._pos[0],i._pos[1],i._pos[2]),typeof i._panner.orientationX<"u"?(i._panner.orientationX.setValueAtTime(i._orientation[0],Howler.ctx.currentTime),i._panner.orientationY.setValueAtTime(i._orientation[1],Howler.ctx.currentTime),i._panner.orientationZ.setValueAtTime(i._orientation[2],Howler.ctx.currentTime)):i._panner.setOrientation(i._orientation[0],i._orientation[1],i._orientation[2])):(i._panner=Howler.ctx.createStereoPanner(),i._panner.pan.setValueAtTime(i._stereo,Howler.ctx.currentTime)),i._panner.connect(i._node),i._paused||i._parent.pause(i._id,!0).play(i._id,!0)}})()})(ft);const Tt=K=>it({url:"/group/get_user_list_by_id",method:"POST",data:K}),Ze=K=>it({url:"/upload/file",method:"POST",data:K});var Ue=(K=>(K[K.text=0]="text",K[K.image=1]="image",K[K.audio=2]="audio",K[K.file=3]="file",K))(Ue||{});const St=(K,y)=>{const i=document.createElement("a");return i.style.display="none",i.setAttribute("href",K),i.setAttribute("download",y),document.body.appendChild(i),setTimeout(function(){i.click(),document.body.removeChild(i)},66),!0},kt="/web/assets/camera_fill.e869dfbd.svg",xt="/web/assets/photo_fill.f7d7b398.svg",Ct="/web/assets/video_dial_fill.2e920b0f.svg",lt="/web/assets/file_fill.fa998c17.svg",Lt="/web/assets/yuyin_fill.fd28a397.svg",Mt=[{key:"photo",text:"\u7167\u7247",icon:xt},{key:"camera",text:"\u62CD\u6444",icon:kt},{key:"friend_call",text:"\u8BED\u97F3",icon:Lt},{key:"video_call",text:"\u89C6\u9891",icon:Ct},{key:"file",text:"\u6587\u4EF6",icon:lt}],Dt={class:"container"},Bt={class:"content",id:"msg_content"},It=["id"],Ft={class:"avatar"},Ot=["src"],Pt={class:"time"},Ut=["onClick"],Et=["src"],Ht=["src"],Gt={class:"footer"},Vt={class:"toolbar"},Nt={class:"card"},jt={key:0},Wt={class:"gird-box"},qt=["src"],$t={key:1},zt={class:"gird-box"},Xt=["src"],Yt=["onClick"],Qt={class:"gird-box"},Zt=["src"],Kt={class:"form"},Jt=ot({__name:"index",props:["rid","is_group","nickname","avatar"],setup(K){const y=K,i=at(),p=gt(),c=Rt(),F=Fe("");Fe(!1);const I=Fe([]),Q=Fe(!1),x=Fe(!1),M=Fe(null),N=Ke(()=>{var k,G;return{cmd:y.is_group?rt.group_chat:rt.private_chat,rid:Number(y.rid),is_group:Boolean(y.is_group),to_nickname:y.nickname,to_avatar:y.avatar,from_nickname:(k=p.userInfo)==null?void 0:k.nickname,from_avatar:(G=p.userInfo)==null?void 0:G.avatar}}),e=()=>{i.send({...N.value,content:F.value||"Hello",type:Ue.text})},r=k=>{var G;return k===((G=p.userInfo)==null?void 0:G.id)},n=(k,G)=>{var te;if(r(k))return(te=p.userInfo)==null?void 0:te.avatar;const $=I.value.find(ae=>ae.id===k);return $?$.avatar:""},s=(k,G)=>{var te;if(r(k))return(te=p.userInfo)==null?void 0:te.nickname;const $=I.value.find(ae=>ae.id===k);return $?$.nickname:""},h=Ke(()=>i.list.filter(G=>{const $=G.suid===Number(y.rid),te=G.rid===Number(y.rid);return($||te)&&Number(G.is_group)===y.is_group}).map(G=>({...G,is_me:r(G.suid),avatar:n(G.suid),nickname:s(G.suid)}))),v=async()=>{if(x.value)return;const G=document.querySelectorAll(".msg-item")[0].getAttribute("id");x.value=!0,i.list.filter($=>{const te=$.suid===y.rid,ae=$.rid===y.rid;return(te||ae)&&Number($.is_group)===y.is_group});try{await At(500),await i.queryHistory({rid:y.rid,seq:h.value.length?h.value[0].time:0,is_group:Boolean(y.is_group)}),x.value=!1,setTimeout(()=>{const $=document.querySelector(`#${G}`);i.scrollTo($.offsetTop)},100)}catch($){x.value=!1,Q.value=$.message}},f=()=>{y.is_group?Tt({id:y.rid}).then(k=>{I.value=k.data.list}):c.queryProfile([y.rid]).then(k=>{I.value=k}),i.markHasRead({pid:y.rid})};yt(()=>{f()}),bt(()=>{var k;(k=M.value)==null||k.addEventListener("scroll",G=>{G.target.scrollTop===0&&v()})});const O=k=>st(k).format("hh:mm:ss"),q=k=>{const G=new FormData;G.append("file",k.file),Ze(G).then($=>{$.data&&i.send({...N.value,content:$.data.url,type:Ue.image,title:k.file.name})})},V=k=>{const G=new FormData;G.append("file",k.file),Ze(G).then($=>{$.data&&i.send({...N.value,content:$.data.url,title:k.file.name,type:Ue.file})})},fe=async k=>{if(k.key==="video_call"){y.is_group||i.setDialUser({id:y.rid,nickname:y.nickname,avatar:y.avatar});return}if(k.key==="friend_call"){let G=await navigator.mediaDevices.getUserMedia({video:!0,audio:!0}),$=new ut.exports.RecordRTCPromisesHandler(G,{type:"audio"});$.startRecording();const te=he=>new Promise(Be=>setTimeout(Be,he));wt("\u5F55\u52363S"),await te(3e3),await $.stopRecording();let ae=await $.getBlob();const ee=new FormData;ee.append("file",ae),Ze(ee).then(he=>{he.data&&i.send({...N.value,content:he.data.url,type:Ue.audio})})}},ye=k=>{console.log(k)},ce=k=>{var G=new ft.Howl({src:[k]});console.log(G),G.play()},pe=(k,G)=>{St(k,G)};return(k,G)=>{const $=De("VanLoading"),te=De("van-icon"),ae=De("van-loading"),ee=De("van-uploader"),he=De("van-button"),Be=De("van-field");return J(),re("div",Dt,[Z("div",{class:"list",id:"msg_list",ref_key:"scrollRef",ref:M},[Z("div",Bt,[x.value?(J(),je($,{key:0,class:"list-loading",size:"small"})):Re("",!0),(J(!0),re(Ee,null,Je(ge(h),X=>(J(),re("div",{class:qe(["item msg-item",{"is-me":X.is_me}]),id:"msg-item-"+X.time},[Z("div",Ft,[Z("img",{src:X.avatar,alt:""},null,8,Ot)]),Z("div",{class:qe(["main",{"is-me":X.is_me}])},[Z("span",Pt,Ce(O(X.create_time)),1),Z("div",{class:qe(["content","msg-content-type-"+X.type])},[X.type===0?(J(),re(Ee,{key:0},[nt(Ce(X.content),1)],64)):Re("",!0),X.type===3?(J(),re("div",{key:1,onClick:He=>pe(X.content,X.title)},[Z("span",null,Ce(X.title||"\u6587\u4EF6"),1),Z("img",{class:"msg-icon",src:ge(lt),alt:""},null,8,Et)],8,Ut)):Re("",!0),X.type===1?(J(),re("img",{key:2,style:{"max-width":"80%"},src:X.content,alt:""},null,8,Ht)):Re("",!0),X.type===2?(J(),je(te,{key:3,onClick:He=>ce(X.content),size:20,name:"volume-o"},null,8,["onClick"])):Re("",!0),X.loading?(J(),je(ae,{key:4,class:"loading",size:"20px",type:"spinner"})):Re("",!0)],2)],2)],10,It))),256))])],512),Z("div",Gt,[Z("div",Vt,[Z("div",Nt,[(J(!0),re(Ee,null,Je(ge(Mt),X=>(J(),re("div",{class:"grid-item",key:X.key},[X.key==="photo"?(J(),re("div",jt,[Pe(ee,{"after-read":q},{default:We(()=>[Z("div",Wt,[Z("img",{class:"grid-icon",src:X.icon,alt:""},null,8,qt)])]),_:2},1024)])):X.key==="file"?(J(),re("div",$t,[Pe(ee,{"after-read":V,accept:"image/*,.pdj,.zip,.doc,.docx,.xml,.pptx"},{default:We(()=>[Z("div",zt,[Z("img",{class:"grid-icon",src:X.icon,alt:""},null,8,Xt)])]),_:2},1024)])):(J(),re("div",{key:2,onClick:He=>fe(X)},[Z("div",Qt,[Z("img",{class:"grid-icon",src:X.icon,alt:""},null,8,Zt)])],8,Yt))]))),128)),Pe(he,{class:"btn",size:"small",plain:"",type:"success",onClick:e},{default:We(()=>[nt(" \u53D1\u9001 ")]),_:1})])]),Z("div",Kt,[Pe(Be,{onKeypress:ye,class:"input",modelValue:F.value,"onUpdate:modelValue":G[0]||(G[0]=X=>F.value=X),name:"content",placeholder:"\u6B63\u5728\u548C"+y.nickname+"\u5BF9\u8BDD",clearable:"",type:"textarea",autosize:{minHeight:150},rules:[{required:!0,message:"\u8BF7\u8F93\u5165"}]},null,8,["modelValue","placeholder"])])])])}}});const er=dt(Jt,[["__scopeId","data-v-76e09c65"]]),tr={class:"container"},rr=["onClick"],nr={class:"avatar"},ir={key:0,class:"badge"},or=["src"],ar={class:"main"},sr={class:"head"},dr={class:"name"},ur={key:0,class:"date"},fr={class:"content"},lr={key:0},cr={key:1},pr={key:2},hr=ot({__name:"Session",setup(K){const y=at(),i=F=>{y.setCurrentChat({rid:`${F.partner_id}`,nickname:F.nickname,avatar:F.avatar,is_group:Number(F.is_group)})},p=F=>st(F).format("MM/DD hh:mm"),c=Ke(()=>y.sessionList.map(F=>({...F})));return(F,I)=>{const Q=De("v-navigation-drawer");return J(),re("div",tr,[Pe(Q,{width:"260"},{default:We(()=>[(J(!0),re(Ee,null,Je(ge(c),x=>{var M,N;return J(),re("div",{class:qe(["item",{active:ge(y).currentChat&&+ge(y).currentChat.rid===x.partner_id}]),onClick:e=>i(x)},[Z("div",nr,[x.unread?(J(),re("span",ir,Ce(x.unread),1)):Re("",!0),Z("img",{src:x.avatar,alt:""},null,8,or)]),Z("div",ar,[Z("div",sr,[Z("div",dr,Ce(x.nickname)+"("+Ce(x.partner_id)+")",1),(M=x.last_message)!=null&&M.create_time?(J(),re("div",ur,Ce(p((N=x.last_message)==null?void 0:N.create_time)),1)):Re("",!0)]),Z("div",fr,[x.last_message?(J(),re(Ee,{key:0},[x.last_message.type===1?(J(),re("div",lr,"[\u56FE\u7247]")):x.last_message.type===3?(J(),re("div",cr,"[\u6587\u4EF6]")):(J(),re("div",pr,Ce(x.last_message.content||""),1))],64)):Re("",!0)])])],10,rr)}),256))]),_:1}),ge(y).currentChat?(J(),je(er,{key:0,rid:Number(ge(y).currentChat.rid),is_group:Number(ge(y).currentChat.is_group||0),nickname:ge(y).currentChat.nickname,avatar:ge(y).currentChat.avatar},null,8,["rid","is_group","nickname","avatar"])):Re("",!0)])}}});const vr=dt(hr,[["__scopeId","data-v-86d6b4f2"]]);export{vr as default};
